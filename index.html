<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-fe91322616dd2b9cea8bc6bfc6aa44e1.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.33">

  <meta name="author" content="Sofía Miñano">
  <title>Deep learning for computer vision</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-e2805181fec9eea38df180d7c16b9225.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <style>
  .equation-container {
    position: relative;
    display: inline-block;
  }
  .highlight-box {
    position: absolute;
    background-color: rgba(255, 165, 0, 0.3);
    border: 2px solid orange;
    border-radius: 5px;
    pointer-events: none;
  }
  .matrix-box {
    top: 10px;
    left: 20px;
    width: 120px;
    height: 60px;
  }
  .vector-box {
    top: 10px;
    left: 200px;
    width: 60px;
    height: 60px;
  }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#ffffff" data-background-image="img/background.png" data-background-opacity="0.5" data-background-position="center" data-background-size="cover" class="quarto-title-block center">
  <h1 class="title">Deep learning for computer vision</h1>
  <p class="subtitle">A primer for the animal behaviour scientist</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Sofía Miñano 
</div>
</div>
</div>

</section>
<section class="slide level2">

<!-- ########################################### -->
<!-- Overview and goals of the session -->
</section>
<section>
<section id="overview" class="title-slide slide level1 center">
<h1>Overview</h1>

</section>
<section id="overview-1" class="slide level2">
<h2>Overview</h2>
<div class="columns">
<div class="column" style="text-align: center; width: 50%;">
<div class="fragment fade-in">
<div style="font-size: 0.6em;">
Vanilla neural network
</div>
<p><img data-src="img/overview/vanilla-nn.png" style="width:90.0%"></p>
</div>
</div><div class="column" style="text-align: center; width: 50%;">
<div class="fragment fade-in">
<div style="font-size: 0.6em;">
Convolutional neural network
</div>
<p><img data-src="img/overview/cnn-diagram-1.png" style="width:90.0%"></p>
</div>
</div></div>
<div class="columns">
<div class="column" style="text-align: center; width: 30%;">

</div><div class="column" style="text-align: center; width: 40%;">
<div class="fragment fade-in">
<div style="font-size: 0.6em;">
Applications to animal behaviour
</div>
<p><img data-src="img/overview/pose-estimation.png" style="width:40.0%"></p>
<div style="position: absolute; bottom: 0px; right: 0px; font-size: 0.3em; color: var(--link-color); max-width: 300px; text-align: right;">
Figures from <a href="https://cs231n.github.io/convolutional-networks" target="_blank">cs231n.github.io/convolutional-networks</a> and <a href="https://movement.neuroinformatics.dev" target="_blank">movement.neuroinformatics.dev</a>
</div>
</div>
</div><div class="column" style="text-align: center; width: 20%;">

</div></div>
<!-- ------------- -->
</section>
<section id="overview-2" class="slide level2">
<h2>Overview</h2>
<ul>
<li class="fragment"><a href="#/preliminaries">Preliminary concepts</a></li>
<li class="fragment"><a href="#/anatomy-of-a-nn">Anatomy of a neural network</a></li>
<li class="fragment"><a href="#/forward-pass">Forward pass</a></li>
<li class="fragment"><a href="#/training-and-backward-pass">Training and backward pass</a></li>
<li class="fragment"><a href="#/cnn">Convolutional neural networks</a></li>
<li class="fragment"><a href="#/cv-applications-in-animal-behaviour">CV applications in animal behaviour</a></li>
</ul>
<aside class="notes">
<p>Hi everyone, my name is Sofía Miñano, and I’m an RSE in the Neuroinformatics Unit, developing tools for animal behaviour research.</p>
<p>The main objective of this session is to give a general and not-too-hand-wavy intuition of the main concepts behind how neural networks are used in computer vision applications for animal behaviour.</p>
<p>We will start from the basics of neural networks, then expand to convolutional neural networks and finally focus on how these tools are used in animal behaviour research.</p>
<p>The goal is that you understand a bit better what is happening under the hood when you use these tools, to help you use and debug them efficiently.</p>
<p>The content of the slides is based on a few different resources, I will link to them as we go along.</p>
<p>So let’s dive in!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ------------- -->
<!-- ########################################### -->
<!-- Some basic definitions -->
</section></section>
<section>
<section id="preliminaries" class="title-slide slide level1 center">
<h1>Some preliminaries</h1>

</section>
<section class="slide level2">


<!-- ------------------ -->
<aside><div>
<p>This section is based on Chapter 1 of <em>Deep Learning</em> by Goodfellow <em>et al</em>. (2016), available for free at <a href="https://www.deeplearningbook.org/">deeplearningbook.org</a></p>
</div></aside></section>
<section id="what-is-deep-learning" class="slide level2">
<h2>What is <strong style="color: #daa520;">Deep Learning</strong>?</h2>
<p><br></p>
<div class="fragment">
<p><text style="color: #daa520;">Deep Learning</text> is:</p>
<ul>
<li class="fragment">an approach to <strong style="color: blue;">Artificial Intelligence</strong></li>
<li class="fragment">a type of <strong style="color: #32cd32;">Machine Learning</strong> that uses artificial neural networks</li>
</ul>
<aside class="notes">
<p>Before we dive into the deep learning, let’s start with some key definitions.</p>
<p>We are going to go through each of the statements that relate these concepts that often go together.</p>
<p>Deep Learning is an approach to Artificial Intelligence.</p>
<p>Deep Learning is a type of Machine Learning based on artificial neural networks. - ML enables computers to improve with experience and data</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ------------------ -->
</div>
</section>
<section id="why-is-it-so-popular" class="slide level2">
<h2>Why is it so popular?</h2>
<p><br></p>
<div class="fragment">
<p><text style="color: #daa520;">Deep Learning</text> achieves great power and flexibility by:</p>
<ul>
<li class="fragment">gathering <strong>knowledge from experience</strong></li>
<li class="fragment">being <strong>compositional</strong></li>
</ul>
<aside class="notes">
<p>Deep Learning achieves great power and flexbility by: 1. Gathering knowledge from experience –&gt; humans don’t formally specify the required knowledge 2. Being compositional –&gt; representing the world as a nested hierarchy of concepts [many layers, “Deep”]</p>
<p>We are going to go through each of the statements that relate these concepts that often go together.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ------------------ -->
</div>
</section>

<section id="what-is-artificial-intelligence-1" class="slide level2">
<h2>What is <strong style="color: blue;">Artificial Intelligence</strong>?</h2>
<div class="fragment">
<p><br></p>
<p>Tesler’s theorem:</p>
<blockquote>
<p>“AI is whatever hasn’t been done yet.”</p>
</blockquote>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="text-align: center; width: 50%; font-size: 0.3em; ">
<p><img data-src="img/basics/ocr-example.png" style="width:50.0%"></p>
<p>Figure from <a href="https://stackoverflow.com/questions/55864694/ocr-replace-recognized-text-with-its-translation-like-google-translate">stackoverflow.com</a></p>
</div><div class="column" style="text-align: center; width: 50%; font-size: 0.3em;">
<div class="fragment fade-in">
<p><img data-src="img/basics/waymo.jpg" style="width:100.0%"></p>
<p>Figure from <a href="https://www.waymo.com">Waymo</a></p>
</div>
</div></div>
<aside class="notes">
<p>From Wikipedia ‐ As machines become increasingly capable, tasks considered to require “intelligence” are often removed from the definition of AI, a phenomenon known as the AI effect. ‐ For instance, optical character recognition is frequently excluded from things considered to be AI, having become a routine technology. ‐ Modern machine capabilities generally classified as AI include successfully understanding human speech, competing at the highest level in strategic game systems (such as chess and Go), autonomously operating cars, intelligent routing in content delivery networks, and military simulations.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ------- -->
</div>
</section>
<section id="deep-learning-as-an-approach-to-artificial-intelligence" class="slide level2">
<h2><strong style="color: #daa520;">Deep Learning</strong> as an approach to <strong style="color: blue;">Artificial Intelligence</strong></h2>
<p><br></p>
<ul>
<li class="fragment"><text style="color: blue;">Early AI</text>: problems that were intellectually challenging for humans, but easy for computers</li>
<li class="fragment"><strong>True challenge</strong>: tasks that are easy for humans but hard to describe formally</li>
<li class="fragment"><text style="color: #daa520;">DL</text> has proven very powerful in solving these <strong><em>intuitive problems</em></strong> within <text style="color: blue;">AI</text>.</li>
</ul>
<aside class="notes">

<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ------------------ -->
</section>
<section id="deep-learning-is-a-subset-of-machine-learning" class="slide level2">
<h2><strong style="color: #daa520;">Deep Learning</strong> is a subset of <strong style="color: #32cd32;">Machine Learning</strong></h2>
<div class="columns">
<div class="column" style="width: 60%">
<ul>
<li class="fragment"><text style="color: #32cd32;">ML</text> allows computers to tackle problems <strong>using knowledge (data) from the real world</strong></li>
<li class="fragment">Algorithms depend heavily on the <strong>representation</strong> of the data</li>
</ul>
</div><div class="column fragment fade-in" style="text-align: right; width: 35%; font-size: 0.3em;">
<p><img data-src="img/basics/dl-as-ml-type-part-1.png" style="width:100.0%"></p>
<p>Figure from <a href="https://www.deeplearningbook.org/">Deep Learning book</a></p>
</div></div>
<aside class="notes">
<p>How “traditional” ML algorithms depend heavily on the representation of the data</p>
<ul>
<li><p>We can see how representation is relevant also in everyday life: it is much easier for us to do arithmetics on arabic numerals vs roman numerals (“People can easily perform arithmetic on Arabic numerals but ﬁnd arithmetic on Roman numerals much more timeconsuming.”) Another nice example is face recognition (<a href="https://en.wikipedia.org/wiki/Thatcher_effect">Thatcher effect</a>)</p></li>
<li><p>E.g. cesarean delivery problem, the algorithm takes certain pieces of information that represent the patient adequately for the problem. (“features”). Logistic regression learns how these features correlate with various outcomes but it cannot influence how these features are defined</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ------------------ -->
</section>
<section id="deep-learning-is-a-subset-of-machine-learning-1" class="slide level2">
<h2><strong style="color: #daa520;">Deep Learning</strong> is a subset of <strong style="color: #32cd32;">Machine Learning</strong></h2>
<div class="columns">
<div class="column" style="width: 60%">
<ul>
<li><text style="color: #32cd32;">ML</text> allows computers to tackle problems <strong>using knowledge (data) from the real world</strong></li>
<li>Algorithms depend heavily on the <strong>representation</strong> of the data</li>
<li><text style="color: #daa520;">DL</text> is a kind of <strong>representation learning</strong></li>
</ul>
</div><div class="column" style="text-align: right; width: 35%; font-size: 0.3em;">
<p><img data-src="img/basics/dl-as-ml-type-part-2.png" style="width:100.0%"></p>
<p>Figure from <a href="https://www.deeplearningbook.org/">Deep Learning book</a></p>
</div></div>
<aside class="notes">
<ul>
<li><p>Sometimes hand‐designed representations are easy to obtain, but often it is difficult to know what features to extract. E.g., detecting cars in photographs</p></li>
<li><p>Representation learning: machine learning discipline that aims to discover not only the mapping from representation to output but also the representation itself.</p></li>
<li><p>Learnt representations often perform better and make AI systems easier to adapt to new tasks. E.g., autoencoder</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ------------------ -->
</section>

<section id="deep-learning-is-compositional-1" class="slide level2">
<h2><strong style="color: #daa520;">Deep Learning</strong> is compositional</h2>
<div class="columns">
<div class="column" style="width: 70%; font-size: 0.3em;">
<p><img data-src="img/basics/dl-compositional.png" style="width:90.0%"></p>
<p>Figure from <a href="https://www.deeplearningbook.org/">Deep Learning book</a></p>
</div><div class="column" style="width: 20%; font-size: 0.4em; color: #daa520;">
<div class="fragment fade-in">
<div style="position: absolute; top: 84%; right: 1%; background-color: transparent; padding: 10px; border-radius: 5px; border: 2px solid #daa520;">
<p>Variables that we are able to observe.</p>
</div>
</div>
<div class="fragment fade-in">
<div style="position: absolute; top: 52%; right: 1%; background-color: transparent; padding: 10px; border-radius: 5px; border: 2px solid #daa520;">
<p>Extraction of increasingly abstract features.</p>
<p>“Hidden” (i.e., not observable)</p>
</div>
</div>
<div class="fragment fade-in">
<div style="position: absolute; top: 22%; right: 1%; background-color: transparent; padding: 10px; border-radius: 5px; border: 2px solid #daa520;">
<p>Recognition of objects in the image</p>
</div>
</div>
</div></div>
<aside class="notes">
<p>DL solves this by introducing a <strong>hierarchical representation</strong> of the data - How does a computer go about understanding the meaning of raw sensory input data? An image is just a collection of pixel values - DL breaks down the mapping into a series of nested simple mappings, each described by a different layer of the network</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ------------------ -->
</section>
<section id="recap" class="slide level2">
<h2>Recap</h2>
<div class="fragment">
<div class="columns">
<div class="column" style="width: 55%">
<p><text style="color: #daa520;">Deep Learning</text> is:</p>
<ul>
<li>an approach to <text style="color: blue;">AI</text></li>
<li>a subset of <text style="color: #32cd32;">ML</text></li>
<li>well-suited to solve <em>intuitive</em> problems because learns from data and represents the world hierarchically</li>
</ul>
<!-- Why is <text style="color: #daa520;">Deep Learning</text> well-suited to solve these more intuitive problems?

- Gathers knowledge from experience
- Represents the world hierarchically -->
</div><div class="column" style="width: 5%">

</div><div class="column" style="width: 40%; font-size: 0.3em; text-align: center;">
<div class="fragment fade-in">
<p><img data-src="img/basics/ai-venn-diagram.png" style="width:100.0%"></p>
<p>Figure modified from <a href="https://www.deeplearningbook.org/">Deep Learning book</a></p>
</div>
</div></div>
</div>
</section>
<section id="additional-references" class="slide level2">
<h2>Additional references</h2>
<div style="font-size: 0.6em;">
<ul>
<li>On the strengths of deep learning:
<ul>
<li><a href="https://youtu.be/RTTQctLuTVk?t=507">Brains, Minds and Machines summer school 2017 - Deep learning tutorial</a></li>
</ul></li>
<li>Early AI:
<ul>
<li><a href="https://web.archive.org/web/20200814051610/http://www2.psych.utoronto.ca/users/reingold/courses/ai/early.html">Early Work in AI</a></li>
<li><a href="https://en.wikipedia.org/wiki/Logic_Theorist">Logic Theorist - wikipedia</a></li>
</ul></li>
<li>On the challenge of solving “intuitive” tasks:
<ul>
<li><a href="https://youtu.be/vT1JzLTH4G4?list=PL3FW7Lu3i5JvHM8ljYj‐zLfQRF3EO8sYv&amp;t=855">Fei‐Fei Li’s lecture on cs231n 2017</a></li>
<li><a href="http://people.csail.mit.edu/brooks/idocs/AIM‐100.pdf">The Summer Vision Project</a></li>
</ul></li>
<li>Deep Learning for Computer Vision course (University of Michigan)
<ul>
<li><a href="https://youtube.com/playlist?list=PL5-TkQAfAZFbzxjBHtzdVCWE0Zbhomg7r&amp;si=a74CaQT_KGKz2rbP">Winter 2019 (lecture videos public)</a></li>
<li><a href="https://web.eecs.umich.edu/~justincj/teaching/eecs498/WI2022/">Winter 2022 (lecture videos not available)</a></li>
</ul></li>
<li>CS231n: Convolutional Neural Networks for Visual Recognition (Stanford University)
<ul>
<li><a href="https://www.youtube.com/playlist?list=PL3FW7Lu3i5JvHM8ljYj-zLfQRF3EO8sYv">Winter 2017 (lecture videos public)</a></li>
<li><a href="https://cs231n.stanford.edu/">Spring 2025 (lecture videos not available)</a></li>
</ul></li>
</ul>
</div>
<!-- ########################################### -->
</section></section>
<section>
<section id="anatomy-of-a-nn" class="title-slide slide level1 center">
<h1>Anatomy of a neural network</h1>

</section>
<section class="slide level2">


<!-- ## A vanilla neural network

- Structure
  - Single neuron
  - MLP (layers)
- Forward pass
  - transformations across layers (weights and biases)
  - matrix notation
- Training and backwards pass
  - intuition
  - loss function
  - gradient descent and backpropagation -->
<!-- 
  In machine learning, backpropagation is a gradient computation method commonly used for training a neural network in computing parameter updates. It is an efficient application of the chain rule to neural networks.  -->
<aside><div>
<p>This section is based on the <a href="https://youtu.be/aircAruvnKk?si=HdE55UbKbjsPP-A-">neural networks video series by <em>3Blue1Brown</em></a></p>
</div></aside></section>
<section id="what-is-a-neural-network" class="slide level2">
<h2>What is a <text style="color:rgb(147, 32, 218);">neural network</text>?</h2>
<p><br></p>
<ul>
<li class="fragment"><p><text style="color: #daa520;">Deep learning</text> and <text style="color:rgb(147, 32, 218);">neural networks</text></p></li>
<li class="fragment"><p>Digit recognition task as an <strong><em>intuitive</em> problem</strong></p></li>
<li class="fragment"><p>Multilayer perceptron</p></li>
</ul>
<aside class="notes">
<p>We have mentioned that Deep learning is a typeof ML based on artificial neural networks, and we have hinted at deep learning relying on many stacked layers of abstraction.</p>
<p>We will see in this section that these layers of abstractions and transformations are formalised as NN, which are basically stacks of linear transformations, with nonlinear layers in between.</p>
<!-- We will also see how these NNs are trained using a process called backpropagation, which is a method to compute the gradients of the loss function with respect to the parameters of the network. -->
<p>For the sake of clarity we are going to focus on the problem of digit recognition, a classic example for neural network applications</p>
<p>Digit recognition is one of those intuitive tasks that we’ve talked about (easy to humans, hard to formalise). We’ll use this example to introduce the multilayer perceptron, the simplest type of NN.</p>
<p>Note that we focus on the classification task (but NN can also address regression and many other kinds of tasks)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ------------- -->
</section>
<section id="our-task" class="slide level2">
<h2>Our task</h2>
<div class="center">
<p><img data-src="img/vanilla-nn/digit-recognition-task.png" style="display: block; margin: 0 auto;;width:65.0%"></p>
<div style="position: absolute; bottom: 50px; right: 180px; font-size: 0.3em; color: var(--link-color);">
Figure from <a href="https://youtu.be/aircAruvnKk?si=frXeACs-x0A0JGRl&amp;t=65" target="_blank"> But what is a neural network? | Deep learning chapter 1</a>
</div>
</div>
<aside class="notes">
<p>More specifically, the challenge is to write a program that taxes a grid of 28x28 pixels and outputs a single number between 0 and 9.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ------------- -->
</section>
<section id="single-neuron-first-slide" class="slide level2">
<h2>A single neuron</h2>
<!-- ::: {.fragment .fade-in}
Neurons in a network are organised in **layers**
::: -->
<div class="fragment fade-in">
<div style="text-align: center; width: 100%;">
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="960" height="480" viewbox="0.00 0.00 180.00 194.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 190)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-190 176,-190 176,4 -4,4"></polygon>
<!-- x1 -->
<g id="node1" class="node">
<title>x1</title>
<ellipse fill="lightblue" stroke="black" cx="25" cy="-161" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="25" y="-156.2" font-family="Arial" font-size="16.00">x₁</text>
</g>
<!-- f -->
<g id="node4" class="node">
<title>f</title>
<ellipse fill="royalblue" stroke="black" cx="147" cy="-93" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="147" y="-88.2" font-family="Arial" font-size="16.00" fill="royalblue">f</text>
</g>
<!-- x1&#45;&gt;f -->
<g id="edge1" class="edge">
<title>x1-&gt;f</title>
<path fill="none" stroke="lightblue" d="M47.18,-149C66.25,-138.19 94.5,-122.18 115.92,-110.05"></path>
<polygon fill="lightblue" stroke="lightblue" points="117.66,-113.08 124.63,-105.11 114.2,-106.99 117.66,-113.08"></polygon>
</g>
<!-- x2 -->
<g id="node2" class="node">
<title>x2</title>
<ellipse fill="lightblue" stroke="black" cx="25" cy="-93" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="25" y="-88.2" font-family="Arial" font-size="16.00">x₂</text>
</g>
<!-- x2&#45;&gt;f -->
<g id="edge2" class="edge">
<title>x2-&gt;f</title>
<path fill="none" stroke="lightblue" d="M50.28,-93C67.93,-93 92.06,-93 111.68,-93"></path>
<polygon fill="lightblue" stroke="lightblue" points="111.75,-96.5 121.75,-93 111.75,-89.5 111.75,-96.5"></polygon>
</g>
<!-- x3 -->
<g id="node3" class="node">
<title>x3</title>
<ellipse fill="lightblue" stroke="black" cx="25" cy="-25" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="25" y="-20.2" font-family="Arial" font-size="16.00">x₃</text>
</g>
<!-- x3&#45;&gt;f -->
<g id="edge3" class="edge">
<title>x3-&gt;f</title>
<path fill="none" stroke="lightblue" d="M47.18,-37C66.25,-47.81 94.5,-63.82 115.92,-75.95"></path>
<polygon fill="lightblue" stroke="lightblue" points="114.2,-79.01 124.63,-80.89 117.66,-72.92 114.2,-79.01"></polygon>
</g>
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
</div>
<!-- ::: {.fragment .fade-in}
<div style="position: absolute; top: 350px; right: 50px; font-size: 24px; font-weight: bold; color: #4169E1; z-index: 2; text-align: right;">
  Activation function
  <br>
  $$
  f(x_1, x_2, x_3, \ldots)
  $$
</div>

::: -->
<aside class="notes">
<p>Neurons in a neural network are organised in <strong>layers</strong> (remember the hierarchy of concepts characteristic of DL).</p>
<p>In this simple case we have an initial layer of 3 neurons and a second layer with only one neuron.</p>
<p>We can visualise each neuron as holding a number. - The initial layer holds the input values. - The neuron in the second layer holds the output of a certain function, that takes as input the output of all the neurons in the previous layer - This function is called ‘<strong>activation function</strong>’. There are different types of activation function and we will go into detail later</p>
<!-- This simple structure is called a ** single-layer perceptron**.

https://en.wikipedia.org/wiki/Multilayer_perceptron:
MLPs grew out of an effort to improve single-layer perceptrons, which could only be applied to linearly separable data. A perceptron traditionally used a Heaviside step function as its nonlinear activation function. However, the backpropagation algorithm requires that modern MLPs use continuous activation functions such as sigmoid or ReLU.[8]

 -->
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="a-multi-layer-perceptron" class="slide level2">
<h2>A multi-layer perceptron</h2>
<p>The simplest neural network</p>
<ul>
<li class="fragment">An extension to more neurons and more layers</li>
<li class="fragment">Requires a non-linear activation function</li>
<li class="fragment">Also <strong>fully‐connected</strong> or <strong>feed-forward</strong> networks</li>
</ul>
<div class="fragment fade-in">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/vanilla-nn/mlp-cs231n-diagrams.png" class="quarto-figure quarto-figure-center" style="width:90.0%"></p>
</figure>
</div>
<div style="position: absolute; bottom: 0px; right: 80px; font-size: 0.3em; color: var(--link-color);">
Figure from <a href="https://cs231n.github.io/neural-networks-1/" target="_blank"> CS231n lecture notes: neural networks</a>
</div>
</div>
<aside class="notes">
<p>A multi‐layer perceptron (MLP) is an extension of this to more neurons and more layers - MLPs have at least one layer between the first and the last layer, each of which with a relatively large number of neurons - The number of layers and neurons varies per application and it often based on what has worked well in the past (there are methods for comparing performance across different architectures to make choices).</p>
<p>Every neuron behaves exactly as we saw in the simple case: - at each layer after the input layer, each neuron receives as input all the neurons in the previous layer, computes a certain function, and outputs a value. - This is carried out at every layer until the output layer. - These networks are also called <strong>fully‐connected</strong>, since all the neurons in one layer are connected to all previous ones</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>

<section id="layers" class="slide level2">
<h2>Layers</h2>

<!-- Input layer -->
<img data-src="img/vanilla-nn/mlp-3b1b-diagram.png" class="quarto-figure quarto-figure-center r-stretch" style="width:90.0%"><div class="fragment fade-in">
<div style="position: absolute; top: 350px; left: 100px; font-size: 24px; text-align: left; font-weight: bold; color:rgb(174, 9, 9);">
<p>Input layer</p>
</div>
<!-- Rectangle input layer -->
<div style="width: 50px; height: 595px; background-color: transparent; border: 4px solid rgb(174, 9, 9); position: absolute; top: 85px; left: 275px;">

</div>
</div>
<!-- Output layer -->
<div class="fragment fade-in">
<div style="position: absolute; top: 350px; right: 100px; font-size: 24px; text-align: left; font-weight: bold; color: rgb(103, 152, 205);">
<p>Output layer</p>
</div>
<!-- Rectangle output layer -->
<div style="width: 50px; height: 330px; background-color: transparent; border: 4px solid rgb(103, 152, 205); position: absolute; top: 220px; right: 275px;">

</div>
</div>
<!-- Hidden layers -->
<div class="fragment fade-in">
<div style="position: absolute; top: 40px; right: 440px; font-size: 24px; text-align: left; font-weight: bold; color: rgb(207, 161, 13);">
<p>Hidden layers</p>
</div>
<!-- Rectangle hidden layers -->
<div style="width: 200px; height: 550px; background-color: transparent; border: 4px solid rgb(207, 161, 13); position: absolute; top: 110px; right: 420px;">

</div>
</div>
<aside class="notes">
<p>In our example case, let’s assume we use this MLP to classify handwritten digits.</p>
<p>From this description of the workflow we can already see there are three types of layers - The Input layer, that hold the input values - Some hidden layers, where subsequent transformations occur - Output layer, which hold the classification decision</p>
<p>We will address first the input and output layers before going into detail about what’s going on in the hidden layers. For now, it’s sufficient to know that these are transformations analogous to the one we’ve seen for a neuron but extended to many many neurons.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="layers-input-layer" class="slide level2">
<h2>Layers: input layer</h2>
<div class="columns">
<div class="column" style="width: 20%; margin-top: 18%; margin-left: 0%">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/vanilla-nn/input-2.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div><div class="column" style="width: 30%; margin-top: 20%">
<div style="text-align: center; margin-left: 0%; ">
<p><span style="font-size: 100px; color: rgb(174, 9, 9);">→</span> <code style="font-size: 20px; margin-left: 7%; color: rgb(174, 9, 9);">np.reshape(28*28, 1)</code></p>
</div>
</div><div class="column" style="width: 45%; margin-left: 5%">
<p><img data-src="img/vanilla-nn/mlp-3b1b-diagram.png" style="width:100.0%"></p>
<div style="width: 40px; height: 570px; background-color: transparent; border: 4px solid rgb(174, 9, 9); position: absolute; top: 100px; right: 425px;">

</div>
</div></div>
<aside class="notes">
<p>The input layer simply holds the input values.</p>
<p>We have seen that for our problem the input image is a greyscale image of size 28x28.</p>
<p>That means that we have an array of numbers organised in 28 rows and 28 columns, each of which with a value between 0 and 1, where 0 is black and 1 is white.</p>
<p>The first layer in our neural network will hold these values, stretched out in 784 different neurons (we reshape the 2D array as a vector)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="layers-output-layer" class="slide level2">
<h2>Layers: output layer</h2>
<div class="columns">
<div class="column" style="width: 20%; margin-top: 18%; margin-left: 0%">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/vanilla-nn/input-2.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div><div class="column" style="width: 45%; margin-left: 5%">
<p><img data-src="img/vanilla-nn/mlp-3b1b-diagram.png" style="width:100.0%"></p>
<!-- Rectangle output layer -->
<!-- <div style="width: 40px; height: 320px; background-color: transparent; border: 4px solid rgb(103, 152, 205); position: absolute; top: 225px; right: 330px;">
</div> -->
<div style="width: 40px; height: 320px; background-color: transparent; border: 4px solid rgb(103, 152, 205); position: absolute; top: 225px; right: 330px;">
<div style="position: absolute; top: 2.5%; left: 150%; transform: translateX(-50%); font-size: 26px; color: rgb(103, 152, 205);">
0
</div>
<div style="position: absolute; top: 12%; left: 150%; transform: translateX(-50%); font-size: 26px; color: rgb(103, 152, 205);">
1
</div>
<div style="position: absolute; top: 22%; left: 150%; transform: translateX(-50%); font-size: 26px; color: rgb(103, 152, 205);">
2
</div>
<div style="position: absolute; top: 31%; left: 150%; transform: translateX(-50%); font-size: 26px; color: rgb(103, 152, 205);">
3
</div>
<div style="position: absolute; top: 40%; left: 150%; transform: translateX(-50%); font-size: 26px; color: rgb(103, 152, 205);">
4
</div>
<div style="position: absolute; top: 50%; left: 150%; transform: translateX(-50%); font-size: 26px; color: rgb(103, 152, 205);">
5
</div>
<div style="position: absolute; top: 60%; left: 150%; transform: translateX(-50%); font-size: 26px; color: rgb(103, 152, 205);">
6
</div>
<div style="position: absolute; top: 70%; left: 150%; transform: translateX(-50%); font-size: 26px; color: rgb(103, 152, 205);">
7
</div>
<div style="position: absolute; top: 80%; left: 150%; transform: translateX(-50%); font-size: 26px; color: rgb(103, 152, 205);">
8
</div>
<div style="position: absolute; top: 90%; left: 150%; transform: translateX(-50%); font-size: 26px; color: rgb(103, 152, 205);">
9
</div>
</div>
</div><div class="column" style="width: 30%; margin-top: 20%">
<div style="text-align: center; margin-left: 0%; ">
<p><span style="font-size: 100px; color: rgb(103, 152, 205);"> → 2</span></p>
</div>
</div></div>
<aside class="notes">
<p>As we mentioned at the output layer we would like to have the classification decision.</p>
<p>What digit is represented in the image? - A convenient way to output this decision is to have as many neurons as classes we are considering. - In this case any input image can be 1 in 10 classes, corresponding to the digits from 0 to 9.</p>
<p>Therefore in the output layer, each of the neurons would hold a number that represents how much the model thinks that the input image represents the corresponding class (digits in our case). [In an image classification task, it could be whether or not a cat, dog, car is present in the image]</p>
<p>So now we just need to understand what kind of transformations are happening in the hidden layers.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="additional-references-1" class="slide level2">
<h2>Additional references</h2>
<div style="font-size: 0.6em;">
<ul>
<li>On the single and multi-layer perceptron:
<ul>
<li><a href="https://www.deeplearningbook.org/">Deep Learning book</a> sections 1.2.1 and 6.6</li>
<li><a href="https://youtu.be/RTTQctLuTVk?t=136">Brains, Minds and Machines summer school 2017 - Deep learning tutorial</a></li>
</ul></li>
<li>On the network’s architecture
<ul>
<li><a href="https://cs231n.github.io/neural-networks-1/">CS231n - Neural networks</a></li>
<li><a href="https://www.deeplearningbook.org/contents/mlp.html">Deep Learning book</a> chapter 6, especially section 6.4</li>
</ul></li>
</ul>
</div>
<!-- ########################################### -->
</section></section>
<section>
<section id="forward-pass" class="title-slide slide level1 center">
<h1>Forward pass</h1>

</section>
<section class="slide level2">


<aside><div>
<p>This section is based on the <a href="https://youtu.be/aircAruvnKk?si=HdE55UbKbjsPP-A-">neural networks video series by <em>3Blue1Brown</em></a></p>
</div></aside></section>
<section id="from-layer-to-layer" class="slide level2">
<h2>From layer to layer</h2>

<!-- Hidden layers -->
<img data-src="img/vanilla-nn/mlp-3b1b-diagram.png" class="quarto-figure quarto-figure-center r-stretch" style="width:90.0%"><div style="position: absolute; top: 40px; right: 300px; font-size: 24px; text-align: left; font-weight: bold; color: rgb(207, 161, 13);">
<p>Hidden layers</p>
</div>
<!-- Rectangle hidden layers -->
<div style="width: 200px; height: 550px; background-color: transparent; border: 4px solid rgb(207, 161, 13); position: absolute; top: 110px; right: 420px;">

</div>
<!-- ------------------------------------------------------------------------ -->
</section>
<section id="from-layer-to-layer-one-neuron" class="slide level2">
<h2>From layer to layer: one neuron</h2>
<div style="text-align: center; width: 100%;">
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="960" height="480" viewbox="0.00 0.00 180.00 194.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 190)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-190 176,-190 176,4 -4,4"></polygon>
<!-- x1 -->
<g id="node1" class="node">
<title>x1</title>
<ellipse fill="lightblue" stroke="black" cx="25" cy="-161" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="25" y="-156.2" font-family="Arial" font-size="16.00">x₁</text>
</g>
<!-- f -->
<g id="node4" class="node">
<title>f</title>
<ellipse fill="royalblue" stroke="black" cx="147" cy="-93" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="147" y="-88.2" font-family="Arial" font-size="16.00" fill="royalblue">f</text>
</g>
<!-- x1&#45;&gt;f -->
<g id="edge1" class="edge">
<title>x1-&gt;f</title>
<path fill="none" stroke="lightblue" d="M47.18,-149C66.25,-138.19 94.5,-122.18 115.92,-110.05"></path>
<polygon fill="lightblue" stroke="lightblue" points="117.66,-113.08 124.63,-105.11 114.2,-106.99 117.66,-113.08"></polygon>
</g>
<!-- x2 -->
<g id="node2" class="node">
<title>x2</title>
<ellipse fill="lightblue" stroke="black" cx="25" cy="-93" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="25" y="-88.2" font-family="Arial" font-size="16.00">x₂</text>
</g>
<!-- x2&#45;&gt;f -->
<g id="edge2" class="edge">
<title>x2-&gt;f</title>
<path fill="none" stroke="lightblue" d="M50.28,-93C67.93,-93 92.06,-93 111.68,-93"></path>
<polygon fill="lightblue" stroke="lightblue" points="111.75,-96.5 121.75,-93 111.75,-89.5 111.75,-96.5"></polygon>
</g>
<!-- x3 -->
<g id="node3" class="node">
<title>x3</title>
<ellipse fill="lightblue" stroke="black" cx="25" cy="-25" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="25" y="-20.2" font-family="Arial" font-size="16.00">x₃</text>
</g>
<!-- x3&#45;&gt;f -->
<g id="edge3" class="edge">
<title>x3-&gt;f</title>
<path fill="none" stroke="lightblue" d="M47.18,-37C66.25,-47.81 94.5,-63.82 115.92,-75.95"></path>
<polygon fill="lightblue" stroke="lightblue" points="114.2,-79.01 124.63,-80.89 117.66,-72.92 114.2,-79.01"></polygon>
</g>
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<div class="fragment fade-in">
<div style="position: absolute; top: 260px; right: 50px; font-size: 24px; font-weight: bold; color: #4169E1; z-index: 2; text-align: right;">
<p><!-- Activation function --> <br> <span class="math display">\[
  f(x_1, x_2, x_3, \ldots) = \mathbf{\color{rgb(225, 174, 65)}h}
  \]</span></p>
</div>
</div>
<aside class="notes">
<p>For the case of a single neuron, we have seen that each neuron holds a number that results from taking all the numbers held at the neurons in the previous layer and applying a certain function.</p>
<p>We consider a neuron at the first hidden layer. We represent its output by h. We are now going to describe that function</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ------------------------------------------------------------------------ -->
</section>
<section id="from-layer-to-layer-one-neuron-1" class="slide level2 scrollable">
<h2>From layer to layer: one neuron</h2>
<div class="columns">
<!-- ::: {.column width="20%" style="margin-left: -15%; margin-top: 5%;"} --><div class="column" style="margin-left: -15%; margin-top: 5%;">
<div class="cell" data-fig-width="7" data-fig-height="3.5" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="672" height="336" viewbox="0.00 0.00 200.61 194.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 190)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-190 196.61,-190 196.61,4 -4,4"></polygon>
<!-- x1 -->
<g id="node1" class="node">
<title>x1</title>
<ellipse fill="lightblue" stroke="black" cx="25" cy="-161" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="25" y="-156.2" font-family="Arial" font-size="16.00">x₁</text>
</g>
<!-- f -->
<g id="node4" class="node">
<title>f</title>
<ellipse fill="royalblue" stroke="black" cx="167.61" cy="-93" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="167.61" y="-88.2" font-family="Arial" font-size="16.00" fill="royalblue">f</text>
</g>
<!-- x1&#45;&gt;f -->
<g id="edge1" class="edge">
<title>x1-&gt;f</title>
<path fill="none" stroke="#89e141" d="M47.97,-150.38C71.5,-139 109.02,-120.85 135.56,-108.02"></path>
<polygon fill="#89e141" stroke="#89e141" points="137.32,-111.06 144.79,-103.55 134.27,-104.75 137.32,-111.06"></polygon>
<text text-anchor="middle" x="96.31" y="-135.2" font-family="Times,serif" font-size="14.00" fill="#89e141">w₁</text>
</g>
<!-- x2 -->
<g id="node2" class="node">
<title>x2</title>
<ellipse fill="lightblue" stroke="black" cx="25" cy="-93" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="25" y="-88.2" font-family="Arial" font-size="16.00">x₂</text>
</g>
<!-- x2&#45;&gt;f -->
<g id="edge2" class="edge">
<title>x2-&gt;f</title>
<path fill="none" stroke="#89e141" d="M50.17,-93C72.71,-93 106.56,-93 131.97,-93"></path>
<polygon fill="#89e141" stroke="#89e141" points="132.28,-96.5 142.28,-93 132.28,-89.5 132.28,-96.5"></polygon>
<text text-anchor="middle" x="96.31" y="-97.2" font-family="Times,serif" font-size="14.00" fill="#89e141">w₂</text>
</g>
<!-- x3 -->
<g id="node3" class="node">
<title>x3</title>
<ellipse fill="lightblue" stroke="black" cx="25" cy="-25" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="25" y="-20.2" font-family="Arial" font-size="16.00">x₃</text>
</g>
<!-- x3&#45;&gt;f -->
<g id="edge3" class="edge">
<title>x3-&gt;f</title>
<path fill="none" stroke="#89e141" d="M47.97,-35.62C71.5,-47 109.02,-65.15 135.56,-77.98"></path>
<polygon fill="#89e141" stroke="#89e141" points="134.27,-81.25 144.79,-82.45 137.32,-74.94 134.27,-81.25"></polygon>
<text text-anchor="middle" x="96.31" y="-68.2" font-family="Times,serif" font-size="14.00" fill="#89e141">w₃</text>
</g>
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div style="position: absolute; top: 280px; left: 370px; font-size: 24px; font-weight: bold; color: #4169E1; z-index: 2; text-align: right;">
<p><span class="math display">\[
  \mathbf{\color{rgb(225, 174, 65)}h}
  \]</span></p>
</div>
</div><div class="column" style="width:10%;">

</div><div class="column" style="text-align: left;">
<ol type="1">
<li class="fragment"><p>Compute weighted sum <span class="math display">\[
{\color{rgb(225, 65, 185)}\Sigma} = {\color{rgb(137, 225, 65)}w_1} x_1 + {\color{rgb(137, 225, 65)}w_2} x_2 + {\color{rgb(137, 225, 65)}w_3} x_3
\]</span></p></li>
<li class="fragment"><p>Apply non-linearity <span class="math display">\[
\mathbf{\color{rgb(225, 174, 65)}h} = max({\color{rgb(225, 65, 185)}\Sigma}, 0)
\]</span></p></li>
</ol>
<div class="fragment fade-in">
<p><img data-src="img/vanilla-nn/relu.png" style="text-align: center; margin-left: 20%; margin-top: -10%;;width:65.0%"></p>
</div>
</div></div>
<aside class="notes">
<p>The neuron processes the inputs as follows:</p>
<p>First it computes a weighted sum of the inputs. The weights represent the connections between the neurons. The weighted sum can be seen as the neuron attending to different parts of the input.</p>
<p>Then it applies a non-linear function. For example, the rectified linear unit (ReLU) function. This function will output the final output of the neuron</p>
<p>Choosing the ReLU function is not a totally arbitrary choice: the ReLU function is a common choice due to its properties when it comes to optimization via gradient descent. However there are other popular options for activation functions</p>
<p>Note as well that, a non linear function is required for the MLP to be a universal function approximator (along with a hidden layer with enough number of units/neurons)</p>
<p>The activation function is loosely based on biological neurons - It represents that the artificial neuron will respond to inputs beyond a certain threshold. - As it is now, this threshold would be zero: if the weighted sum is positive the neuron will output the result of the weighted sum, if it’s negative it will output zero.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ------------------------------------------------------------------------ -->
</section>
<section id="from-layer-to-layer-one-neuron-2" class="slide level2 scrollable">
<h2>From layer to layer: one neuron</h2>
<div class="columns">
<div class="column" style="margin-left: -15%; margin-top: 5%;">
<div class="cell" data-fig-width="7" data-fig-height="3.5" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="672" height="336" viewbox="0.00 0.00 200.61 194.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 190)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-190 196.61,-190 196.61,4 -4,4"></polygon>
<!-- x1 -->
<g id="node1" class="node">
<title>x1</title>
<ellipse fill="lightblue" stroke="black" cx="25" cy="-161" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="25" y="-156.2" font-family="Arial" font-size="16.00">x₁</text>
</g>
<!-- f -->
<g id="node4" class="node">
<title>f</title>
<ellipse fill="royalblue" stroke="black" cx="167.61" cy="-93" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="167.61" y="-88.2" font-family="Arial" font-size="16.00" fill="royalblue">f</text>
</g>
<!-- x1&#45;&gt;f -->
<g id="edge1" class="edge">
<title>x1-&gt;f</title>
<path fill="none" stroke="#89e141" d="M47.97,-150.38C71.5,-139 109.02,-120.85 135.56,-108.02"></path>
<polygon fill="#89e141" stroke="#89e141" points="137.32,-111.06 144.79,-103.55 134.27,-104.75 137.32,-111.06"></polygon>
<text text-anchor="middle" x="96.31" y="-135.2" font-family="Times,serif" font-size="14.00" fill="#89e141">w₁</text>
</g>
<!-- x2 -->
<g id="node2" class="node">
<title>x2</title>
<ellipse fill="lightblue" stroke="black" cx="25" cy="-93" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="25" y="-88.2" font-family="Arial" font-size="16.00">x₂</text>
</g>
<!-- x2&#45;&gt;f -->
<g id="edge2" class="edge">
<title>x2-&gt;f</title>
<path fill="none" stroke="#89e141" d="M50.17,-93C72.71,-93 106.56,-93 131.97,-93"></path>
<polygon fill="#89e141" stroke="#89e141" points="132.28,-96.5 142.28,-93 132.28,-89.5 132.28,-96.5"></polygon>
<text text-anchor="middle" x="96.31" y="-97.2" font-family="Times,serif" font-size="14.00" fill="#89e141">w₂</text>
</g>
<!-- x3 -->
<g id="node3" class="node">
<title>x3</title>
<ellipse fill="lightblue" stroke="black" cx="25" cy="-25" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="25" y="-20.2" font-family="Arial" font-size="16.00">x₃</text>
</g>
<!-- x3&#45;&gt;f -->
<g id="edge3" class="edge">
<title>x3-&gt;f</title>
<path fill="none" stroke="#89e141" d="M47.97,-35.62C71.5,-47 109.02,-65.15 135.56,-77.98"></path>
<polygon fill="#89e141" stroke="#89e141" points="134.27,-81.25 144.79,-82.45 137.32,-74.94 134.27,-81.25"></polygon>
<text text-anchor="middle" x="96.31" y="-68.2" font-family="Times,serif" font-size="14.00" fill="#89e141">w₃</text>
</g>
<!-- bias -->
<g id="node5" class="node">
<title>bias</title>
<polygon fill="#d51818" stroke="black" points="181.31,-180.7 153.91,-180.7 153.91,-153.3 181.31,-153.3 181.31,-180.7"></polygon>
<text text-anchor="middle" x="167.61" y="-162.2" font-family="Arial" font-size="16.00">b</text>
</g>
<!-- bias&#45;&gt;f -->
<g id="edge4" class="edge">
<title>bias-&gt;f</title>
<path fill="none" stroke="#d51818" stroke-width="2" d="M167.61,-153.19C167.61,-146.1 167.61,-137.12 167.61,-128.26"></path>
<polygon fill="#d51818" stroke="#d51818" stroke-width="2" points="171.11,-128.05 167.61,-118.05 164.11,-128.05 171.11,-128.05"></polygon>
<text text-anchor="middle" x="156.21" y="-131.5" font-family="Times,serif" font-size="14.00" fill="#d51818">+</text>
</g>
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div style="position: absolute; top: 280px; left: 370px; font-size: 24px; font-weight: bold; color: #4169E1; z-index: 2; text-align: right;">
<p><span class="math display">\[
  \mathbf{\color{rgb(225, 174, 65)}h}
  \]</span></p>
</div>
</div><div class="column" style="width:10%;">

</div><div class="column" style="text-align: left;">
<ol type="1">
<li><p>Compute weighted sum <span class="math display">\[
{\color{rgb(225, 65, 185)}\Sigma} = {\color{rgb(137, 225, 65)}w_1} x_1 + {\color{rgb(137, 225, 65)}w_2} x_2 + {\color{rgb(137, 225, 65)}w_3} x_3
\]</span></p></li>
<li><p>Apply non-linearity <span class="math display">\[
\mathbf{\color{rgb(225, 174, 65)}h} = max({\color{rgb(225, 65, 185)}\Sigma} + {\color{rgb(213, 24, 24)}b}, 0)
\]</span></p></li>
</ol>
<div class="r-stack">
<p><img data-src="img/vanilla-nn/relu.png" style="text-align: center; margin-left: 20%; margin-top: -10%;;width:65.0%"></p>
<p><img data-src="img/vanilla-nn/relu-w-bias.png" style="text-align: center; margin-left: 20%; margin-top: -10%;;width:65.0%"></p>
</div>
</div></div>
<aside class="notes">
<p>What if we want a threshold different from zero? One easy way to “control” this threshold with a parameter is to introduce a bias term.</p>
<p>With a bias term, the ReLU function will output the result of the weighted sum if its value is below b, and zero otherwise.</p>
<p>Intuition: the neuron pays attention to certain inputs more than others, if they are large enough.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ------------------------------------------------------------------------ -->
</section>
<section id="from-layer-to-layer-many-neurons" class="slide level2">
<h2>From layer to layer: many neurons</h2>
<div class="columns">
<div class="column">
<p>In an MLP:</p>
<ul>
<li class="fragment">each <em style="color:rgb(137, 225, 65);">connection</em> is associated with a <strong style="color:rgb(137, 225, 65);">weight</strong></li>
<li class="fragment">each <em style="color:rgb(213, 24, 24);">neuron</em> is associated with a <strong style="color:rgb(213, 24, 24);">bias</strong></li>
</ul>
</div><div class="column">
<p><img data-src="img/vanilla-nn/network-3b1b.png" style="margin-left: 20%;;width:80.0%"></p>
<div style="position: absolute; bottom: 50px; right: 7px; font-size: 0.3em; color: var(--link-color);">
Figure from <a href="https://youtu.be/aircAruvnKk?si=PAb025jmbPGYt7hi&amp;t=757" target="_blank"> But what is a neural network? | Deep learning chapter 1</a>
</div>
</div></div>
<aside class="notes">

<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ------------------------------------------------------------------------ -->
</section>

<section id="from-layer-to-layer-many-neurons-2" class="slide level2">
<h2>From layer to layer: many neurons</h2>
<div class="columns">
<div class="column" style="margin-left: -15%;margin-top: 5%;">
<div class="r-stack">
<div class="fragment fade-in" data-fragment-index="0">
<div class="cell" data-fig-width="2" data-fig-height="5" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="192" height="480" viewbox="0.00 0.00 197.62 473.23" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 469.23)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-469.23 193.62,-469.23 193.62,4 -4,4"></polygon>
<!-- h1 -->
<g id="node1" class="node">
<title>h1</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-415.73" rx="30.96" ry="30.96"></ellipse>
<text text-anchor="middle" x="30.73" y="-410.93" font-family="Arial" font-size="16.00">h₀⁰</text>
</g>
<!-- h1_prime -->
<g id="node8" class="node">
<title>h1_prime</title>
<ellipse fill="#7ba4f0" stroke="black" cx="161.54" cy="-365.73" rx="28.16" ry="28.16"></ellipse>
<text text-anchor="middle" x="161.54" y="-360.93" font-family="Arial" font-size="16.00">h₀¹</text>
</g>
<!-- h1&#45;&gt;h1_prime -->
<g id="edge5" class="edge">
<title>h1-&gt;h1_prime</title>
<path fill="none" stroke="#e5e4e2" d="M59.68,-404.88C78.97,-397.39 104.77,-387.38 125.44,-379.35"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="126.78,-382.59 134.83,-375.71 124.25,-376.06 126.78,-382.59"></polygon>
</g>
<!-- h2_prime -->
<g id="node9" class="node">
<title>h2_prime</title>
<ellipse fill="#7ba4f0" stroke="black" cx="161.54" cy="-291.73" rx="28.16" ry="28.16"></ellipse>
<text text-anchor="middle" x="161.54" y="-286.93" font-family="Arial" font-size="16.00">h₁¹</text>
</g>
<!-- h1&#45;&gt;h2_prime -->
<g id="edge6" class="edge">
<title>h1-&gt;h2_prime</title>
<path fill="none" stroke="#e5e4e2" d="M53.58,-394.7C75.6,-373.5 109.64,-340.73 133.38,-317.88"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="135.92,-320.29 140.7,-310.83 131.07,-315.24 135.92,-320.29"></polygon>
</g>
<!-- h3_prime -->
<g id="node10" class="node">
<title>h3_prime</title>
<ellipse fill="#7ba4f0" stroke="black" cx="161.54" cy="-217.73" rx="28.16" ry="28.16"></ellipse>
<text text-anchor="middle" x="161.54" y="-212.93" font-family="Arial" font-size="16.00">h₂¹</text>
</g>
<!-- h1&#45;&gt;h3_prime -->
<g id="edge7" class="edge">
<title>h1-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M48.31,-390.25C71.74,-354.23 114.54,-288.44 139.97,-249.35"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="142.91,-251.25 145.43,-240.96 137.04,-247.43 142.91,-251.25"></polygon>
</g>
<!-- h4_prime -->
<g id="node11" class="node">
<title>h4_prime</title>
<ellipse fill="#7ba4f0" stroke="black" cx="161.54" cy="-146.73" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="161.54" y="-141.93" font-family="Arial" font-size="16.00">...</text>
</g>
<!-- h1&#45;&gt;h4_prime -->
<g id="edge8" class="edge">
<title>h1-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M44.91,-388.21C68.99,-337.91 119.98,-231.44 145.43,-178.3"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="148.71,-179.55 149.87,-169.02 142.39,-176.53 148.71,-179.55"></polygon>
</g>
<!-- h5_prime -->
<g id="node12" class="node">
<title>h5_prime</title>
<ellipse fill="#7ba4f0" stroke="black" cx="161.54" cy="-75.73" rx="28.16" ry="28.16"></ellipse>
<text text-anchor="middle" x="161.54" y="-70.93" font-family="Arial" font-size="16.00">hₖ¹</text>
</g>
<!-- h1&#45;&gt;h5_prime -->
<g id="edge9" class="edge">
<title>h1-&gt;h5_prime</title>
<path fill="none" stroke="#e5e4e2" d="M42.49,-387.33C65.89,-325.57 121.35,-179.17 147.05,-111.35"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="150.34,-112.53 150.61,-101.93 143.8,-110.05 150.34,-112.53"></polygon>
</g>
<!-- h2 -->
<g id="node2" class="node">
<title>h2</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-336.73" rx="30.96" ry="30.96"></ellipse>
<text text-anchor="middle" x="30.73" y="-331.93" font-family="Arial" font-size="16.00">h₁⁰</text>
</g>
<!-- h2&#45;&gt;h1_prime -->
<g id="edge10" class="edge">
<title>h2-&gt;h1_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60.96,-343.31C79.67,-347.52 104.09,-353.02 124.07,-357.52"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="123.53,-360.99 134.06,-359.77 125.07,-354.16 123.53,-360.99"></polygon>
</g>
<!-- h2&#45;&gt;h2_prime -->
<g id="edge11" class="edge">
<title>h2-&gt;h2_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60,-326.85C79.09,-320.18 104.45,-311.33 124.92,-304.17"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="126.24,-307.42 134.53,-300.82 123.94,-300.81 126.24,-307.42"></polygon>
</g>
<!-- h2&#45;&gt;h3_prime -->
<g id="edge12" class="edge">
<title>h2-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M53.87,-316.27C75.72,-296.09 109.17,-265.19 132.78,-243.37"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="135.41,-245.71 140.38,-236.36 130.66,-240.57 135.41,-245.71"></polygon>
</g>
<!-- h2&#45;&gt;h4_prime -->
<g id="edge13" class="edge">
<title>h2-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M48.84,-311.5C72.72,-276.27 115.95,-212.5 141.05,-175.48"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="144,-177.36 146.72,-167.12 138.21,-173.43 144,-177.36"></polygon>
</g>
<!-- h2&#45;&gt;h5_prime -->
<g id="edge14" class="edge">
<title>h2-&gt;h5_prime</title>
<path fill="none" stroke="#e5e4e2" d="M45.27,-309.29C68.93,-261.36 117.71,-162.51 143.58,-110.1"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="146.84,-111.39 148.13,-100.88 140.57,-108.3 146.84,-111.39"></polygon>
</g>
<!-- h3 -->
<g id="node3" class="node">
<title>h3</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-257.73" rx="30.96" ry="30.96"></ellipse>
<text text-anchor="middle" x="30.73" y="-252.93" font-family="Arial" font-size="16.00">h₂⁰</text>
</g>
<!-- h3&#45;&gt;h1_prime -->
<g id="edge15" class="edge">
<title>h3-&gt;h1_prime</title>
<path fill="none" stroke="#e5e4e2" d="M54.76,-277.04C76.25,-295.06 108.4,-322.01 131.61,-341.48"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="129.51,-344.28 139.42,-348.02 134.01,-338.91 129.51,-344.28"></polygon>
</g>
<!-- h3&#45;&gt;h2_prime -->
<g id="edge16" class="edge">
<title>h3-&gt;h2_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60.64,-265.36C79.42,-270.32 104.06,-276.82 124.17,-282.13"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="123.36,-285.54 133.92,-284.7 125.15,-278.77 123.36,-285.54"></polygon>
</g>
<!-- h3&#45;&gt;h3_prime -->
<g id="edge17" class="edge">
<title>h3-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60.32,-248.85C79.21,-242.99 104.14,-235.24 124.41,-228.95"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="125.71,-232.21 134.23,-225.9 123.64,-225.52 125.71,-232.21"></polygon>
</g>
<!-- h3&#45;&gt;h4_prime -->
<g id="edge18" class="edge">
<title>h3-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M54.46,-238.14C76.69,-218.99 110.51,-189.84 133.97,-169.63"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="136.51,-172.06 141.8,-162.88 131.94,-166.76 136.51,-172.06"></polygon>
</g>
<!-- h3&#45;&gt;h5_prime -->
<g id="edge19" class="edge">
<title>h3-&gt;h5_prime</title>
<path fill="none" stroke="#e5e4e2" d="M49.37,-232.81C72.56,-200.05 113.28,-142.5 138.48,-106.9"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="141.61,-108.54 144.53,-98.35 135.9,-104.49 141.61,-108.54"></polygon>
</g>
<!-- h4 -->
<g id="node4" class="node">
<title>h4</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-178.73" rx="30.96" ry="30.96"></ellipse>
<text text-anchor="middle" x="30.73" y="-173.93" font-family="Arial" font-size="16.00">h₃⁰</text>
</g>
<!-- h4&#45;&gt;h1_prime -->
<g id="edge20" class="edge">
<title>h4-&gt;h1_prime</title>
<path fill="none" stroke="#e5e4e2" d="M48.84,-203.56C72.09,-237.32 113.67,-297.69 139.02,-334.48"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="136.23,-336.6 144.78,-342.85 141.99,-332.63 136.23,-336.6"></polygon>
</g>
<!-- h4&#45;&gt;h2_prime -->
<g id="edge21" class="edge">
<title>h4-&gt;h2_prime</title>
<path fill="none" stroke="#e5e4e2" d="M54.46,-198.67C76.14,-217.68 108.84,-246.38 132.2,-266.87"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="129.91,-269.52 139.74,-273.48 134.53,-264.26 129.91,-269.52"></polygon>
</g>
<!-- h4&#45;&gt;h3_prime -->
<g id="edge22" class="edge">
<title>h4-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60.32,-187.39C79.21,-193.11 104.14,-200.65 124.41,-206.79"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="123.64,-210.21 134.23,-209.76 125.67,-203.52 123.64,-210.21"></polygon>
</g>
<!-- h4&#45;&gt;h4_prime -->
<g id="edge23" class="edge">
<title>h4-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60.64,-171.55C80.31,-166.66 106.4,-160.18 126.99,-155.06"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="128.04,-158.41 136.9,-152.6 126.35,-151.62 128.04,-158.41"></polygon>
</g>
<!-- h4&#45;&gt;h5_prime -->
<g id="edge24" class="edge">
<title>h4-&gt;h5_prime</title>
<path fill="none" stroke="#e5e4e2" d="M55.36,-159.84C76.7,-142.77 108.2,-117.58 131.16,-99.22"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="133.58,-101.77 139.2,-92.79 129.21,-96.3 133.58,-101.77"></polygon>
</g>
<!-- h5 -->
<g id="node5" class="node">
<title>h5</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-104.73" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="30.73" y="-99.93" font-family="Arial" font-size="16.00">...</text>
</g>
<!-- h5&#45;&gt;h1_prime -->
<g id="edge25" class="edge">
<title>h5-&gt;h1_prime</title>
<path fill="none" stroke="#e5e4e2" d="M42.71,-126.98C65.27,-172.69 116.94,-277.38 143.73,-331.67"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="140.72,-333.47 148.28,-340.89 146.99,-330.37 140.72,-333.47"></polygon>
</g>
<!-- h5&#45;&gt;h2_prime -->
<g id="edge26" class="edge">
<title>h5-&gt;h2_prime</title>
<path fill="none" stroke="#e5e4e2" d="M45.76,-125.1C68.31,-157.84 112.77,-222.38 139.25,-260.82"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="136.37,-262.82 144.93,-269.07 142.14,-258.85 136.37,-262.82"></polygon>
</g>
<!-- h5&#45;&gt;h3_prime -->
<g id="edge27" class="edge">
<title>h5-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M50.19,-120.92C71.65,-139.75 107.33,-171.05 132.29,-192.95"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="130.17,-195.74 139.99,-199.7 134.78,-190.48 130.17,-195.74"></polygon>
</g>
<!-- h5&#45;&gt;h4_prime -->
<g id="edge28" class="edge">
<title>h5-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M54.76,-112.24C75.06,-118.86 104.86,-128.58 127.67,-136.01"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="126.69,-139.37 137.28,-139.14 128.86,-132.72 126.69,-139.37"></polygon>
</g>
<!-- h5&#45;&gt;h5_prime -->
<g id="edge29" class="edge">
<title>h5-&gt;h5_prime</title>
<path fill="none" stroke="#e5e4e2" d="M55.36,-99.41C74.54,-95.09 101.93,-88.93 123.95,-83.97"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="124.97,-87.33 133.95,-81.72 123.43,-80.5 124.97,-87.33"></polygon>
</g>
<!-- h6 -->
<g id="node6" class="node">
<title>h6</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-30.73" rx="30.96" ry="30.96"></ellipse>
<text text-anchor="middle" x="30.73" y="-25.93" font-family="Arial" font-size="16.00">hₙ⁰</text>
</g>
<!-- h6&#45;&gt;h1_prime -->
<g id="edge30" class="edge">
<title>h6-&gt;h1_prime</title>
<path fill="none" stroke="#e5e4e2" d="M42.71,-59.29C66.15,-120.25 121.02,-262.95 146.76,-329.88"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="143.63,-331.49 150.48,-339.57 150.16,-328.98 143.63,-331.49"></polygon>
</g>
<!-- h6&#45;&gt;h2_prime -->
<g id="edge31" class="edge">
<title>h6-&gt;h2_prime</title>
<path fill="none" stroke="#e5e4e2" d="M45.27,-58.17C68.93,-106.1 117.71,-204.95 143.58,-257.36"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="140.57,-259.16 148.13,-266.58 146.84,-256.07 140.57,-259.16"></polygon>
</g>
<!-- h6&#45;&gt;h3_prime -->
<g id="edge32" class="edge">
<title>h6-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M48.84,-55.56C72.09,-89.32 113.67,-149.69 139.02,-186.48"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="136.23,-188.6 144.78,-194.85 141.99,-184.63 136.23,-188.6"></polygon>
</g>
<!-- h6&#45;&gt;h4_prime -->
<g id="edge33" class="edge">
<title>h6-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M54.17,-50.94C76.7,-71.23 111.38,-102.46 134.97,-123.7"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="132.74,-126.4 142.51,-130.49 137.42,-121.2 132.74,-126.4"></polygon>
</g>
<!-- h6&#45;&gt;h5_prime -->
<g id="edge34" class="edge">
<title>h6-&gt;h5_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60,-40.61C79.09,-47.28 104.45,-56.13 124.92,-63.29"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="123.94,-66.65 134.53,-66.64 126.24,-60.04 123.94,-66.65"></polygon>
</g>
<!-- bias -->
<g id="node7" class="node">
<title>bias</title>
<polygon fill="#7ba4f0" stroke="transparent" points="31.23,-465.23 30.23,-465.23 30.23,-464.23 31.23,-464.23 31.23,-465.23"></polygon>
</g>
<!-- h1_prime&#45;&gt;h2_prime -->
<!-- h2_prime&#45;&gt;h3_prime -->
<!-- h3_prime&#45;&gt;h4_prime -->
<!-- h4_prime&#45;&gt;h5_prime -->
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="1">
<div class="cell" data-fig-width="2" data-fig-height="5" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="192" height="480" viewbox="0.00 0.00 197.62 467.29" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 463.29)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-463.29 193.62,-463.29 193.62,4 -4,4"></polygon>
<!-- h1 -->
<g id="node1" class="node">
<title>h1</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-415.73" rx="30.96" ry="30.96"></ellipse>
<text text-anchor="middle" x="30.73" y="-410.93" font-family="Arial" font-size="16.00">h₀⁰</text>
</g>
<!-- h1_prime -->
<g id="node8" class="node">
<title>h1_prime</title>
<ellipse fill="#7ba4f0" stroke="black" cx="161.54" cy="-365.73" rx="28.16" ry="28.16"></ellipse>
<text text-anchor="middle" x="161.54" y="-360.93" font-family="Arial" font-size="16.00">h₀¹</text>
</g>
<!-- h1&#45;&gt;h1_prime -->
<g id="edge5" class="edge">
<title>h1-&gt;h1_prime</title>
<path fill="none" stroke="#89e141" stroke-width="2" d="M59.68,-404.88C78.97,-397.39 104.77,-387.38 125.44,-379.35"></path>
<polygon fill="#89e141" stroke="#89e141" stroke-width="2" points="126.78,-382.59 134.83,-375.71 124.25,-376.06 126.78,-382.59"></polygon>
</g>
<!-- h2_prime -->
<g id="node9" class="node">
<title>h2_prime</title>
<ellipse fill="#7ba4f0" stroke="black" cx="161.54" cy="-291.73" rx="28.16" ry="28.16"></ellipse>
<text text-anchor="middle" x="161.54" y="-286.93" font-family="Arial" font-size="16.00">h₁¹</text>
</g>
<!-- h1&#45;&gt;h2_prime -->
<g id="edge6" class="edge">
<title>h1-&gt;h2_prime</title>
<path fill="none" stroke="#e5e4e2" d="M53.58,-394.7C75.6,-373.5 109.64,-340.73 133.38,-317.88"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="135.92,-320.29 140.7,-310.83 131.07,-315.24 135.92,-320.29"></polygon>
</g>
<!-- h3_prime -->
<g id="node10" class="node">
<title>h3_prime</title>
<ellipse fill="#7ba4f0" stroke="black" cx="161.54" cy="-217.73" rx="28.16" ry="28.16"></ellipse>
<text text-anchor="middle" x="161.54" y="-212.93" font-family="Arial" font-size="16.00">h₂¹</text>
</g>
<!-- h1&#45;&gt;h3_prime -->
<g id="edge7" class="edge">
<title>h1-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M48.31,-390.25C71.74,-354.23 114.54,-288.44 139.97,-249.35"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="142.91,-251.25 145.43,-240.96 137.04,-247.43 142.91,-251.25"></polygon>
</g>
<!-- h4_prime -->
<g id="node11" class="node">
<title>h4_prime</title>
<ellipse fill="#7ba4f0" stroke="black" cx="161.54" cy="-146.73" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="161.54" y="-141.93" font-family="Arial" font-size="16.00">...</text>
</g>
<!-- h1&#45;&gt;h4_prime -->
<g id="edge8" class="edge">
<title>h1-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M44.91,-388.21C68.99,-337.91 119.98,-231.44 145.43,-178.3"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="148.71,-179.55 149.87,-169.02 142.39,-176.53 148.71,-179.55"></polygon>
</g>
<!-- h5_prime -->
<g id="node12" class="node">
<title>h5_prime</title>
<ellipse fill="#7ba4f0" stroke="black" cx="161.54" cy="-75.73" rx="28.16" ry="28.16"></ellipse>
<text text-anchor="middle" x="161.54" y="-70.93" font-family="Arial" font-size="16.00">hₖ¹</text>
</g>
<!-- h1&#45;&gt;h5_prime -->
<g id="edge9" class="edge">
<title>h1-&gt;h5_prime</title>
<path fill="none" stroke="#e5e4e2" d="M42.49,-387.33C65.89,-325.57 121.35,-179.17 147.05,-111.35"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="150.34,-112.53 150.61,-101.93 143.8,-110.05 150.34,-112.53"></polygon>
</g>
<!-- h2 -->
<g id="node2" class="node">
<title>h2</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-336.73" rx="30.96" ry="30.96"></ellipse>
<text text-anchor="middle" x="30.73" y="-331.93" font-family="Arial" font-size="16.00">h₁⁰</text>
</g>
<!-- h2&#45;&gt;h1_prime -->
<g id="edge10" class="edge">
<title>h2-&gt;h1_prime</title>
<path fill="none" stroke="#89e141" stroke-width="2" d="M60.96,-343.31C79.67,-347.52 104.09,-353.02 124.07,-357.52"></path>
<polygon fill="#89e141" stroke="#89e141" stroke-width="2" points="123.53,-360.99 134.06,-359.77 125.07,-354.16 123.53,-360.99"></polygon>
</g>
<!-- h2&#45;&gt;h2_prime -->
<g id="edge11" class="edge">
<title>h2-&gt;h2_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60,-326.85C79.09,-320.18 104.45,-311.33 124.92,-304.17"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="126.24,-307.42 134.53,-300.82 123.94,-300.81 126.24,-307.42"></polygon>
</g>
<!-- h2&#45;&gt;h3_prime -->
<g id="edge12" class="edge">
<title>h2-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M53.87,-316.27C75.72,-296.09 109.17,-265.19 132.78,-243.37"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="135.41,-245.71 140.38,-236.36 130.66,-240.57 135.41,-245.71"></polygon>
</g>
<!-- h2&#45;&gt;h4_prime -->
<g id="edge13" class="edge">
<title>h2-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M48.84,-311.5C72.72,-276.27 115.95,-212.5 141.05,-175.48"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="144,-177.36 146.72,-167.12 138.21,-173.43 144,-177.36"></polygon>
</g>
<!-- h2&#45;&gt;h5_prime -->
<g id="edge14" class="edge">
<title>h2-&gt;h5_prime</title>
<path fill="none" stroke="#e5e4e2" d="M45.27,-309.29C68.93,-261.36 117.71,-162.51 143.58,-110.1"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="146.84,-111.39 148.13,-100.88 140.57,-108.3 146.84,-111.39"></polygon>
</g>
<!-- h3 -->
<g id="node3" class="node">
<title>h3</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-257.73" rx="30.96" ry="30.96"></ellipse>
<text text-anchor="middle" x="30.73" y="-252.93" font-family="Arial" font-size="16.00">h₂⁰</text>
</g>
<!-- h3&#45;&gt;h1_prime -->
<g id="edge15" class="edge">
<title>h3-&gt;h1_prime</title>
<path fill="none" stroke="#89e141" stroke-width="2" d="M54.76,-277.04C76.25,-295.06 108.4,-322.01 131.61,-341.48"></path>
<polygon fill="#89e141" stroke="#89e141" stroke-width="2" points="129.51,-344.28 139.42,-348.02 134.01,-338.91 129.51,-344.28"></polygon>
</g>
<!-- h3&#45;&gt;h2_prime -->
<g id="edge16" class="edge">
<title>h3-&gt;h2_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60.64,-265.36C79.42,-270.32 104.06,-276.82 124.17,-282.13"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="123.36,-285.54 133.92,-284.7 125.15,-278.77 123.36,-285.54"></polygon>
</g>
<!-- h3&#45;&gt;h3_prime -->
<g id="edge17" class="edge">
<title>h3-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60.32,-248.85C79.21,-242.99 104.14,-235.24 124.41,-228.95"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="125.71,-232.21 134.23,-225.9 123.64,-225.52 125.71,-232.21"></polygon>
</g>
<!-- h3&#45;&gt;h4_prime -->
<g id="edge18" class="edge">
<title>h3-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M54.46,-238.14C76.69,-218.99 110.51,-189.84 133.97,-169.63"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="136.51,-172.06 141.8,-162.88 131.94,-166.76 136.51,-172.06"></polygon>
</g>
<!-- h3&#45;&gt;h5_prime -->
<g id="edge19" class="edge">
<title>h3-&gt;h5_prime</title>
<path fill="none" stroke="#e5e4e2" d="M49.37,-232.81C72.56,-200.05 113.28,-142.5 138.48,-106.9"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="141.61,-108.54 144.53,-98.35 135.9,-104.49 141.61,-108.54"></polygon>
</g>
<!-- h4 -->
<g id="node4" class="node">
<title>h4</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-178.73" rx="30.96" ry="30.96"></ellipse>
<text text-anchor="middle" x="30.73" y="-173.93" font-family="Arial" font-size="16.00">h₃⁰</text>
</g>
<!-- h4&#45;&gt;h1_prime -->
<g id="edge20" class="edge">
<title>h4-&gt;h1_prime</title>
<path fill="none" stroke="#89e141" stroke-width="2" d="M48.84,-203.56C72.09,-237.32 113.67,-297.69 139.02,-334.48"></path>
<polygon fill="#89e141" stroke="#89e141" stroke-width="2" points="136.23,-336.6 144.78,-342.85 141.99,-332.63 136.23,-336.6"></polygon>
</g>
<!-- h4&#45;&gt;h2_prime -->
<g id="edge21" class="edge">
<title>h4-&gt;h2_prime</title>
<path fill="none" stroke="#e5e4e2" d="M54.46,-198.67C76.14,-217.68 108.84,-246.38 132.2,-266.87"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="129.91,-269.52 139.74,-273.48 134.53,-264.26 129.91,-269.52"></polygon>
</g>
<!-- h4&#45;&gt;h3_prime -->
<g id="edge22" class="edge">
<title>h4-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60.32,-187.39C79.21,-193.11 104.14,-200.65 124.41,-206.79"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="123.64,-210.21 134.23,-209.76 125.67,-203.52 123.64,-210.21"></polygon>
</g>
<!-- h4&#45;&gt;h4_prime -->
<g id="edge23" class="edge">
<title>h4-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60.64,-171.55C80.31,-166.66 106.4,-160.18 126.99,-155.06"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="128.04,-158.41 136.9,-152.6 126.35,-151.62 128.04,-158.41"></polygon>
</g>
<!-- h4&#45;&gt;h5_prime -->
<g id="edge24" class="edge">
<title>h4-&gt;h5_prime</title>
<path fill="none" stroke="#e5e4e2" d="M55.36,-159.84C76.7,-142.77 108.2,-117.58 131.16,-99.22"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="133.58,-101.77 139.2,-92.79 129.21,-96.3 133.58,-101.77"></polygon>
</g>
<!-- h5 -->
<g id="node5" class="node">
<title>h5</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-104.73" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="30.73" y="-99.93" font-family="Arial" font-size="16.00">...</text>
</g>
<!-- h5&#45;&gt;h1_prime -->
<g id="edge25" class="edge">
<title>h5-&gt;h1_prime</title>
<path fill="none" stroke="#89e141" stroke-width="2" d="M42.71,-126.98C65.27,-172.69 116.94,-277.38 143.73,-331.67"></path>
<polygon fill="#89e141" stroke="#89e141" stroke-width="2" points="140.72,-333.47 148.28,-340.89 146.99,-330.37 140.72,-333.47"></polygon>
</g>
<!-- h5&#45;&gt;h2_prime -->
<g id="edge26" class="edge">
<title>h5-&gt;h2_prime</title>
<path fill="none" stroke="#e5e4e2" d="M45.76,-125.1C68.31,-157.84 112.77,-222.38 139.25,-260.82"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="136.37,-262.82 144.93,-269.07 142.14,-258.85 136.37,-262.82"></polygon>
</g>
<!-- h5&#45;&gt;h3_prime -->
<g id="edge27" class="edge">
<title>h5-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M50.19,-120.92C71.65,-139.75 107.33,-171.05 132.29,-192.95"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="130.17,-195.74 139.99,-199.7 134.78,-190.48 130.17,-195.74"></polygon>
</g>
<!-- h5&#45;&gt;h4_prime -->
<g id="edge28" class="edge">
<title>h5-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M54.76,-112.24C75.06,-118.86 104.86,-128.58 127.67,-136.01"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="126.69,-139.37 137.28,-139.14 128.86,-132.72 126.69,-139.37"></polygon>
</g>
<!-- h5&#45;&gt;h5_prime -->
<g id="edge29" class="edge">
<title>h5-&gt;h5_prime</title>
<path fill="none" stroke="#e5e4e2" d="M55.36,-99.41C74.54,-95.09 101.93,-88.93 123.95,-83.97"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="124.97,-87.33 133.95,-81.72 123.43,-80.5 124.97,-87.33"></polygon>
</g>
<!-- h6 -->
<g id="node6" class="node">
<title>h6</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-30.73" rx="30.96" ry="30.96"></ellipse>
<text text-anchor="middle" x="30.73" y="-25.93" font-family="Arial" font-size="16.00">hₙ⁰</text>
</g>
<!-- h6&#45;&gt;h1_prime -->
<g id="edge30" class="edge">
<title>h6-&gt;h1_prime</title>
<path fill="none" stroke="#89e141" stroke-width="2" d="M42.71,-59.29C66.15,-120.25 121.02,-262.95 146.76,-329.88"></path>
<polygon fill="#89e141" stroke="#89e141" stroke-width="2" points="143.63,-331.49 150.48,-339.57 150.16,-328.98 143.63,-331.49"></polygon>
</g>
<!-- h6&#45;&gt;h2_prime -->
<g id="edge31" class="edge">
<title>h6-&gt;h2_prime</title>
<path fill="none" stroke="#e5e4e2" d="M45.27,-58.17C68.93,-106.1 117.71,-204.95 143.58,-257.36"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="140.57,-259.16 148.13,-266.58 146.84,-256.07 140.57,-259.16"></polygon>
</g>
<!-- h6&#45;&gt;h3_prime -->
<g id="edge32" class="edge">
<title>h6-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M48.84,-55.56C72.09,-89.32 113.67,-149.69 139.02,-186.48"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="136.23,-188.6 144.78,-194.85 141.99,-184.63 136.23,-188.6"></polygon>
</g>
<!-- h6&#45;&gt;h4_prime -->
<g id="edge33" class="edge">
<title>h6-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M54.17,-50.94C76.7,-71.23 111.38,-102.46 134.97,-123.7"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="132.74,-126.4 142.51,-130.49 137.42,-121.2 132.74,-126.4"></polygon>
</g>
<!-- h6&#45;&gt;h5_prime -->
<g id="edge34" class="edge">
<title>h6-&gt;h5_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60,-40.61C79.09,-47.28 104.45,-56.13 124.92,-63.29"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="123.94,-66.65 134.53,-66.64 126.24,-60.04 123.94,-66.65"></polygon>
</g>
<!-- bias -->
<g id="node7" class="node">
<title>bias</title>
<polygon fill="#d51818" stroke="black" points="185.17,-459.36 137.92,-459.36 137.92,-412.1 185.17,-412.1 185.17,-459.36"></polygon>
<text text-anchor="middle" x="161.54" y="-430.93" font-family="Arial" font-size="16.00">b₀¹</text>
</g>
<!-- bias&#45;&gt;h1_prime -->
<g id="edge35" class="edge">
<title>bias-&gt;h1_prime</title>
<path fill="none" stroke="#d51818" stroke-width="2" stroke-dasharray="5,2" d="M161.54,-411.87C161.54,-405.88 161.54,-399.89 161.54,-393.89"></path>
</g>
<!-- h1_prime&#45;&gt;h2_prime -->
<!-- h2_prime&#45;&gt;h3_prime -->
<!-- h3_prime&#45;&gt;h4_prime -->
<!-- h4_prime&#45;&gt;h5_prime -->
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="4">
<div class="fragment fade-out" data-fragment-index="5">
<div class="cell" data-fig-width="2" data-fig-height="5" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="192" height="480" viewbox="0.00 0.00 197.62 473.23" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 469.23)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-469.23 193.62,-469.23 193.62,4 -4,4"></polygon>
<!-- h1 -->
<g id="node1" class="node">
<title>h1</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-415.73" rx="30.96" ry="30.96"></ellipse>
<text text-anchor="middle" x="30.73" y="-410.93" font-family="Arial" font-size="16.00">h₀⁰</text>
</g>
<!-- h1_prime -->
<g id="node8" class="node">
<title>h1_prime</title>
<ellipse fill="#7ba4f0" stroke="black" cx="161.54" cy="-365.73" rx="28.16" ry="28.16"></ellipse>
<text text-anchor="middle" x="161.54" y="-360.93" font-family="Arial" font-size="16.00">h₀¹</text>
</g>
<!-- h1&#45;&gt;h1_prime -->
<g id="edge5" class="edge">
<title>h1-&gt;h1_prime</title>
<path fill="none" stroke="#e5e4e2" d="M59.68,-404.88C78.97,-397.39 104.77,-387.38 125.44,-379.35"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="126.78,-382.59 134.83,-375.71 124.25,-376.06 126.78,-382.59"></polygon>
</g>
<!-- h2_prime -->
<g id="node9" class="node">
<title>h2_prime</title>
<ellipse fill="#7ba4f0" stroke="black" cx="161.54" cy="-291.73" rx="28.16" ry="28.16"></ellipse>
<text text-anchor="middle" x="161.54" y="-286.93" font-family="Arial" font-size="16.00">h₁¹</text>
</g>
<!-- h1&#45;&gt;h2_prime -->
<g id="edge6" class="edge">
<title>h1-&gt;h2_prime</title>
<path fill="none" stroke="#89e141" stroke-width="2" d="M53.58,-394.7C75.6,-373.5 109.64,-340.73 133.38,-317.88"></path>
<polygon fill="#89e141" stroke="#89e141" stroke-width="2" points="135.92,-320.29 140.7,-310.83 131.07,-315.24 135.92,-320.29"></polygon>
</g>
<!-- h3_prime -->
<g id="node10" class="node">
<title>h3_prime</title>
<ellipse fill="#7ba4f0" stroke="black" cx="161.54" cy="-217.73" rx="28.16" ry="28.16"></ellipse>
<text text-anchor="middle" x="161.54" y="-212.93" font-family="Arial" font-size="16.00">h₂¹</text>
</g>
<!-- h1&#45;&gt;h3_prime -->
<g id="edge7" class="edge">
<title>h1-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M48.31,-390.25C71.74,-354.23 114.54,-288.44 139.97,-249.35"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="142.91,-251.25 145.43,-240.96 137.04,-247.43 142.91,-251.25"></polygon>
</g>
<!-- h4_prime -->
<g id="node11" class="node">
<title>h4_prime</title>
<ellipse fill="#7ba4f0" stroke="black" cx="161.54" cy="-146.73" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="161.54" y="-141.93" font-family="Arial" font-size="16.00">...</text>
</g>
<!-- h1&#45;&gt;h4_prime -->
<g id="edge8" class="edge">
<title>h1-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M44.91,-388.21C68.99,-337.91 119.98,-231.44 145.43,-178.3"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="148.71,-179.55 149.87,-169.02 142.39,-176.53 148.71,-179.55"></polygon>
</g>
<!-- h5_prime -->
<g id="node12" class="node">
<title>h5_prime</title>
<ellipse fill="#7ba4f0" stroke="black" cx="161.54" cy="-75.73" rx="28.16" ry="28.16"></ellipse>
<text text-anchor="middle" x="161.54" y="-70.93" font-family="Arial" font-size="16.00">hₖ¹</text>
</g>
<!-- h1&#45;&gt;h5_prime -->
<g id="edge9" class="edge">
<title>h1-&gt;h5_prime</title>
<path fill="none" stroke="#e5e4e2" d="M42.49,-387.33C65.89,-325.57 121.35,-179.17 147.05,-111.35"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="150.34,-112.53 150.61,-101.93 143.8,-110.05 150.34,-112.53"></polygon>
</g>
<!-- h2 -->
<g id="node2" class="node">
<title>h2</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-336.73" rx="30.96" ry="30.96"></ellipse>
<text text-anchor="middle" x="30.73" y="-331.93" font-family="Arial" font-size="16.00">h₁⁰</text>
</g>
<!-- h2&#45;&gt;h1_prime -->
<g id="edge10" class="edge">
<title>h2-&gt;h1_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60.96,-343.31C79.67,-347.52 104.09,-353.02 124.07,-357.52"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="123.53,-360.99 134.06,-359.77 125.07,-354.16 123.53,-360.99"></polygon>
</g>
<!-- h2&#45;&gt;h2_prime -->
<g id="edge11" class="edge">
<title>h2-&gt;h2_prime</title>
<path fill="none" stroke="#89e141" stroke-width="2" d="M60,-326.85C79.09,-320.18 104.45,-311.33 124.92,-304.17"></path>
<polygon fill="#89e141" stroke="#89e141" stroke-width="2" points="126.24,-307.42 134.53,-300.82 123.94,-300.81 126.24,-307.42"></polygon>
</g>
<!-- h2&#45;&gt;h3_prime -->
<g id="edge12" class="edge">
<title>h2-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M53.87,-316.27C75.72,-296.09 109.17,-265.19 132.78,-243.37"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="135.41,-245.71 140.38,-236.36 130.66,-240.57 135.41,-245.71"></polygon>
</g>
<!-- h2&#45;&gt;h4_prime -->
<g id="edge13" class="edge">
<title>h2-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M48.84,-311.5C72.72,-276.27 115.95,-212.5 141.05,-175.48"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="144,-177.36 146.72,-167.12 138.21,-173.43 144,-177.36"></polygon>
</g>
<!-- h2&#45;&gt;h5_prime -->
<g id="edge14" class="edge">
<title>h2-&gt;h5_prime</title>
<path fill="none" stroke="#e5e4e2" d="M45.27,-309.29C68.93,-261.36 117.71,-162.51 143.58,-110.1"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="146.84,-111.39 148.13,-100.88 140.57,-108.3 146.84,-111.39"></polygon>
</g>
<!-- h3 -->
<g id="node3" class="node">
<title>h3</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-257.73" rx="30.96" ry="30.96"></ellipse>
<text text-anchor="middle" x="30.73" y="-252.93" font-family="Arial" font-size="16.00">h₂⁰</text>
</g>
<!-- h3&#45;&gt;h1_prime -->
<g id="edge15" class="edge">
<title>h3-&gt;h1_prime</title>
<path fill="none" stroke="#e5e4e2" d="M54.76,-277.04C76.25,-295.06 108.4,-322.01 131.61,-341.48"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="129.51,-344.28 139.42,-348.02 134.01,-338.91 129.51,-344.28"></polygon>
</g>
<!-- h3&#45;&gt;h2_prime -->
<g id="edge16" class="edge">
<title>h3-&gt;h2_prime</title>
<path fill="none" stroke="#89e141" stroke-width="2" d="M60.64,-265.36C79.42,-270.32 104.06,-276.82 124.17,-282.13"></path>
<polygon fill="#89e141" stroke="#89e141" stroke-width="2" points="123.36,-285.54 133.92,-284.7 125.15,-278.77 123.36,-285.54"></polygon>
</g>
<!-- h3&#45;&gt;h3_prime -->
<g id="edge17" class="edge">
<title>h3-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60.32,-248.85C79.21,-242.99 104.14,-235.24 124.41,-228.95"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="125.71,-232.21 134.23,-225.9 123.64,-225.52 125.71,-232.21"></polygon>
</g>
<!-- h3&#45;&gt;h4_prime -->
<g id="edge18" class="edge">
<title>h3-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M54.46,-238.14C76.69,-218.99 110.51,-189.84 133.97,-169.63"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="136.51,-172.06 141.8,-162.88 131.94,-166.76 136.51,-172.06"></polygon>
</g>
<!-- h3&#45;&gt;h5_prime -->
<g id="edge19" class="edge">
<title>h3-&gt;h5_prime</title>
<path fill="none" stroke="#e5e4e2" d="M49.37,-232.81C72.56,-200.05 113.28,-142.5 138.48,-106.9"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="141.61,-108.54 144.53,-98.35 135.9,-104.49 141.61,-108.54"></polygon>
</g>
<!-- h4 -->
<g id="node4" class="node">
<title>h4</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-178.73" rx="30.96" ry="30.96"></ellipse>
<text text-anchor="middle" x="30.73" y="-173.93" font-family="Arial" font-size="16.00">h₃⁰</text>
</g>
<!-- h4&#45;&gt;h1_prime -->
<g id="edge20" class="edge">
<title>h4-&gt;h1_prime</title>
<path fill="none" stroke="#e5e4e2" d="M48.84,-203.56C72.09,-237.32 113.67,-297.69 139.02,-334.48"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="136.23,-336.6 144.78,-342.85 141.99,-332.63 136.23,-336.6"></polygon>
</g>
<!-- h4&#45;&gt;h2_prime -->
<g id="edge21" class="edge">
<title>h4-&gt;h2_prime</title>
<path fill="none" stroke="#89e141" stroke-width="2" d="M54.46,-198.67C76.14,-217.68 108.84,-246.38 132.2,-266.87"></path>
<polygon fill="#89e141" stroke="#89e141" stroke-width="2" points="129.91,-269.52 139.74,-273.48 134.53,-264.26 129.91,-269.52"></polygon>
</g>
<!-- h4&#45;&gt;h3_prime -->
<g id="edge22" class="edge">
<title>h4-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60.32,-187.39C79.21,-193.11 104.14,-200.65 124.41,-206.79"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="123.64,-210.21 134.23,-209.76 125.67,-203.52 123.64,-210.21"></polygon>
</g>
<!-- h4&#45;&gt;h4_prime -->
<g id="edge23" class="edge">
<title>h4-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60.64,-171.55C80.31,-166.66 106.4,-160.18 126.99,-155.06"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="128.04,-158.41 136.9,-152.6 126.35,-151.62 128.04,-158.41"></polygon>
</g>
<!-- h4&#45;&gt;h5_prime -->
<g id="edge24" class="edge">
<title>h4-&gt;h5_prime</title>
<path fill="none" stroke="#e5e4e2" d="M55.36,-159.84C76.7,-142.77 108.2,-117.58 131.16,-99.22"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="133.58,-101.77 139.2,-92.79 129.21,-96.3 133.58,-101.77"></polygon>
</g>
<!-- h5 -->
<g id="node5" class="node">
<title>h5</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-104.73" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="30.73" y="-99.93" font-family="Arial" font-size="16.00">...</text>
</g>
<!-- h5&#45;&gt;h1_prime -->
<g id="edge25" class="edge">
<title>h5-&gt;h1_prime</title>
<path fill="none" stroke="#e5e4e2" d="M42.71,-126.98C65.27,-172.69 116.94,-277.38 143.73,-331.67"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="140.72,-333.47 148.28,-340.89 146.99,-330.37 140.72,-333.47"></polygon>
</g>
<!-- h5&#45;&gt;h2_prime -->
<g id="edge26" class="edge">
<title>h5-&gt;h2_prime</title>
<path fill="none" stroke="#89e141" stroke-width="2" d="M45.76,-125.1C68.31,-157.84 112.77,-222.38 139.25,-260.82"></path>
<polygon fill="#89e141" stroke="#89e141" stroke-width="2" points="136.37,-262.82 144.93,-269.07 142.14,-258.85 136.37,-262.82"></polygon>
</g>
<!-- h5&#45;&gt;h3_prime -->
<g id="edge27" class="edge">
<title>h5-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M50.19,-120.92C71.65,-139.75 107.33,-171.05 132.29,-192.95"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="130.17,-195.74 139.99,-199.7 134.78,-190.48 130.17,-195.74"></polygon>
</g>
<!-- h5&#45;&gt;h4_prime -->
<g id="edge28" class="edge">
<title>h5-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M54.76,-112.24C75.06,-118.86 104.86,-128.58 127.67,-136.01"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="126.69,-139.37 137.28,-139.14 128.86,-132.72 126.69,-139.37"></polygon>
</g>
<!-- h5&#45;&gt;h5_prime -->
<g id="edge29" class="edge">
<title>h5-&gt;h5_prime</title>
<path fill="none" stroke="#e5e4e2" d="M55.36,-99.41C74.54,-95.09 101.93,-88.93 123.95,-83.97"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="124.97,-87.33 133.95,-81.72 123.43,-80.5 124.97,-87.33"></polygon>
</g>
<!-- h6 -->
<g id="node6" class="node">
<title>h6</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-30.73" rx="30.96" ry="30.96"></ellipse>
<text text-anchor="middle" x="30.73" y="-25.93" font-family="Arial" font-size="16.00">hₙ⁰</text>
</g>
<!-- h6&#45;&gt;h1_prime -->
<g id="edge30" class="edge">
<title>h6-&gt;h1_prime</title>
<path fill="none" stroke="#e5e4e2" d="M42.71,-59.29C66.15,-120.25 121.02,-262.95 146.76,-329.88"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="143.63,-331.49 150.48,-339.57 150.16,-328.98 143.63,-331.49"></polygon>
</g>
<!-- h6&#45;&gt;h2_prime -->
<g id="edge31" class="edge">
<title>h6-&gt;h2_prime</title>
<path fill="none" stroke="#89e141" stroke-width="2" d="M45.27,-58.17C68.93,-106.1 117.71,-204.95 143.58,-257.36"></path>
<polygon fill="#89e141" stroke="#89e141" stroke-width="2" points="140.57,-259.16 148.13,-266.58 146.84,-256.07 140.57,-259.16"></polygon>
</g>
<!-- h6&#45;&gt;h3_prime -->
<g id="edge32" class="edge">
<title>h6-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M48.84,-55.56C72.09,-89.32 113.67,-149.69 139.02,-186.48"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="136.23,-188.6 144.78,-194.85 141.99,-184.63 136.23,-188.6"></polygon>
</g>
<!-- h6&#45;&gt;h4_prime -->
<g id="edge33" class="edge">
<title>h6-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M54.17,-50.94C76.7,-71.23 111.38,-102.46 134.97,-123.7"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="132.74,-126.4 142.51,-130.49 137.42,-121.2 132.74,-126.4"></polygon>
</g>
<!-- h6&#45;&gt;h5_prime -->
<g id="edge34" class="edge">
<title>h6-&gt;h5_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60,-40.61C79.09,-47.28 104.45,-56.13 124.92,-63.29"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="123.94,-66.65 134.53,-66.64 126.24,-60.04 123.94,-66.65"></polygon>
</g>
<!-- bias -->
<g id="node7" class="node">
<title>bias</title>
<polygon fill="#7ba4f0" stroke="transparent" points="31.23,-465.23 30.23,-465.23 30.23,-464.23 31.23,-464.23 31.23,-465.23"></polygon>
</g>
<!-- h1_prime&#45;&gt;h2_prime -->
<!-- h2_prime&#45;&gt;h3_prime -->
<!-- h3_prime&#45;&gt;h4_prime -->
<!-- h4_prime&#45;&gt;h5_prime -->
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="5">
<div class="fragment fade-out" data-fragment-index="6">
<div class="cell" data-fig-width="2" data-fig-height="5" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="192" height="480" viewbox="0.00 0.00 197.62 473.23" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 469.23)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-469.23 193.62,-469.23 193.62,4 -4,4"></polygon>
<!-- h1 -->
<g id="node1" class="node">
<title>h1</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-415.73" rx="30.96" ry="30.96"></ellipse>
<text text-anchor="middle" x="30.73" y="-410.93" font-family="Arial" font-size="16.00">h₀⁰</text>
</g>
<!-- h1_prime -->
<g id="node8" class="node">
<title>h1_prime</title>
<ellipse fill="#7ba4f0" stroke="black" cx="161.54" cy="-365.73" rx="28.16" ry="28.16"></ellipse>
<text text-anchor="middle" x="161.54" y="-360.93" font-family="Arial" font-size="16.00">h₀¹</text>
</g>
<!-- h1&#45;&gt;h1_prime -->
<g id="edge5" class="edge">
<title>h1-&gt;h1_prime</title>
<path fill="none" stroke="#e5e4e2" d="M59.68,-404.88C78.97,-397.39 104.77,-387.38 125.44,-379.35"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="126.78,-382.59 134.83,-375.71 124.25,-376.06 126.78,-382.59"></polygon>
</g>
<!-- h2_prime -->
<g id="node9" class="node">
<title>h2_prime</title>
<ellipse fill="#7ba4f0" stroke="black" cx="161.54" cy="-291.73" rx="28.16" ry="28.16"></ellipse>
<text text-anchor="middle" x="161.54" y="-286.93" font-family="Arial" font-size="16.00">h₁¹</text>
</g>
<!-- h1&#45;&gt;h2_prime -->
<g id="edge6" class="edge">
<title>h1-&gt;h2_prime</title>
<path fill="none" stroke="#e5e4e2" d="M53.58,-394.7C75.6,-373.5 109.64,-340.73 133.38,-317.88"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="135.92,-320.29 140.7,-310.83 131.07,-315.24 135.92,-320.29"></polygon>
</g>
<!-- h3_prime -->
<g id="node10" class="node">
<title>h3_prime</title>
<ellipse fill="#7ba4f0" stroke="black" cx="161.54" cy="-217.73" rx="28.16" ry="28.16"></ellipse>
<text text-anchor="middle" x="161.54" y="-212.93" font-family="Arial" font-size="16.00">h₂¹</text>
</g>
<!-- h1&#45;&gt;h3_prime -->
<g id="edge7" class="edge">
<title>h1-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M48.31,-390.25C71.74,-354.23 114.54,-288.44 139.97,-249.35"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="142.91,-251.25 145.43,-240.96 137.04,-247.43 142.91,-251.25"></polygon>
</g>
<!-- h4_prime -->
<g id="node11" class="node">
<title>h4_prime</title>
<ellipse fill="#7ba4f0" stroke="black" cx="161.54" cy="-146.73" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="161.54" y="-141.93" font-family="Arial" font-size="16.00">...</text>
</g>
<!-- h1&#45;&gt;h4_prime -->
<g id="edge8" class="edge">
<title>h1-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M44.91,-388.21C68.99,-337.91 119.98,-231.44 145.43,-178.3"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="148.71,-179.55 149.87,-169.02 142.39,-176.53 148.71,-179.55"></polygon>
</g>
<!-- h5_prime -->
<g id="node12" class="node">
<title>h5_prime</title>
<ellipse fill="#7ba4f0" stroke="black" cx="161.54" cy="-75.73" rx="28.16" ry="28.16"></ellipse>
<text text-anchor="middle" x="161.54" y="-70.93" font-family="Arial" font-size="16.00">hₖ¹</text>
</g>
<!-- h1&#45;&gt;h5_prime -->
<g id="edge9" class="edge">
<title>h1-&gt;h5_prime</title>
<path fill="none" stroke="#89e141" stroke-width="2" d="M42.49,-387.33C65.89,-325.57 121.35,-179.17 147.05,-111.35"></path>
<polygon fill="#89e141" stroke="#89e141" stroke-width="2" points="150.34,-112.53 150.61,-101.93 143.8,-110.05 150.34,-112.53"></polygon>
</g>
<!-- h2 -->
<g id="node2" class="node">
<title>h2</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-336.73" rx="30.96" ry="30.96"></ellipse>
<text text-anchor="middle" x="30.73" y="-331.93" font-family="Arial" font-size="16.00">h₁⁰</text>
</g>
<!-- h2&#45;&gt;h1_prime -->
<g id="edge10" class="edge">
<title>h2-&gt;h1_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60.96,-343.31C79.67,-347.52 104.09,-353.02 124.07,-357.52"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="123.53,-360.99 134.06,-359.77 125.07,-354.16 123.53,-360.99"></polygon>
</g>
<!-- h2&#45;&gt;h2_prime -->
<g id="edge11" class="edge">
<title>h2-&gt;h2_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60,-326.85C79.09,-320.18 104.45,-311.33 124.92,-304.17"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="126.24,-307.42 134.53,-300.82 123.94,-300.81 126.24,-307.42"></polygon>
</g>
<!-- h2&#45;&gt;h3_prime -->
<g id="edge12" class="edge">
<title>h2-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M53.87,-316.27C75.72,-296.09 109.17,-265.19 132.78,-243.37"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="135.41,-245.71 140.38,-236.36 130.66,-240.57 135.41,-245.71"></polygon>
</g>
<!-- h2&#45;&gt;h4_prime -->
<g id="edge13" class="edge">
<title>h2-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M48.84,-311.5C72.72,-276.27 115.95,-212.5 141.05,-175.48"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="144,-177.36 146.72,-167.12 138.21,-173.43 144,-177.36"></polygon>
</g>
<!-- h2&#45;&gt;h5_prime -->
<g id="edge14" class="edge">
<title>h2-&gt;h5_prime</title>
<path fill="none" stroke="#89e141" stroke-width="2" d="M45.27,-309.29C68.93,-261.36 117.71,-162.51 143.58,-110.1"></path>
<polygon fill="#89e141" stroke="#89e141" stroke-width="2" points="146.84,-111.39 148.13,-100.88 140.57,-108.3 146.84,-111.39"></polygon>
</g>
<!-- h3 -->
<g id="node3" class="node">
<title>h3</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-257.73" rx="30.96" ry="30.96"></ellipse>
<text text-anchor="middle" x="30.73" y="-252.93" font-family="Arial" font-size="16.00">h₂⁰</text>
</g>
<!-- h3&#45;&gt;h1_prime -->
<g id="edge15" class="edge">
<title>h3-&gt;h1_prime</title>
<path fill="none" stroke="#e5e4e2" d="M54.76,-277.04C76.25,-295.06 108.4,-322.01 131.61,-341.48"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="129.51,-344.28 139.42,-348.02 134.01,-338.91 129.51,-344.28"></polygon>
</g>
<!-- h3&#45;&gt;h2_prime -->
<g id="edge16" class="edge">
<title>h3-&gt;h2_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60.64,-265.36C79.42,-270.32 104.06,-276.82 124.17,-282.13"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="123.36,-285.54 133.92,-284.7 125.15,-278.77 123.36,-285.54"></polygon>
</g>
<!-- h3&#45;&gt;h3_prime -->
<g id="edge17" class="edge">
<title>h3-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60.32,-248.85C79.21,-242.99 104.14,-235.24 124.41,-228.95"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="125.71,-232.21 134.23,-225.9 123.64,-225.52 125.71,-232.21"></polygon>
</g>
<!-- h3&#45;&gt;h4_prime -->
<g id="edge18" class="edge">
<title>h3-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M54.46,-238.14C76.69,-218.99 110.51,-189.84 133.97,-169.63"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="136.51,-172.06 141.8,-162.88 131.94,-166.76 136.51,-172.06"></polygon>
</g>
<!-- h3&#45;&gt;h5_prime -->
<g id="edge19" class="edge">
<title>h3-&gt;h5_prime</title>
<path fill="none" stroke="#89e141" stroke-width="2" d="M49.37,-232.81C72.56,-200.05 113.28,-142.5 138.48,-106.9"></path>
<polygon fill="#89e141" stroke="#89e141" stroke-width="2" points="141.61,-108.54 144.53,-98.35 135.9,-104.49 141.61,-108.54"></polygon>
</g>
<!-- h4 -->
<g id="node4" class="node">
<title>h4</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-178.73" rx="30.96" ry="30.96"></ellipse>
<text text-anchor="middle" x="30.73" y="-173.93" font-family="Arial" font-size="16.00">h₃⁰</text>
</g>
<!-- h4&#45;&gt;h1_prime -->
<g id="edge20" class="edge">
<title>h4-&gt;h1_prime</title>
<path fill="none" stroke="#e5e4e2" d="M48.84,-203.56C72.09,-237.32 113.67,-297.69 139.02,-334.48"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="136.23,-336.6 144.78,-342.85 141.99,-332.63 136.23,-336.6"></polygon>
</g>
<!-- h4&#45;&gt;h2_prime -->
<g id="edge21" class="edge">
<title>h4-&gt;h2_prime</title>
<path fill="none" stroke="#e5e4e2" d="M54.46,-198.67C76.14,-217.68 108.84,-246.38 132.2,-266.87"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="129.91,-269.52 139.74,-273.48 134.53,-264.26 129.91,-269.52"></polygon>
</g>
<!-- h4&#45;&gt;h3_prime -->
<g id="edge22" class="edge">
<title>h4-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60.32,-187.39C79.21,-193.11 104.14,-200.65 124.41,-206.79"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="123.64,-210.21 134.23,-209.76 125.67,-203.52 123.64,-210.21"></polygon>
</g>
<!-- h4&#45;&gt;h4_prime -->
<g id="edge23" class="edge">
<title>h4-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M60.64,-171.55C80.31,-166.66 106.4,-160.18 126.99,-155.06"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="128.04,-158.41 136.9,-152.6 126.35,-151.62 128.04,-158.41"></polygon>
</g>
<!-- h4&#45;&gt;h5_prime -->
<g id="edge24" class="edge">
<title>h4-&gt;h5_prime</title>
<path fill="none" stroke="#89e141" stroke-width="2" d="M55.36,-159.84C76.7,-142.77 108.2,-117.58 131.16,-99.22"></path>
<polygon fill="#89e141" stroke="#89e141" stroke-width="2" points="133.58,-101.77 139.2,-92.79 129.21,-96.3 133.58,-101.77"></polygon>
</g>
<!-- h5 -->
<g id="node5" class="node">
<title>h5</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-104.73" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="30.73" y="-99.93" font-family="Arial" font-size="16.00">...</text>
</g>
<!-- h5&#45;&gt;h1_prime -->
<g id="edge25" class="edge">
<title>h5-&gt;h1_prime</title>
<path fill="none" stroke="#e5e4e2" d="M42.71,-126.98C65.27,-172.69 116.94,-277.38 143.73,-331.67"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="140.72,-333.47 148.28,-340.89 146.99,-330.37 140.72,-333.47"></polygon>
</g>
<!-- h5&#45;&gt;h2_prime -->
<g id="edge26" class="edge">
<title>h5-&gt;h2_prime</title>
<path fill="none" stroke="#e5e4e2" d="M45.76,-125.1C68.31,-157.84 112.77,-222.38 139.25,-260.82"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="136.37,-262.82 144.93,-269.07 142.14,-258.85 136.37,-262.82"></polygon>
</g>
<!-- h5&#45;&gt;h3_prime -->
<g id="edge27" class="edge">
<title>h5-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M50.19,-120.92C71.65,-139.75 107.33,-171.05 132.29,-192.95"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="130.17,-195.74 139.99,-199.7 134.78,-190.48 130.17,-195.74"></polygon>
</g>
<!-- h5&#45;&gt;h4_prime -->
<g id="edge28" class="edge">
<title>h5-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M54.76,-112.24C75.06,-118.86 104.86,-128.58 127.67,-136.01"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="126.69,-139.37 137.28,-139.14 128.86,-132.72 126.69,-139.37"></polygon>
</g>
<!-- h5&#45;&gt;h5_prime -->
<g id="edge29" class="edge">
<title>h5-&gt;h5_prime</title>
<path fill="none" stroke="#89e141" stroke-width="2" d="M55.36,-99.41C74.54,-95.09 101.93,-88.93 123.95,-83.97"></path>
<polygon fill="#89e141" stroke="#89e141" stroke-width="2" points="124.97,-87.33 133.95,-81.72 123.43,-80.5 124.97,-87.33"></polygon>
</g>
<!-- h6 -->
<g id="node6" class="node">
<title>h6</title>
<ellipse fill="lightblue" stroke="black" cx="30.73" cy="-30.73" rx="30.96" ry="30.96"></ellipse>
<text text-anchor="middle" x="30.73" y="-25.93" font-family="Arial" font-size="16.00">hₙ⁰</text>
</g>
<!-- h6&#45;&gt;h1_prime -->
<g id="edge30" class="edge">
<title>h6-&gt;h1_prime</title>
<path fill="none" stroke="#e5e4e2" d="M42.71,-59.29C66.15,-120.25 121.02,-262.95 146.76,-329.88"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="143.63,-331.49 150.48,-339.57 150.16,-328.98 143.63,-331.49"></polygon>
</g>
<!-- h6&#45;&gt;h2_prime -->
<g id="edge31" class="edge">
<title>h6-&gt;h2_prime</title>
<path fill="none" stroke="#e5e4e2" d="M45.27,-58.17C68.93,-106.1 117.71,-204.95 143.58,-257.36"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="140.57,-259.16 148.13,-266.58 146.84,-256.07 140.57,-259.16"></polygon>
</g>
<!-- h6&#45;&gt;h3_prime -->
<g id="edge32" class="edge">
<title>h6-&gt;h3_prime</title>
<path fill="none" stroke="#e5e4e2" d="M48.84,-55.56C72.09,-89.32 113.67,-149.69 139.02,-186.48"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="136.23,-188.6 144.78,-194.85 141.99,-184.63 136.23,-188.6"></polygon>
</g>
<!-- h6&#45;&gt;h4_prime -->
<g id="edge33" class="edge">
<title>h6-&gt;h4_prime</title>
<path fill="none" stroke="#e5e4e2" d="M54.17,-50.94C76.7,-71.23 111.38,-102.46 134.97,-123.7"></path>
<polygon fill="#e5e4e2" stroke="#e5e4e2" points="132.74,-126.4 142.51,-130.49 137.42,-121.2 132.74,-126.4"></polygon>
</g>
<!-- h6&#45;&gt;h5_prime -->
<g id="edge34" class="edge">
<title>h6-&gt;h5_prime</title>
<path fill="none" stroke="#89e141" stroke-width="2" d="M60,-40.61C79.09,-47.28 104.45,-56.13 124.92,-63.29"></path>
<polygon fill="#89e141" stroke="#89e141" stroke-width="2" points="123.94,-66.65 134.53,-66.64 126.24,-60.04 123.94,-66.65"></polygon>
</g>
<!-- bias -->
<g id="node7" class="node">
<title>bias</title>
<polygon fill="#7ba4f0" stroke="transparent" points="31.23,-465.23 30.23,-465.23 30.23,-464.23 31.23,-464.23 31.23,-465.23"></polygon>
</g>
<!-- h1_prime&#45;&gt;h2_prime -->
<!-- h2_prime&#45;&gt;h3_prime -->
<!-- h3_prime&#45;&gt;h4_prime -->
<!-- h4_prime&#45;&gt;h5_prime -->
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
</div>
</div>
</div><div class="column" style="margin-left: -10%;">
<div class="fragment fade-in" data-fragment-index="1">
<p><span class="math display">\[
\small
\qquad \color{rgb(0, 0, 255)}{h_0^1} = ReLU(\sum_{i=0}^{n} \color{rgb(137, 225, 65)}{w_i^{0,1}} \color{rgb(173, 216, 230)}{h_i^0}  + \color{rgb(213, 24, 24)}{b_0^1})
\]</span></p>
</div>
<div class="r-stack">
<div class="fragment fade-in" data-fragment-index="2">
<div class="fragment fade-out" data-fragment-index="3">
<p><span class="math display">\[
\scriptstyle
ReLU\left( \begin{bmatrix} w_{0,0} &amp; \cdots &amp; w_{0,n} \\ \vdots &amp; \ddots &amp; \vdots \\ w_{k,0} &amp; \cdots &amp; w_{k,n} \end{bmatrix} \begin{bmatrix} h_0^0 \\ \vdots \\ h_n^0 \end{bmatrix} + \begin{bmatrix} b_0^1 \\ \vdots \\ b_k^1 \end{bmatrix} \right) = \begin{bmatrix} h_0^1 \\ \vdots \\ h_k^1 \end{bmatrix}
\]</span></p>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="3">
<div class="fragment fade-out" data-fragment-index="4">
<div class="equation-container">
<span class="math display">\[
\scriptstyle
ReLU\left( \begin{bmatrix} w_{0,0} &amp; \cdots &amp; w_{0,n} \\ \vdots &amp; \ddots &amp; \vdots \\ w_{k,0} &amp; \cdots &amp; w_{k,n} \end{bmatrix} \begin{bmatrix} h_0^0 \\ \vdots \\ h_n^0 \end{bmatrix} + \begin{bmatrix} b_0^1 \\ \vdots \\ b_k^1 \end{bmatrix} \right) = \begin{bmatrix} h_0^1 \\ \vdots \\ h_k^1 \end{bmatrix}
\]</span>
<div class="highlight-box" style="background-color: rgba(137, 225, 65, 0.3); border: 2px solid rgba(137, 225, 65, 0.3); top: 30px; left: 110px; width: 275px; height: 60px;">

</div>
<div class="highlight-box" style="background-color: rgba(173, 216, 230, 0.3); border: 2px solid  rgba(173, 216, 230, 0.3); top: 40px; left: 405px; width: 71px; height: 165px;">

</div>
<div class="highlight-box" style="background-color: rgba(213, 24, 24, 0.3); border: 2px solid rgba(213, 24, 24, 0.3); top: 40px; left: 500px; width: 71px; height: 45px;">

</div>
<div class="highlight-box" style="background-color: rgba(0, 0, 255, 0.3); border: 2px solid rgba(0, 0, 255, 0.3) ; top: 40px; left: 615px; width: 72px; height: 45px;">

</div>
</div>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="4">
<div class="fragment fade-out" data-fragment-index="5">
<div class="equation-container">
<span class="math display">\[
\scriptstyle
ReLU\left( \begin{bmatrix} w_{0,0} &amp; \cdots &amp; w_{0,n} \\ \vdots &amp; \ddots &amp; \vdots \\ w_{k,0} &amp; \cdots &amp; w_{k,n} \end{bmatrix} \begin{bmatrix} h_0^0 \\ \vdots \\ h_n^0 \end{bmatrix} + \begin{bmatrix} b_0^1 \\ \vdots \\ b_k^1 \end{bmatrix} \right) = \begin{bmatrix} h_0^1 \\ \vdots \\ h_k^1 \end{bmatrix}
\]</span>
<div class="highlight-box" style="background-color: rgba(137, 225, 65, 0.3); border: 2px solid rgba(137, 225, 65, 0.3); top: 90px; left: 110px; width: 275px; height: 60px;">

</div>
<div class="highlight-box" style="background-color: rgba(173, 216, 230, 0.3); border: 2px solid  rgba(173, 216, 230, 0.3); top: 40px; left: 405px; width: 71px; height: 165px;">

</div>
<div class="highlight-box" style="background-color: rgba(213, 24, 24, 0.3); border: 2px solid rgba(213, 24, 24, 0.3); top: 95px; left: 500px; width: 71px; height: 45px;">

</div>
<div class="highlight-box" style="background-color: rgba(0, 0, 255, 0.3); border: 2px solid rgba(0, 0, 255, 0.3) ; top: 95px; left: 615px; width: 72px; height: 45px;">

</div>
</div>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="5">
<div class="fragment fade-out" data-fragment-index="6">
<div class="equation-container">
<span class="math display">\[
\scriptstyle
ReLU\left( \begin{bmatrix} w_{0,0} &amp; \cdots &amp; w_{0,n} \\ \vdots &amp; \ddots &amp; \vdots \\ w_{k,0} &amp; \cdots &amp; w_{k,n} \end{bmatrix} \begin{bmatrix} h_0^0 \\ \vdots \\ h_n^0 \end{bmatrix} + \begin{bmatrix} b_0^1 \\ \vdots \\ b_k^1 \end{bmatrix} \right) = \begin{bmatrix} h_0^1 \\ \vdots \\ h_k^1 \end{bmatrix}
\]</span>
<div class="highlight-box" style="background-color: rgba(137, 225, 65, 0.3); border: 2px solid rgba(137, 225, 65, 0.3); top: 150px; left: 110px; width: 275px; height: 60px;">

</div>
<div class="highlight-box" style="background-color: rgba(173, 216, 230, 0.3); border: 2px solid  rgba(173, 216, 230, 0.3); top: 40px; left: 405px; width: 71px; height: 165px;">

</div>
<div class="highlight-box" style="background-color: rgba(213, 24, 24, 0.3); border: 2px solid rgba(213, 24, 24, 0.3); top: 157px; left: 500px; width: 71px; height: 45px;">

</div>
<div class="highlight-box" style="background-color: rgba(0, 0, 255, 0.3); border: 2px solid rgba(0, 0, 255, 0.3) ; top: 157px; left: 615px; width: 72px; height: 45px;">

</div>
</div>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="6">
<div class="fragment fade-out" data-fragment-index="7">
<div class="equation-container">
<span class="math display">\[
\scriptstyle
ReLU\left( \begin{bmatrix} w_{0,0} &amp; \cdots &amp; w_{0,n} &amp; b_0^1 \\ \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\ w_{k,0} &amp; \cdots &amp; w_{k,n} &amp; b_k^1 \end{bmatrix} \begin{bmatrix} h_0^0 \\ \vdots \\ h_n^0 \\ 1 \end{bmatrix} \right) = \begin{bmatrix} h_0^1 \\ \vdots \\ h_k^1 \end{bmatrix}
\]</span>
<div class="highlight-box" style="background-color: rgba(137, 225, 65, 0.3); border: 2px solid rgba(137, 225, 65, 0.3); top: 55px; left: 110px; width: 275px; height: 60px;">

</div>
<div class="highlight-box" style="background-color: rgba(213, 24, 24, 0.3); border: 2px solid  rgba(213, 24, 24, 0.3); top: 55px; left: 415px; width: 65px; height: 180px;">

</div>
<div class="highlight-box" style="background-color: rgba(173, 216, 230, 0.3); border: 2px solid rgba(173, 216, 230, 0.3); top: 40px; left: 490px; width: 71px; height: 220px;">

</div>
<div class="highlight-box" style="background-color: rgba(0, 0, 255, 0.3); border: 2px solid rgba(0, 0, 255, 0.3) ; top: 55px; left: 600px; width: 75px; height: 180px;">

</div>
</div>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="7">
<p><span class="math display">\[
ReLU(\color{rgb(137, 225, 65)}{\mathbf{W}'} \color{rgb(173, 216, 230)}{h^{0^{\prime}}} ) = \color{rgb(0, 0, 255)}{h^1}
\]</span></p>
</div>
</div>
</div></div>
<aside class="notes">
<p>We can use matrix multiplication to extend that expression to all the neurons in layer 1.</p>
<p>If you remember matrix multiplication from linear algebra…. you’ll see that the computation of the first neuron in layer 1 is equivalent to the one above (we multiply the first row and the first column to obtain the element at the first row and first column, etc.)</p>
<p>We now have a <strong>weight matrix</strong>, that collects all the weights representing the connections between all the neurons in layer 0 and all the neurons in layer 1. The first row in the weight matrix has the weights required to compute the output of the first neuron in layer 1, the second row those required to compute neuron 2, and so on until the k-th row to compute the k-th neuron.</p>
<p>The vector that multiplies with this matrix collects the neurons in the previous layer. To the result of this multiplication we add the bias term of each neuron in layer 1 and then feed the result to a ReLU function to obtain the final number held by the neurons in layer 1</p>
<p>Often the bias vector is included in the weight matrix as an additional column for further compactness.</p>
<p>But note that if we adequately respect the dimensions and add a 1 as a last row in the vector of neurons in the previous layer, both expressions are equivalent</p>
<p>Just remember that there is a compact way that is often preferred to express the transition from one layer to the next. And that often making use of this bias trick the bias is omitted, but it’s implicitly considered within the weight matrix as we’ve seen.</p>
<p>Expressing the transformations as vectorised operations is very convenient for computing efficiency (we have specialised hardware that performs this operations very fast)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ---------------------------- -->
</section>
<section id="a-two-layer-network" class="slide level2">
<h2>A two layer network</h2>
<div class="columns">
<div class="column" style="margin-left: -5%;margin-top: 5%;">
<div class="cell" data-fig-width="5" data-fig-height="5" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="480" height="480" viewbox="0.00 0.00 434.26 485.50" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 481.5)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-481.5 430.26,-481.5 430.26,4 -4,4"></polygon>
<!-- x1 -->
<g id="node1" class="node">
<title>x1</title>
<ellipse fill="#5c90e0" stroke="black" cx="43.02" cy="-433" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="43.02" y="-428.2" font-family="Arial" font-size="16.00">x₀</text>
</g>
<!-- x2 -->
<g id="node2" class="node">
<title>x2</title>
<ellipse fill="#5c90e0" stroke="black" cx="43.02" cy="-365" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="43.02" y="-360.2" font-family="Arial" font-size="16.00">x₁</text>
</g>
<!-- x1&#45;&gt;x2 -->
<!-- h1 -->
<g id="node8" class="node">
<title>h1</title>
<ellipse fill="#ccffcc" stroke="black" cx="207.69" cy="-399" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="207.69" y="-394.2" font-family="Arial" font-size="16.00">h₀</text>
</g>
<!-- x1&#45;&gt;h1 -->
<g id="edge16" class="edge">
<title>x1-&gt;h1</title>
<path fill="none" stroke="#a7dbff" d="M67.68,-428.06C95.38,-422.26 141.49,-412.63 172.95,-406.05"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="173.93,-409.42 183,-403.95 172.5,-402.57 173.93,-409.42"></polygon>
</g>
<!-- h2 -->
<g id="node9" class="node">
<title>h2</title>
<ellipse fill="#ccffcc" stroke="black" cx="207.69" cy="-331" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="207.69" y="-326.2" font-family="Arial" font-size="16.00">h₁</text>
</g>
<!-- x1&#45;&gt;h2 -->
<g id="edge17" class="edge">
<title>x1-&gt;h2</title>
<path fill="none" stroke="#a7dbff" d="M64.63,-420.08C93.15,-402.2 144.82,-369.79 177.36,-349.39"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="179.38,-352.25 186,-343.97 175.66,-346.32 179.38,-352.25"></polygon>
</g>
<!-- h3 -->
<g id="node10" class="node">
<title>h3</title>
<ellipse fill="#ccffcc" stroke="black" cx="207.69" cy="-263" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="207.69" y="-258.2" font-family="Arial" font-size="16.00">h₂</text>
</g>
<!-- x1&#45;&gt;h3 -->
<g id="edge18" class="edge">
<title>x1-&gt;h3</title>
<path fill="none" stroke="#a7dbff" d="M61.12,-415.13C90.24,-384.69 149.52,-322.74 182.75,-288.02"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="185.43,-290.28 189.81,-280.63 180.37,-285.44 185.43,-290.28"></polygon>
</g>
<!-- h4 -->
<g id="node11" class="node">
<title>h4</title>
<ellipse fill="#ccffcc" stroke="black" cx="207.69" cy="-195" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="207.69" y="-190.2" font-family="Arial" font-size="16.00">...</text>
</g>
<!-- x1&#45;&gt;h4 -->
<g id="edge19" class="edge">
<title>x1-&gt;h4</title>
<path fill="none" stroke="#a7dbff" d="M57.89,-412.71C86.82,-370.38 153.68,-272.55 187.03,-223.76"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="190.1,-225.47 192.85,-215.24 184.32,-221.52 190.1,-225.47"></polygon>
</g>
<!-- h5 -->
<g id="node12" class="node">
<title>h5</title>
<ellipse fill="#ccffcc" stroke="black" cx="207.69" cy="-127" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="207.69" y="-122.2" font-family="Arial" font-size="16.00">hₖ</text>
</g>
<!-- x1&#45;&gt;h5 -->
<g id="edge20" class="edge">
<title>x1-&gt;h5</title>
<path fill="none" stroke="#a7dbff" d="M55.72,-410.99C84.27,-357.29 157.56,-219.42 190.37,-157.69"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="193.49,-159.28 195.09,-148.81 187.31,-155.99 193.49,-159.28"></polygon>
</g>
<!-- x3 -->
<g id="node3" class="node">
<title>x3</title>
<ellipse fill="#5c90e0" stroke="black" cx="43.02" cy="-297" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="43.02" y="-292.2" font-family="Arial" font-size="16.00">x₂</text>
</g>
<!-- x2&#45;&gt;x3 -->
<!-- x2&#45;&gt;h1 -->
<g id="edge21" class="edge">
<title>x2-&gt;h1</title>
<path fill="none" stroke="#a7dbff" d="M67.68,-369.94C95.38,-375.74 141.49,-385.37 172.95,-391.95"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="172.5,-395.43 183,-394.05 173.93,-388.58 172.5,-395.43"></polygon>
</g>
<!-- x2&#45;&gt;h2 -->
<g id="edge22" class="edge">
<title>x2-&gt;h2</title>
<path fill="none" stroke="#a7dbff" d="M67.68,-360.06C95.38,-354.26 141.49,-344.63 172.95,-338.05"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="173.93,-341.42 183,-335.95 172.5,-334.57 173.93,-341.42"></polygon>
</g>
<!-- x2&#45;&gt;h3 -->
<g id="edge23" class="edge">
<title>x2-&gt;h3</title>
<path fill="none" stroke="#a7dbff" d="M64.63,-352.08C93.15,-334.2 144.82,-301.79 177.36,-281.39"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="179.38,-284.25 186,-275.97 175.66,-278.32 179.38,-284.25"></polygon>
</g>
<!-- x2&#45;&gt;h4 -->
<g id="edge24" class="edge">
<title>x2-&gt;h4</title>
<path fill="none" stroke="#a7dbff" d="M61.12,-347.13C90.24,-316.69 149.52,-254.74 182.75,-220.02"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="185.43,-222.28 189.81,-212.63 180.37,-217.44 185.43,-222.28"></polygon>
</g>
<!-- x2&#45;&gt;h5 -->
<g id="edge25" class="edge">
<title>x2-&gt;h5</title>
<path fill="none" stroke="#a7dbff" d="M57.89,-344.71C86.82,-302.38 153.68,-204.55 187.03,-155.76"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="190.1,-157.47 192.85,-147.24 184.32,-153.52 190.1,-157.47"></polygon>
</g>
<!-- x4 -->
<g id="node4" class="node">
<title>x4</title>
<ellipse fill="#5c90e0" stroke="black" cx="43.02" cy="-229" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="43.02" y="-224.2" font-family="Arial" font-size="16.00">x₃</text>
</g>
<!-- x3&#45;&gt;x4 -->
<!-- x3&#45;&gt;h1 -->
<g id="edge26" class="edge">
<title>x3-&gt;h1</title>
<path fill="none" stroke="#a7dbff" d="M64.63,-309.92C93.15,-327.8 144.82,-360.21 177.36,-380.61"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="175.66,-383.68 186,-386.03 179.38,-377.75 175.66,-383.68"></polygon>
</g>
<!-- x3&#45;&gt;h2 -->
<g id="edge27" class="edge">
<title>x3-&gt;h2</title>
<path fill="none" stroke="#a7dbff" d="M67.68,-301.94C95.38,-307.74 141.49,-317.37 172.95,-323.95"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="172.5,-327.43 183,-326.05 173.93,-320.58 172.5,-327.43"></polygon>
</g>
<!-- x3&#45;&gt;h3 -->
<g id="edge28" class="edge">
<title>x3-&gt;h3</title>
<path fill="none" stroke="#a7dbff" d="M67.68,-292.06C95.38,-286.26 141.49,-276.63 172.95,-270.05"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="173.93,-273.42 183,-267.95 172.5,-266.57 173.93,-273.42"></polygon>
</g>
<!-- x3&#45;&gt;h4 -->
<g id="edge29" class="edge">
<title>x3-&gt;h4</title>
<path fill="none" stroke="#a7dbff" d="M64.63,-284.08C93.15,-266.2 144.82,-233.79 177.36,-213.39"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="179.38,-216.25 186,-207.97 175.66,-210.32 179.38,-216.25"></polygon>
</g>
<!-- x3&#45;&gt;h5 -->
<g id="edge30" class="edge">
<title>x3-&gt;h5</title>
<path fill="none" stroke="#a7dbff" d="M61.12,-279.13C90.24,-248.69 149.52,-186.74 182.75,-152.02"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="185.43,-154.28 189.81,-144.63 180.37,-149.44 185.43,-154.28"></polygon>
</g>
<!-- x5 -->
<g id="node5" class="node">
<title>x5</title>
<ellipse fill="#5c90e0" stroke="black" cx="43.02" cy="-161" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="43.02" y="-156.2" font-family="Arial" font-size="16.00">...</text>
</g>
<!-- x4&#45;&gt;x5 -->
<!-- x4&#45;&gt;h1 -->
<g id="edge31" class="edge">
<title>x4-&gt;h1</title>
<path fill="none" stroke="#a7dbff" d="M61.12,-246.87C90.24,-277.31 149.52,-339.26 182.75,-373.98"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="180.37,-376.56 189.81,-381.37 185.43,-371.72 180.37,-376.56"></polygon>
</g>
<!-- x4&#45;&gt;h2 -->
<g id="edge32" class="edge">
<title>x4-&gt;h2</title>
<path fill="none" stroke="#a7dbff" d="M64.63,-241.92C93.15,-259.8 144.82,-292.21 177.36,-312.61"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="175.66,-315.68 186,-318.03 179.38,-309.75 175.66,-315.68"></polygon>
</g>
<!-- x4&#45;&gt;h3 -->
<g id="edge33" class="edge">
<title>x4-&gt;h3</title>
<path fill="none" stroke="#a7dbff" d="M67.68,-233.94C95.38,-239.74 141.49,-249.37 172.95,-255.95"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="172.5,-259.43 183,-258.05 173.93,-252.58 172.5,-259.43"></polygon>
</g>
<!-- x4&#45;&gt;h4 -->
<g id="edge34" class="edge">
<title>x4-&gt;h4</title>
<path fill="none" stroke="#a7dbff" d="M67.68,-224.06C95.38,-218.26 141.49,-208.63 172.95,-202.05"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="173.93,-205.42 183,-199.95 172.5,-198.57 173.93,-205.42"></polygon>
</g>
<!-- x4&#45;&gt;h5 -->
<g id="edge35" class="edge">
<title>x4-&gt;h5</title>
<path fill="none" stroke="#a7dbff" d="M64.63,-216.08C93.15,-198.2 144.82,-165.79 177.36,-145.39"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="179.38,-148.25 186,-139.97 175.66,-142.32 179.38,-148.25"></polygon>
</g>
<!-- x6 -->
<g id="node6" class="node">
<title>x6</title>
<ellipse fill="#5c90e0" stroke="black" cx="43.02" cy="-93" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="43.02" y="-88.2" font-family="Arial" font-size="16.00">xₙ</text>
</g>
<!-- x5&#45;&gt;x6 -->
<!-- x5&#45;&gt;h1 -->
<g id="edge36" class="edge">
<title>x5-&gt;h1</title>
<path fill="none" stroke="#a7dbff" d="M57.89,-181.29C86.82,-223.62 153.68,-321.45 187.03,-370.24"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="184.32,-372.48 192.85,-378.76 190.1,-368.53 184.32,-372.48"></polygon>
</g>
<!-- x5&#45;&gt;h2 -->
<g id="edge37" class="edge">
<title>x5-&gt;h2</title>
<path fill="none" stroke="#a7dbff" d="M61.12,-178.87C90.24,-209.31 149.52,-271.26 182.75,-305.98"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="180.37,-308.56 189.81,-313.37 185.43,-303.72 180.37,-308.56"></polygon>
</g>
<!-- x5&#45;&gt;h3 -->
<g id="edge38" class="edge">
<title>x5-&gt;h3</title>
<path fill="none" stroke="#a7dbff" d="M64.63,-173.92C93.15,-191.8 144.82,-224.21 177.36,-244.61"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="175.66,-247.68 186,-250.03 179.38,-241.75 175.66,-247.68"></polygon>
</g>
<!-- x5&#45;&gt;h4 -->
<g id="edge39" class="edge">
<title>x5-&gt;h4</title>
<path fill="none" stroke="#a7dbff" d="M67.68,-165.94C95.38,-171.74 141.49,-181.37 172.95,-187.95"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="172.5,-191.43 183,-190.05 173.93,-184.58 172.5,-191.43"></polygon>
</g>
<!-- x5&#45;&gt;h5 -->
<g id="edge40" class="edge">
<title>x5-&gt;h5</title>
<path fill="none" stroke="#a7dbff" d="M67.68,-156.06C95.38,-150.26 141.49,-140.63 172.95,-134.05"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="173.93,-137.42 183,-131.95 172.5,-130.57 173.93,-137.42"></polygon>
</g>
<!-- x6&#45;&gt;h1 -->
<g id="edge41" class="edge">
<title>x6-&gt;h1</title>
<path fill="none" stroke="#a7dbff" d="M55.72,-115.01C84.27,-168.71 157.56,-306.58 190.37,-368.31"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="187.31,-370.01 195.09,-377.19 193.49,-366.72 187.31,-370.01"></polygon>
</g>
<!-- x6&#45;&gt;h2 -->
<g id="edge42" class="edge">
<title>x6-&gt;h2</title>
<path fill="none" stroke="#a7dbff" d="M57.89,-113.29C86.82,-155.62 153.68,-253.45 187.03,-302.24"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="184.32,-304.48 192.85,-310.76 190.1,-300.53 184.32,-304.48"></polygon>
</g>
<!-- x6&#45;&gt;h3 -->
<g id="edge43" class="edge">
<title>x6-&gt;h3</title>
<path fill="none" stroke="#a7dbff" d="M61.12,-110.87C90.24,-141.31 149.52,-203.26 182.75,-237.98"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="180.37,-240.56 189.81,-245.37 185.43,-235.72 180.37,-240.56"></polygon>
</g>
<!-- x6&#45;&gt;h4 -->
<g id="edge44" class="edge">
<title>x6-&gt;h4</title>
<path fill="none" stroke="#a7dbff" d="M64.63,-105.92C93.15,-123.8 144.82,-156.21 177.36,-176.61"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="175.66,-179.68 186,-182.03 179.38,-173.75 175.66,-179.68"></polygon>
</g>
<!-- x6&#45;&gt;h5 -->
<g id="edge45" class="edge">
<title>x6-&gt;h5</title>
<path fill="none" stroke="#a7dbff" d="M67.68,-97.94C95.38,-103.74 141.49,-113.37 172.95,-119.95"></path>
<polygon fill="#a7dbff" stroke="#a7dbff" points="172.5,-123.43 183,-122.05 173.93,-116.58 172.5,-123.43"></polygon>
</g>
<!-- input_label -->
<g id="node17" class="node">
<title>input_label</title>
<polygon fill="lightgrey" stroke="transparent" points="86.07,-50 -0.02,-50 -0.02,0 86.07,0 86.07,-50"></polygon>
<text text-anchor="middle" x="43.02" y="-20.8" font-family="Arial" font-size="14.00">Input Layer</text>
</g>
<!-- x6&#45;&gt;input_label -->
<!-- bias -->
<g id="node7" class="node">
<title>bias</title>
<polygon fill="#ccffcc" stroke="transparent" points="43.52,-477.5 42.52,-477.5 42.52,-476.5 43.52,-476.5 43.52,-477.5"></polygon>
</g>
<!-- h1&#45;&gt;h2 -->
<!-- y1 -->
<g id="node13" class="node">
<title>y1</title>
<ellipse fill="#fff8c7" stroke="black" cx="377.79" cy="-365" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="377.79" y="-360.2" font-family="Arial" font-size="16.00">y₀</text>
</g>
<!-- h1&#45;&gt;y1 -->
<g id="edge46" class="edge">
<title>h1-&gt;y1</title>
<path fill="none" stroke="#b8e6b8" d="M232.41,-394.2C261.32,-388.35 310.36,-378.44 343.15,-371.8"></path>
<polygon fill="#b8e6b8" stroke="#b8e6b8" points="344.08,-375.19 353.18,-369.77 342.69,-368.33 344.08,-375.19"></polygon>
</g>
<!-- y2 -->
<g id="node14" class="node">
<title>y2</title>
<ellipse fill="#fff8c7" stroke="black" cx="377.79" cy="-297" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="377.79" y="-292.2" font-family="Arial" font-size="16.00">y₁</text>
</g>
<!-- h1&#45;&gt;y2 -->
<g id="edge47" class="edge">
<title>h1-&gt;y2</title>
<path fill="none" stroke="#b8e6b8" d="M229.64,-386.29C259.24,-368.32 313.46,-335.43 347.18,-314.97"></path>
<polygon fill="#b8e6b8" stroke="#b8e6b8" points="349.37,-317.73 356.11,-309.55 345.74,-311.75 349.37,-317.73"></polygon>
</g>
<!-- y3 -->
<g id="node15" class="node">
<title>y3</title>
<ellipse fill="#fff8c7" stroke="black" cx="377.79" cy="-229" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="377.79" y="-224.2" font-family="Arial" font-size="16.00">...</text>
</g>
<!-- h1&#45;&gt;y3 -->
<g id="edge48" class="edge">
<title>h1-&gt;y3</title>
<path fill="none" stroke="#b8e6b8" d="M226.04,-381.45C256.07,-351.08 317.79,-288.67 352.21,-253.86"></path>
<polygon fill="#b8e6b8" stroke="#b8e6b8" points="354.99,-256.03 359.53,-246.46 350.01,-251.11 354.99,-256.03"></polygon>
</g>
<!-- y4 -->
<g id="node16" class="node">
<title>y4</title>
<ellipse fill="#fff8c7" stroke="black" cx="377.79" cy="-161" rx="25" ry="25"></ellipse>
<text text-anchor="middle" x="377.79" y="-156.2" font-family="Arial" font-size="16.00">yₘ</text>
</g>
<!-- h1&#45;&gt;y4 -->
<g id="edge49" class="edge">
<title>h1-&gt;y4</title>
<path fill="none" stroke="#b8e6b8" d="M223.02,-378.71C252.98,-336.29 322.3,-238.14 356.69,-189.45"></path>
<polygon fill="#b8e6b8" stroke="#b8e6b8" points="359.59,-191.43 362.5,-181.24 353.87,-187.39 359.59,-191.43"></polygon>
</g>
<!-- h2&#45;&gt;h3 -->
<!-- h2&#45;&gt;y1 -->
<g id="edge50" class="edge">
<title>h2-&gt;y1</title>
<path fill="none" stroke="#b8e6b8" d="M232.41,-335.8C261.32,-341.65 310.36,-351.56 343.15,-358.2"></path>
<polygon fill="#b8e6b8" stroke="#b8e6b8" points="342.69,-361.67 353.18,-360.23 344.08,-354.81 342.69,-361.67"></polygon>
</g>
<!-- h2&#45;&gt;y2 -->
<g id="edge51" class="edge">
<title>h2-&gt;y2</title>
<path fill="none" stroke="#b8e6b8" d="M232.41,-326.2C261.32,-320.35 310.36,-310.44 343.15,-303.8"></path>
<polygon fill="#b8e6b8" stroke="#b8e6b8" points="344.08,-307.19 353.18,-301.77 342.69,-300.33 344.08,-307.19"></polygon>
</g>
<!-- h2&#45;&gt;y3 -->
<g id="edge52" class="edge">
<title>h2-&gt;y3</title>
<path fill="none" stroke="#b8e6b8" d="M229.64,-318.29C259.24,-300.32 313.46,-267.43 347.18,-246.97"></path>
<polygon fill="#b8e6b8" stroke="#b8e6b8" points="349.37,-249.73 356.11,-241.55 345.74,-243.75 349.37,-249.73"></polygon>
</g>
<!-- h2&#45;&gt;y4 -->
<g id="edge53" class="edge">
<title>h2-&gt;y4</title>
<path fill="none" stroke="#b8e6b8" d="M226.04,-313.45C256.07,-283.08 317.79,-220.67 352.21,-185.86"></path>
<polygon fill="#b8e6b8" stroke="#b8e6b8" points="354.99,-188.03 359.53,-178.46 350.01,-183.11 354.99,-188.03"></polygon>
</g>
<!-- h3&#45;&gt;h4 -->
<!-- h3&#45;&gt;y1 -->
<g id="edge54" class="edge">
<title>h3-&gt;y1</title>
<path fill="none" stroke="#b8e6b8" d="M229.64,-275.71C259.24,-293.68 313.46,-326.57 347.18,-347.03"></path>
<polygon fill="#b8e6b8" stroke="#b8e6b8" points="345.74,-350.25 356.11,-352.45 349.37,-344.27 345.74,-350.25"></polygon>
</g>
<!-- h3&#45;&gt;y2 -->
<g id="edge55" class="edge">
<title>h3-&gt;y2</title>
<path fill="none" stroke="#b8e6b8" d="M232.41,-267.8C261.32,-273.65 310.36,-283.56 343.15,-290.2"></path>
<polygon fill="#b8e6b8" stroke="#b8e6b8" points="342.69,-293.67 353.18,-292.23 344.08,-286.81 342.69,-293.67"></polygon>
</g>
<!-- h3&#45;&gt;y3 -->
<g id="edge56" class="edge">
<title>h3-&gt;y3</title>
<path fill="none" stroke="#b8e6b8" d="M232.41,-258.2C261.32,-252.35 310.36,-242.44 343.15,-235.8"></path>
<polygon fill="#b8e6b8" stroke="#b8e6b8" points="344.08,-239.19 353.18,-233.77 342.69,-232.33 344.08,-239.19"></polygon>
</g>
<!-- h3&#45;&gt;y4 -->
<g id="edge57" class="edge">
<title>h3-&gt;y4</title>
<path fill="none" stroke="#b8e6b8" d="M229.64,-250.29C259.24,-232.32 313.46,-199.43 347.18,-178.97"></path>
<polygon fill="#b8e6b8" stroke="#b8e6b8" points="349.37,-181.73 356.11,-173.55 345.74,-175.75 349.37,-181.73"></polygon>
</g>
<!-- h4&#45;&gt;h5 -->
<!-- h4&#45;&gt;y1 -->
<g id="edge58" class="edge">
<title>h4-&gt;y1</title>
<path fill="none" stroke="#b8e6b8" d="M226.04,-212.55C256.07,-242.92 317.79,-305.33 352.21,-340.14"></path>
<polygon fill="#b8e6b8" stroke="#b8e6b8" points="350.01,-342.89 359.53,-347.54 354.99,-337.97 350.01,-342.89"></polygon>
</g>
<!-- h4&#45;&gt;y2 -->
<g id="edge59" class="edge">
<title>h4-&gt;y2</title>
<path fill="none" stroke="#b8e6b8" d="M229.64,-207.71C259.24,-225.68 313.46,-258.57 347.18,-279.03"></path>
<polygon fill="#b8e6b8" stroke="#b8e6b8" points="345.74,-282.25 356.11,-284.45 349.37,-276.27 345.74,-282.25"></polygon>
</g>
<!-- h4&#45;&gt;y3 -->
<g id="edge60" class="edge">
<title>h4-&gt;y3</title>
<path fill="none" stroke="#b8e6b8" d="M232.41,-199.8C261.32,-205.65 310.36,-215.56 343.15,-222.2"></path>
<polygon fill="#b8e6b8" stroke="#b8e6b8" points="342.69,-225.67 353.18,-224.23 344.08,-218.81 342.69,-225.67"></polygon>
</g>
<!-- h4&#45;&gt;y4 -->
<g id="edge61" class="edge">
<title>h4-&gt;y4</title>
<path fill="none" stroke="#b8e6b8" d="M232.41,-190.2C261.32,-184.35 310.36,-174.44 343.15,-167.8"></path>
<polygon fill="#b8e6b8" stroke="#b8e6b8" points="344.08,-171.19 353.18,-165.77 342.69,-164.33 344.08,-171.19"></polygon>
</g>
<!-- h5&#45;&gt;y1 -->
<g id="edge62" class="edge">
<title>h5-&gt;y1</title>
<path fill="none" stroke="#b8e6b8" d="M223.02,-147.29C252.98,-189.71 322.3,-287.86 356.69,-336.55"></path>
<polygon fill="#b8e6b8" stroke="#b8e6b8" points="353.87,-338.61 362.5,-344.76 359.59,-334.57 353.87,-338.61"></polygon>
</g>
<!-- h5&#45;&gt;y2 -->
<g id="edge63" class="edge">
<title>h5-&gt;y2</title>
<path fill="none" stroke="#b8e6b8" d="M226.04,-144.55C256.07,-174.92 317.79,-237.33 352.21,-272.14"></path>
<polygon fill="#b8e6b8" stroke="#b8e6b8" points="350.01,-274.89 359.53,-279.54 354.99,-269.97 350.01,-274.89"></polygon>
</g>
<!-- h5&#45;&gt;y3 -->
<g id="edge64" class="edge">
<title>h5-&gt;y3</title>
<path fill="none" stroke="#b8e6b8" d="M229.64,-139.71C259.24,-157.68 313.46,-190.57 347.18,-211.03"></path>
<polygon fill="#b8e6b8" stroke="#b8e6b8" points="345.74,-214.25 356.11,-216.45 349.37,-208.27 345.74,-214.25"></polygon>
</g>
<!-- h5&#45;&gt;y4 -->
<g id="edge65" class="edge">
<title>h5-&gt;y4</title>
<path fill="none" stroke="#b8e6b8" d="M232.41,-131.8C261.32,-137.65 310.36,-147.56 343.15,-154.2"></path>
<polygon fill="#b8e6b8" stroke="#b8e6b8" points="342.69,-157.67 353.18,-156.23 344.08,-150.81 342.69,-157.67"></polygon>
</g>
<!-- hidden_label -->
<g id="node18" class="node">
<title>hidden_label</title>
<polygon fill="lightgrey" stroke="transparent" points="257.46,-84 157.91,-84 157.91,-34 257.46,-34 257.46,-84"></polygon>
<text text-anchor="middle" x="207.69" y="-54.8" font-family="Arial" font-size="14.00">Hidden Layer</text>
</g>
<!-- h5&#45;&gt;hidden_label -->
<!-- y1&#45;&gt;y2 -->
<!-- y2&#45;&gt;y3 -->
<!-- y3&#45;&gt;y4 -->
<!-- output_label -->
<g id="node19" class="node">
<title>output_label</title>
<polygon fill="lightgrey" stroke="transparent" points="426.23,-118 329.35,-118 329.35,-68 426.23,-68 426.23,-118"></polygon>
<text text-anchor="middle" x="377.79" y="-88.8" font-family="Arial" font-size="14.00">Output Layer</text>
</g>
<!-- y4&#45;&gt;output_label -->
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div><div class="column">
<p><br> <br></p>
<div class="fragment fade-in">
<p><span class="math display">\[
\color{rgb(255, 176, 0)}{y} = \color{rgb(143, 204, 143)}{W_1} \color{rgb(92, 144, 224)}{ReLU({W_0}x)}
\]</span></p>
</div>
</div></div>
<aside class="notes">
<p>We will do this for as many layers we have in the network. This will result in a nested function. For example for a two layer network it would be something like in the slide.</p>
<p>Two things to note here: - first, when counting the number of layers in the neural network, we usually omit the input layer since it does not have tunable weights - Second, Note that usually the non linear function is not applied at the last output layer (also called readout layer because it’s where we read the predictions for the classes).</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="forward-pass-1" class="slide level2">
<h2>Forward pass</h2>
<div class="columns">
<div class="column" style="width: 20%; margin-top: 18%; margin-left: 0%">
<div class="fragment fade-in" data-fragment-index="1">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/vanilla-nn/input-2.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div><div class="column" style="width: 20%; margin-top: 20%">
<div class="fragment fade-in" data-fragment-index="1">
<div style="text-align: left; ">
<p><span style="font-size: 100px; color: rgb(102, 178, 102);"> → </span></p>
</div>
</div>
</div><div class="column" style="width: 45%; text-align: centre; margin-left: -7%; margin-top: 5%">
<p><img data-src="img/vanilla-nn/mlp-3b1b-diagram.png" style="width:75.0%"></p>
<div class="r-stack">
<div class="fragment fade-in" data-fragment-index="2">
<div class="fragment fade-out" data-fragment-index="4">
<div style="text-align: left; margin-left: -30%; margin-top: -30%">
<p><span class="math display">\[
\scriptstyle
ReLU(W h^n) = h^{n+1}
\]</span></p>
</div>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="4">
<div style="text-align: left; margin-left: -30%; margin-top: -30%">
<p><span class="math display">\[
\scriptstyle
ReLU(\color{rgb(255,0,0)}{W} h^n) = h^{n+1}
\]</span></p>
</div>
</div>
</div>
</div><div class="column" style="width: 30%; margin-top: 20%; margin-left: -20%">
<div class="fragment fade-in" data-fragment-index="3">
<div style="text-align: right; margin-left: -10%; ">
<p><span style="font-size: 100px; color: rgb(102, 178, 102);"> → 2</span></p>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="5">
<div style="text-align: left; margin-left: 40%; margin-top: 30%">
<p><span style="font-size: 40px; color: rgb(255, 0, 0);"> How to choose them? </span></p>
</div>
</div>
</div></div>
<aside class="notes">
<p>Ok so we’ve now seen how we go from a certain input (in our case a greyscale image with a digit), across all layers applying the corresponding transformations, until the output layer, where we will obtain ‘scores’ representing how much the model thinks the input represents each class. This whole process is usually called forward pass, since the information flows from input to output</p>
<p>We’ve also seen that each layer has a collection of weights and biases that along with the activation function, define the transformation taking place across that layer. The weights and biases of all the layers constitute the network parameters, and they determine what the network “does”.</p>
<p>With an ideal set of parameters, we would feed a certain image, for example one representing a 3, and the transformations across the layers should end up in the class “3” having the highest score in the output layer.</p>
<p>How do we choose these parameters? We would like to obtain the weights and biases that perform best in the task of recognising digits.</p>
<p>We can formulate this as an optimisation problem: we want to obtain the weights and biases that minimise the error when recognising digits.</p>
<p>This is what we basically do when we train the network, which is the next part of the session.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="additional-references-2" class="slide level2">
<h2>Additional references</h2>
<div style="font-size: 0.6em;">
<ul>
<li>On neural networks being universal function approximators
<ul>
<li>Deep learning book section 6.4 <a href="http://www.deeplearningbook.org/contents/mlp.html">http://www.deeplearningbook.org/contents/mlp.html</a></li>
<li>CS231n notes <a href="https://cs231n.github.io/neural-networks-1/#power">https://cs231n.github.io/neural-networks-1/#power</a></li>
<li>Michael Nielsen’s book <a href="http://neuralnetworksanddeeplearning.com/chap4.html">http://neuralnetworksanddeeplearning.com/chap4.html</a></li>
</ul></li>
</ul>
</div>
<!-- ########################################### -->
</section></section>
<section>
<section id="training-and-backward-pass" class="title-slide slide level1 center">
<h1>Training and backward pass</h1>

</section>
<section class="slide level2">


<aside><div>
<p>This section is based on the lecture notes from cs231n available at <a href="https://cs231n.github.io/">cs231n.github.io</a> and the <a href="https://youtu.be/aircAruvnKk?si=HdE55UbKbjsPP-A-">neural networks video series by <em>3Blue1Brown</em></a></p>
</div></aside></section>
<section id="training-intuition" class="slide level2">
<h2>Training: intuition</h2>
<div class="columns">
<div class="column" style="width: 20%; margin-top: 18%; margin-left: 0%; font-size: 40px;">
<div class="r-stack">
<div class="fragment fade-in" data-fragment-index="2">
<div class="fragment fade-out" data-fragment-index="5">
<p>( <img data-src="img/vanilla-nn/input-2.png" style="width:30.0%"> , <span style="color: rgb(213, 6, 6);">2</span>)</p>
<p><span style="color: rgb(213, 6, 6);">Labelled data</span></p>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="3">
<div class="fragment fade-out" data-fragment-index="4">
<p><span style="color: rgb(1, 1, 1); position: absolute; top: 90%; left: 0%;"> Supervised learning </span></p>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="5">
<p>( <img data-src="img/training/train-set.png" style="width:30.0%"> , <span style="color: rgb(213, 6, 6);">…</span>)</p>
<p><span style="color: rgb(213, 6, 6);">Training set</span></p>
</div>
</div>
</div><div class="column" style="width: 20%; margin-top: 20%">
<div class="fragment fade-in" data-fragment-index="2">
<div style="text-align: left; ">
<p><span style="font-size: 100px; color: rgb(102, 178, 102);"> → </span></p>
</div>
</div>
</div><div class="column" style="width: 45%; text-align: centre; margin-left: -7%; margin-top: 5%">
<p><img data-src="img/vanilla-nn/mlp-3b1b-diagram.png" style="width:75.0%"></p>
</div><div class="column" style="width: 30%; margin-top: 20%; margin-left: -17%">
<div class="r-stack">
<div class="fragment fade-in" data-fragment-index="4">
<div class="fragment fade-out" data-fragment-index="5">
<div>
<p><span style="font-size: 100px; color: rgb(102, 178, 102);"> → </span> <span style="color: rgba(6, 78, 213, 0.81);"> 7?</span></p>
</div>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="5">
<div>
<p><span style="font-size: 100px; color: rgb(102, 178, 102);"> → </span> <span style="color: rgba(6, 78, 213, 0.81);"> …</span></p>
</div>
</div>
</div>
</div></div>
<aside class="notes">
<p>The main idea of training: During training we will feed labelled data to the network. It is called ‘labelled data’ because for each image we have a label (in red) that contains the ground truth. This is basically the answer to the problem we want to solve (here, the digit it represents). - Remember that with the neural network we want to capture that mapping from inputs to labels, from images to digits. - We are focusing on <strong>supervised learning</strong>, in which labelled data is available, but be aware that there are other approaches to learning too.</p>
<p>For each training sample, the network will just execute a normal forward pass, ignoring the label. After going through all the layers, the network will output a prediction for the given input. Then we will compare it to the <strong>ground truth label</strong>.</p>
<p>Depending on how far off the prediction is, the network will adapt its weights and biases so that it improves its performance, and its predictions become closer and closer to the ground truth.</p>
<p>The complete set of images that we present during training constitutes the <strong>training set</strong>. The hope is that with this layered approach of the network and its hierarchical abstraction of concepts, we may be able to train a network that generalises beyond the training set.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ------------------------------------------------------------ -->
</section>
<section id="testing-intuition" class="slide level2">
<h2>Testing: intuition</h2>
<div class="columns">
<div class="column" style="width: 20%; margin-top: 18%; margin-left: 0%; font-size: 40px; text-align: center;">
<div class="fragment fade-in" data-fragment-index="1">
<p><img data-src="img/training/test-set.png" style="width:60.0%"></p>
<p><span style="color: rgb(1, 1, 1);">Test set</span></p>
</div>
</div><div class="column" style="width: 20%; margin-top: 20%">
<div class="fragment fade-in" data-fragment-index="1">
<div style="text-align: left; ">
<p><span style="font-size: 100px; color: rgb(102, 178, 102);"> → </span></p>
</div>
</div>
</div><div class="column" style="width: 45%; text-align: centre; margin-left: -7%; margin-top: 5%">
<p><img data-src="img/vanilla-nn/mlp-3b1b-diagram.png" style="width:75.0%"></p>
<div class="fragment fade-in" data-fragment-index="0">
<p><span style="font-size: 100px; color: rgb(210, 7, 7); position: absolute; top: 45%; left: 29%; transform: rotate(-30deg);"> TRAINED </span></p>
</div>
</div><div class="column" style="width: 10%; margin-top: 20%; margin-left: -10%; text-align: center;">
<div class="fragment fade-in" data-fragment-index="3">
<div style="display: flex; align-items: center; justify-content: center;">
<p><span style="font-size: 100px; color: rgb(102, 178, 102);"> → </span></p>
</div>
</div>
</div><div class="column" style="width: 30%; margin-top: 20%; margin-left: -8%; text-align: center;">
<div class="fragment fade-in" data-fragment-index="3">
<p><img data-src="img/training/accuracy.png" style="width:40.0%"></p>
<p><span style="color: rgb(1, 1, 1);">Accuracy</span></p>
</div>
</div></div>
<aside class="notes">
<p>We test this by doing the following: after we train the network, we present it with a new set of images that the network hasn’t seen during training. We call this the test set. On this test set we check the performance of the network. In our case, the accuracy of the classification (number of correct predictions over total).</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ------------------------------------------------------------ -->
</section>
<section id="dataset-split" class="slide level2">
<h2>Dataset split</h2>
<p><br></p>
<div class="columns">
<div class="column" style="width: 50%;">
<ul>
<li class="fragment">Hyperparameters</li>
<li class="fragment">Keep test set aside! ⚠️</li>
</ul>
</div><div class="column" style="width: 50%;">
<div class="r-stack">
<div class="fragment fade-in" data-fragment-index="1">
<p><img data-src="img/training/train-test-split.png" style="width:100.0%"></p>
</div>
<div class="fragment fade-in" data-fragment-index="2">
<p><img data-src="img/training/train-test-split-heart.png" style="width:100.0%"></p>
</div>
</div>
</div></div>
<div style="position: absolute; bottom: 0px; right: 0px; font-size: 0.3em; color: var(--link-color);">
Figures modified from <a href="https://cs231n.github.io/classification/#validation-sets-for-hyperparameter-tuning" target="_blank"> CS231n lecture notes: neural networks</a>
</div>
<aside class="notes">
<p>Before we dive into the details of training, le’t make an important note about the test set.</p>
<p>We have seen how in the paradigm I just described, there are two subsets within the full set of labelled data: the training set and the test set. The test set is indeed a very valuable resource to assess how our model performs in deployment / in the wild. As such, it should be treated with care.</p>
<p>But what does this mean in practice? To explain this better, we need to talk first about <strong>hyperparameters</strong>, a common feature of ML algorithms.</p>
<p>You may have noticed that in the development of our simple MLP we made a few design choices, such as the number of neurons per layer, the number of hidden layers, the activation function etc. These are called <strong>hyperparameters</strong> - basically all the parameters in the network that are not weights and biases (i.e.&nbsp;not learnt, not tuned during training) can be considered hyperparameters. We will see more examples of hyperparameters in the next slides too.</p>
<p>How do hyperparameters relate to the test set? Well it’s often not obvious what values/settings one should choose, and a reasonable suggestion would be to try a few different values and see which one works best. This is indeed what we do in practice, but we need to be careful. In particular, we <strong>cannot use the test set for the purpose of tweaking hyperparameters</strong>.</p>
<p>Why? As we said the test set as a very precious resource, as we can use it as a proxy for measuring the generalization of your model. If we tune our hyperparameters to work well on the test set, we will overfit to it, and when we deploy our model we could see a significantly reduced performance. We will loose our only metric of realistic performance in the wild.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ------------------------------------------------------------ -->
</section>
<section id="dataset-split-1" class="slide level2">
<h2>Dataset split</h2>
<p><br></p>
<div class="columns">
<div class="column" style="width: 50%;">
<ul>
<li>Hyperparameters</li>
<li>Keep test set aside! ⚠️</li>
<li>So then how?</li>
</ul>
</div><div class="column" style="width: 50%;">
<p><img data-src="img/training/train-test-split.png" style="width:100.0%"></p>
<div class="r-stack">
<div class="fragment fade-in" data-fragment-index="1">
<div class="fragment fade-out" data-fragment-index="2">
<p><img data-src="img/training/train-val-test-split-arrow.png" style="width:100.0%"></p>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="2">
<p><img data-src="img/training/train-val-test-split-arrow-heart.png" style="width:100.0%"></p>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="3">
<p><img data-src="img/training/k-fold.png" style="width:100.0%"></p>
</div>
</div></div>
<div style="position: absolute; bottom: 0px; right: 0px; font-size: 0.3em; color: var(--link-color);">
Figures modified from <a href="https://cs231n.github.io/classification/#validation-sets-for-hyperparameter-tuning" target="_blank"> CS231n lecture notes: neural networks</a>
</div>
<aside class="notes">
<p>So how do we go about this? Usually people split the data into three sets: training, validation and test. - The training set is used to train the model. - The validation set is used to select the best hyperparameters. - The test set is only used once, at the end, to evaluate the performance of the model with the selected hyperparameters. This way it remains a good proxy for measuring the generalization of our model.</p>
<p>In cases where the size of your training data (and therefore also the validation data) might be small, it is common practice to do what is called <strong>k-fold validation</strong>.</p>
<p>In k-fold validation: The training set is split into folds (for example 5 folds). The folds 1-4 become the training set. One fold (e.g.&nbsp;fold 5 here in yellow) is denoted as the Validation fold and is used to tune the hyperparameters. Cross-validation goes a step further and iterates over the choice of which fold is the validation fold, separately from 1-5. This would be referred to as 5-fold cross-validation. In the very end once the model is trained and all the best hyperparameters are determined, the model is evaluated a single time on the test data (red).</p>
<p><strong>In animal pose estimation</strong>, most frameworks make it very easy to do a slight variant of this. Instead of fixed folds, people often do random samples for the training and the test set (in DLC for examplethese are called “shuffles”).</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ------------------------------------------------------------ -->
</section>
<section id="training-as-an-optimisation-problem" class="slide level2">
<h2>Training as an optimisation problem</h2>
<div class="fragment fade-in" data-fragment-index="2">
<div class="fragment fade-out" data-fragment-index="3">
<p><text><span style="color: rgb(231, 133, 34); position: absolute; top: 25%; left: 45%;">Loss function</span></text></p>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="4">
<p><text><span style="color: rgb(231, 133, 34); position: absolute; top: 25%; left: 43%;">Gradient descent</span></text></p>
</div>
<div class="r-stack" style="margin-left: 20%; margin-top: 5%;">
<div class="fragment fade-out" data-fragment-index="1">
<p><img data-src="img/training/training-one-sample.png" style="border: 1px solid black;;width:80.0%"></p>
</div>
<div class="fragment fade-in" data-fragment-index="1">
<div class="fragment fade-out" data-fragment-index="3">
<p><img data-src="img/training/loss-intro.png" style="border: 1px solid black;;width:80.0%"></p>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="3">
<p><img data-src="img/training/gd-intro.png" style="border: 1px solid black;;width:80.0%"></p>
</div>
</div>
<aside class="notes">
<p>So we need to further define two aspects of this process: - first, how is the comparison between prediction and labels carried out and how does it evaluate the performance of the network? We will capture this via the loss function - Second, we need to specify a way of updating the values of the weights and biases based on how well or how badly the model is performing so that they perform better in future passes. We will approach this by optimising their values with gradient descent Let’s start off with the loss function. In this lecture we will focus on the cross-entropy loss, which is a popular choice but there are many other alternative loss functions.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ------------------------------------------------------------ -->
</section>
<section id="loss-function" class="slide level2">
<h2>Loss function</h2>
<div class="columns">
<div class="column" style="width: 15%; margin-top: 18%; margin-left: 0%">
<div class="fragment fade-in" data-fragment-index="1">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/vanilla-nn/input-2.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div><div class="column" style="width: 40%; margin-left: 5%">
<div class="fragment fade-in" data-fragment-index="2">
<p><img data-src="img/vanilla-nn/mlp-3b1b-diagram.png" style="width:100.0%"></p>
</div>
<div class="fragment fade-in" data-fragment-index="3">
<!-- ---- Class positions ---- -->
<div style="width: 40px; height: 270px; background-color: transparent; border: 4px solid rgb(103, 152, 205); position: absolute; top: 220px; right: 435px;">
<div style="position: absolute; top: -1.5%; left: 150%; transform: translateX(-50%); font-size: 26px; color: rgb(103, 152, 205);">
0
</div>
<div style="position: absolute; top: 8.5%; left: 150%; transform: translateX(-50%); font-size: 26px; color: rgb(103, 152, 205);">
1
</div>
<div style="position: absolute; top: 19%; left: 150%; transform: translateX(-50%); font-size: 26px; color: rgb(103, 152, 205);">
2
</div>
<div style="position: absolute; top: 29%; left: 150%; transform: translateX(-50%); font-size: 26px; color: rgb(103, 152, 205);">
3
</div>
<div style="position: absolute; top: 39%; left: 150%; transform: translateX(-50%); font-size: 26px; color: rgb(103, 152, 205);">
4
</div>
<div style="position: absolute; top: 49%; left: 150%; transform: translateX(-50%); font-size: 26px; color: rgb(103, 152, 205);">
5
</div>
<div style="position: absolute; top: 58%; left: 150%; transform: translateX(-50%); font-size: 26px; color: rgb(103, 152, 205);">
6
</div>
<div style="position: absolute; top: 69%; left: 150%; transform: translateX(-50%); font-size: 26px; color: rgb(103, 152, 205);">
7
</div>
<div style="position: absolute; top: 78%; left: 150%; transform: translateX(-50%); font-size: 26px; color: rgb(103, 152, 205);">
8
</div>
<div style="position: absolute; top: 88%; left: 150%; transform: translateX(-50%); font-size: 26px; color: rgb(103, 152, 205);">
9
</div>
</div>
</div>
</div><div class="column" style="width: 30%; margin-top: 8%; margin-left: -2%;">
<div class="fragment fade-in" data-fragment-index="4">
<div style="text-align: left;">
<div style="font-weight: bold; font-size: 22px; margin-bottom: 0px; margin-left: 45px;">
Raw scores
</div>
<div style="font-family: 'Courier New', monospace; font-size: 15px; font-weight: bold; line-height: 1.9; margin-top: 10px; margin-left: 40px;">
<div style="text-align: right; width: 80px;">
-6.8
</div>
<div style="text-align: right; width: 80px;">
2.6
</div>
<div style="text-align: right; width: 80px; font-weight: bold; color: rgb(103, 152, 205);">
6.7
</div>
<div style="text-align: right; width: 80px;">
5.9
</div>
<div style="text-align: right; width: 80px;">
1.9
</div>
<div style="text-align: right; width: 80px;">
-1.3
</div>
<div style="text-align: right; width: 80px;">
-5.7
</div>
<div style="text-align: right; width: 80px;">
3.2
</div>
<div style="text-align: right; width: 80px;">
1.3
</div>
<div style="text-align: right; width: 80px;">
1.0
</div>
</div>
</div>
</div>
</div><div class="column" style="width: 10%; margin-top: 20%; margin-left: -15%;">
<div class="fragment fade-in" data-fragment-index="6">
<p><img data-src="img/training/softmax.png" style="width:100.0%"></p>
</div>
</div><div class="column" style="width: 5%; margin-top: 8%; margin-left: 0%;">
<div class="fragment fade-in" data-fragment-index="5">
<div style="font-weight: bold; font-size: 22px; margin-bottom: 0px; margin-left: 0px;">
Probabilities
</div>
<div style="width: 150px; height: 310px; margin-top: -27px; margin-left: -10%;">
<p><img data-src="img/training/prob-bar-plot.png" style="border-left: 1px solid #d3d3d3;height: 310px; width: 150px;"></p>
</div>
</div>
</div></div>
<aside class="notes">
<p>The loss function describes how good a certain collection of weights and biases is. Sometimes called cost function, objective function.</p>
<p>To describe the loss function let’s look at what happens at the end of a forward pass during training. After we go through all the layers we arrive at the output layer or readout layer, where the scores for each of the classes are collected in the neurons.</p>
<p>We would like the score for the correct class, in this case “2”, to be very high, and best highest than the other classes.</p>
<p>But these numbers at the output layer are just ‘raw’ scores. They are unnormalised (we interpret them as unnormalised log probabilities). It would be very nice for interpretability if these scores could represent something like a probability distribution across the classes, reflecting the network’s prediction.</p>
<p>This is exactly what the softmax function does.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ------------------------------------------------------------ -->
</section>
<section id="loss-function-1" class="slide level2">
<h2>Loss function</h2>
<div class="columns">
<div class="column" style="width: 25%; margin-top: 8%; margin-left: -4%;">
<div style="text-align: left;">
<div style="font-weight: bold; font-size: 22px; margin-bottom: 0px; margin-left: 45px;">
Raw scores <em>z</em>
</div>
<div style="font-family: 'Courier New', monospace; font-size: 15px; font-weight: bold; line-height: 1.9; margin-top: 10px; margin-left: 40px;">
<div style="text-align: right; width: 80px;">
-6.8
</div>
<div style="text-align: right; width: 80px;">
2.6
</div>
<div style="text-align: right; width: 80px; font-weight: bold; color: rgb(103, 152, 205);">
6.7
</div>
<div style="text-align: right; width: 80px;">
5.9
</div>
<div style="text-align: right; width: 80px;">
1.9
</div>
<div style="text-align: right; width: 80px;">
-1.3
</div>
<div style="text-align: right; width: 80px;">
-5.7
</div>
<div style="text-align: right; width: 80px;">
3.2
</div>
<div style="text-align: right; width: 80px;">
1.3
</div>
<div style="text-align: right; width: 80px;">
1.0
</div>
</div>
</div>
</div><div class="column" style="width: 10%; margin-top: 20%; margin-left: -10%;">
<p><img data-src="img/training/softmax.png" style="width:100.0%"></p>
</div><div class="column" style="width: 15%; margin-top: 8%; margin-left: 2%;">
<div style="font-weight: bold; font-size: 22px; margin-bottom: 0px; margin-left: -30px;">
Probabilities <em>p̂</em>
</div>
<div style="width: 150px; height: 310px; margin-top: -27px; margin-left: -10%;">
<p><img data-src="img/training/prob-bar-plot.png" style="border-left: 1px solid #d3d3d3;height: 310px; width: 150px;"></p>
</div>
</div><div class="column" style="width: 10%; margin-top: 21%; margin-left: -4%;">
<div class="fragment fade-in" data-fragment-index="3">
<p><img data-src="img/training/cross-entropy.png" style="width:100.0%"></p>
</div>
</div><div class="column" style="width: 15%; margin-top: 8%; margin-left: 2%;">
<div class="fragment fade-in" data-fragment-index="2">
<div style="font-weight: bold; font-size: 22px; margin-bottom: 0px; margin-left: -30px;">
Ground truth <em>p</em>
</div>
<div style="width: 150px; height: 310px; margin-top: -27px; margin-left: -10%;">
<p><img data-src="img/training/gt-prob-bar-plot.png" style="border-left: 1px solid #d3d3d3;height: 310px; width: 150px;"></p>
</div>
</div>
</div><div class="column" style="width: 30%; margin-top: 0%; margin-left: 5%; text-align: left; font-size: 32px;">
<div class="fragment fade-in" data-fragment-index="1">
Softmax:
<div style="background-color: rgba(77, 214, 24, 0.3); width: 60%; height: 40%; text-align: center;margin: 0 auto; padding: 3; display: block;">
<p><span class="math display">\[
\tiny
\widehat{p} (z_{j}) = \frac{e^{z_j}}{\sum_{k} e^{z_k}}
\]</span></p>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="3">
Cross-entropy:
<div style="background-color: rgba(233, 97, 7, 0.3); width: 80%; height: 40%; text-align: center;margin: 0 auto; padding: 3; display: block;">
<p><span class="math display">\[
\tiny
\text{H}(p, q) = -\sum_{k} p_k \log(\widehat{p}_{k})
\]</span></p>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="4">
<p>Loss: <!-- <div style="border: 2px solid #333;"> --> <span class="math display">\[
\tiny
\text{L}_{i} = - \log(\widehat{p} (z_{j=y_i}) )
\]</span></p>
</div>
<div class="fragment fade-in" data-fragment-index="5">
<div style="border: 2px solid rgba(70, 73, 68, 0.27); width: 50%; height: 30%; text-align: center; margin: 0 auto; display: block;">
<p><span class="math display">\[
\tiny
\text{L} = \frac{1}{N} \sum_{i} \text{L}_{i}
\]</span></p>
</div>
</div>
</div></div>
<aside class="notes">
<p>This is exactly what the softmax function does. It is a function that takes as inputs K real numbers, and transforms them so that they fulfill the minimum requirements for a probability distribution (numbers from 0 to 1 that add up to 1). In the result, each prob is proportional to the exp of the raw score. So after the softmax each score will be now between 0 and 1 and all of them will add up to 1.</p>
<p>Now we have a probability distribution over the classes that represent the network’s predictions. However because we have the labels, we actually know the true probability distribution, or the ground truth. This distribution is “1” at the correct label class, and zero elsewhere.</p>
<p>How can we compare the set of two probability distributions?</p>
<p>We can use tools from information theory to quantify how far off these distributions are. If we call the true probability distribution <span class="math inline">\(\hat{p}(x)\)</span> and the one estimated by the network <span class="math inline">\(p(x)\)</span>, the cross entropy between them is defined as shown in the slide.</p>
<p>You can go into further detail about interpretation of cross‐entropy but for now it’s enough to know that it measures how far off the true and the estimated distributions are. This is great because we can already use this as our loss function! It indeed tells us how good or bad we are doing, which is what we were looking for.</p>
<p>Note that the cross‐entropy function <strong>spits out a scalar (i.e., a number) for the probabilities we obtain for one input image.</strong></p>
<p>With a bit of reordering of the cross-entropy expression we can define the loss per input image as shown in the slide.</p>
<p>However the full loss of the complete dataset would be the average over the losses for each of the training samples. If the training samples are too many, so much that it slows down the training process, often a small portion of samples is considered, but we’ll see that in more detail in a few slides.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ----------------- -->
</section>
<section id="optimisation-intuition" class="slide level2">
<h2>Optimisation: intuition</h2>
<div class="r-stack">
<div class="fragment fade-in" data-fragment-index="0">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/training/optim-1d-before.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
<div style="position: absolute; bottom: 30px; right: 7px; font-size: 0.3em; color: var(--link-color);">
Figure from <a href="https://youtu.be/IHZwWFHWa-w?si=Ag4HuuL_IqxIZDkq&amp;t=363" target="_blank"> Gradient descent, how neural networks learn | Deep Learning Chapter 2</a>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="1">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/training/optim-1d.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
<aside class="notes">
<p>Going back to the two aspects of training we wanted to further define: - We have talked about the loss function and how it allows us to quantify how well/ how badly our network is doing, <strong>given a certain set of weights</strong> and a bunch of input images - Now we are going to talk about the last aspect of the training process: the optimisation of the weights and biases, or how we go about adapting the parameters of the network to improve performance</p>
<p>Let’s consider a simple case of a loss function with one input (corresponding to something like a hypothetical network with single parameter). Remember that the loss function always returns a scalar value (i.e., one output). We want to find the value of the parameter that minimises the loss.</p>
<p>If we solved this with gradient descent, the process would be approximately as follows:</p>
<ul>
<li>We initialise our parameter in a random point</li>
<li>We compute the derivative of the loss function with respect to the parameter (i.e., the slope). The derivative tells us in which direction we decrease the loss.</li>
<li>We take a small step in that direction and repeat the process: at every point we compute the slope, we take a small step following the slope in the adequate direction, and then repeat.</li>
<li>If we move every time an amount proportional to the slope we will prevent overshooting the minimum, since as we approach the minimum the slope becomes flatter and flatter.</li>
</ul>
<p>Note that there is no guarantee that we will find the global minimum, that is a hard problem, but we are fine with a local minimum!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="optimisation-intuition-1" class="slide level2">
<h2>Optimisation: intuition</h2>
<div style="width: 75%; margin: 0 auto; text-align: right;">
<p><img data-src="img/training/optim-2d.png" style="width:100.0%"></p>
<div style="font-size: 0.3em; color: var(--link-color); margin-top: -17px;">
<p>Figure from <a href="https://youtu.be/IHZwWFHWa-w?si=LZGSqvBlbHsSIqx5&amp;t=511" target="_blank"> Gradient descent, how neural networks learn | Deep Learning Chapter 2</a></p>
</div>
</div>
<aside class="notes">
<p>We can expand this intuition to higher dimensions, - first to a loss function that takes two inputs, and then to a loss function that takes many more inputs.</p>
<p>In higher dimensions, the <strong>gradient</strong> fulfills the role of the slope.</p>
<p>For those of you who remember from calculus, in a function of multiple inputs and one output (i.e.&nbsp;a multivariate scalar function), computing the gradient at a certain point tells us the direction in which the function increases most.</p>
<p>So you may already see that for the loss function (whose inputs are the network’s weights and biases), the gradient will be a vector that will tell us at each point, how much to vary the weights and biases so as to decrease more steeply the loss.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="seven-optimisation-takeaways" class="slide level2 scrollable">
<h2>Seven optimisation takeaways!</h2>
<div style="font-size: 1em; margin-left: 10px; margin-right: 50px; line-height: 1.5;">
<ol type="1">
<li class="fragment"><p>The loss function as a <strong>high-dimensional “surface”</strong>.</p></li>
<li class="fragment"><p>The <strong>gradient</strong> is a vector that at any point in the loss “surface” gives us the direction of steepest ascent.</p></li>
<li class="fragment"><p>The <strong>negative gradient</strong> gives us the direction of steepest descent.</p></li>
<li class="fragment"><p><strong>Gradient descent</strong> is an optimisation procedure that iteratively adjusts the parameters based on the gradient.</p></li>
</ol>
<div class="fragment fade-in">
<p>Until when?….</p>
</div>
</div>
<aside class="notes">
<p>We now have a good intuition on how the optimisation problem is solved, and how we adjust the weights and biases in the network to minimise our loss. Let’s consolidate what we’ve seen a bit more formally, in the form of 6 Main Optimisation Takeaways</p>
<ol type="1">
<li><p>Loss function as a <strong>high-dimensional “surface”</strong>, where each point in the surface corresponds to a set of weights and biases.</p></li>
<li><p>The <strong>gradient</strong>, a vector that at any point in the loss “surface” gives us the direction of steepest ascent (i.e.&nbsp;the direction in which the loss increases most).</p></li>
<li><p>The <strong>negative gradient</strong> gives us the direction of steepest descent (i.e.&nbsp;the direction in which the loss decreases most).</p></li>
<li><p>We optimise (i.e.&nbsp;find the parameters that make the loss function minimal) the loss function iteratively, starting off with a random set of parameters and adjusting them until the loss is below a certain threshold.</p></li>
</ol>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="seven-optimisation-takeaways-1" class="slide level2">
<h2>Seven optimisation takeaways!</h2>
<p><br></p>
<div style="width: 75%; margin: 0 auto; text-align: right;">
<p><img data-src="img/training/loss.png" style="width:100.0%"></p>
<div style="font-size: 0.3em; color: var(--link-color); margin-top: -17px;">
<p>Figure from <a href="https://www.kaggle.com/code/ryanholbrook/overfitting-and-underfitting" target="_blank"> Kaggle tutorial: Overfitting and Underfitting</a></p>
</div>
</div>
<aside class="notes">
<p>In practice, you would monitor the loss function or your accuracy on both the training and the validation set during training, and stop when the validation error stops improving.</p>
<blockquote>
<p>The gap between the training and validation accuracy indicates the amount of overfitting. Two possible cases are shown in the diagram on the left. The blue validation error curve shows very small validation accuracy compared to the training accuracy, indicating strong overfitting (note, it’s possible for the validation accuracy to even start to go down after some point). When you see this in practice you probably want to increase regularization (stronger L2 weight penalty, more dropout, etc.) or collect more data.</p>
</blockquote>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="seven-optimisation-takeaways-2" class="slide level2 scrollable">
<h2>Seven optimisation takeaways!</h2>
<div style="font-size: 1em; margin-left: 10px; margin-right: 50px; line-height: 1.5;">
<ol start="5" type="1">
<li class="fragment"><p>To <strong>update the parameters</strong> we take a small step in the direction of the negative gradient. <span class="math display">\[
W_{new} = W_{old} - \alpha \nabla \text{L}_W
\]</span></p></li>
<li class="fragment"><p><strong>Stochastic gradient descent</strong> is a more efficient variant of gradient descent which computes the gradient on <strong>batches</strong> of training samples.</p></li>
<li class="fragment"><p>An <strong>epoch</strong> is a single pass through the complete training set. A training process will consist of multiple epochs.</p></li>
</ol>
</div>
<aside class="notes">
<ol start="5" type="1">
<li><p>The simplest form of parameter update is to take a small step in the direction of the negative gradient. <span class="math display">\[
W_{new} = W_{old} - \alpha \nabla \text{L}_W
\]</span> where <span class="math inline">\(\alpha\)</span> is the learning rate. This is actually never used in practice, but it’s the main idea behind all methods for parameter updates.</p></li>
<li><p>In gradient descent, a parameter update takes place when we compute the full loss (i.e.&nbsp;across the entire training set). However due to vectorisation, it is much more efficient to do <strong>stochastic gradient descent</strong>. In this case, we update the parameters more frequently, and compute the gradient on a small subset of the training set, called a <strong>batch</strong>.</p></li>
</ol>
<p>“True” stochastic gradient descent is when we compute the gradient and perform an update on every single sample. But a batch of samples has better convergence properties. &gt; A compromise between computing the true gradient and the gradient at a single sample is to compute the gradient against more than one training sample (called a “mini-batch”) at each step. This can perform significantly better than “true” stochastic gradient descent described, because the code can make use of vectorization libraries rather than computing each step separately as was first shown in [6] where it was called “the bunch-mode back-propagation algorithm”. It may also result in smoother convergence, as the gradient computed at each step is averaged over more training samples. [From https://en.wikipedia.org/wiki/Stochastic_gradient_descent]</p>
<blockquote>
<p>This [single-example parameter updates] is relatively less common to see because in practice due to vectorized code optimizations it can be computationally much more efficient to evaluate the gradient for 100 examples, than the gradient for one example 100 times. [From https://cs231n.github.io/optimization-1/ ]</p>
</blockquote>
<blockquote>
<p>The size of the mini-batch is a hyperparameter but it is not very common to cross-validate it. It is usually based on memory constraints (if any), or set to some value, e.g.&nbsp;32, 64 or 128. We use powers of 2 in practice because many vectorized operation implementations work faster when their inputs are sized in powers of 2. [From https://cs231n.github.io/optimization-1/ ]</p>
</blockquote>
<blockquote>
<p>There are other ways of performing the optimization (e.g.&nbsp;LBFGS), but Gradient Descent is currently by far the most common and established way of optimizing Neural Network loss function. [From https://cs231n.github.io/optimization-1/ ]</p>
</blockquote>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="a-reminder" class="slide level2">
<h2>A reminder</h2>
<ul>
<li class="fragment"><p>In training: forward and backward pass</p></li>
<li class="fragment"><p>In testing and inference: only forward pass</p></li>
</ul>
</section>
<section id="additional-references-3" class="slide level2">
<h2>Additional references</h2>
<div style="font-size: 0.6em;">
<ul>
<li>On validation set and hyperparameter tuning
<ul>
<li><a href="https://cs231n.github.io/classification/#validation-sets-for-hyperparameter-tuning">CS231n: Classification</a></li>
</ul></li>
<li>On cross-entropy loss and other information theory concepts
<ul>
<li>Deep learning book chapter 3 <a href="http://www.deeplearningbook.org/contents/prob.html">http://www.deeplearningbook.org/contents/prob.html</a></li>
</ul></li>
<li>On weight initialisation
<ul>
<li><a href="https://cs231n.github.io/neural-networks-2/">https://cs231n.github.io/neural-networks-2/</a></li>
</ul></li>
<li>On methods for gradient update
<ul>
<li><a href="https://cs231n.github.io/neural-networks-3/#update">https://cs231n.github.io/neural‐networks‐3/#update</a></li>
</ul></li>
<li>On babysitting the training process
<ul>
<li><a href="https://cs231n.github.io/neural-networks-3/#baby">https://cs231n.github.io/neural-networks-3/#baby</a></li>
</ul></li>
<li>On optimisation
<ul>
<li><a href="https://cs231n.github.io/optimization-1/">https://cs231n.github.io/optimization-1/</a></li>
</ul></li>
<li>On precisely how the gradient is computed
<ul>
<li><a href="https://youtu.be/Ilg3gGewQ5U?si=3gMshup9ctIzRc2_">Backpropagation, intuitively | Deep Learning Chapter 3</a></li>
<li><a href="https://youtu.be/tIeHLnjs5U8?si=E6emafp6dsAXutW5">Backpropagation calculus | Deep Learning Chapter 4</a></li>
</ul></li>
<li>Neural networks and an interesting insight into stochastic gradient descent
<ul>
<li><a href="https://www.cs.cornell.edu/courses/cs4780/2018fa/lectures/">Machine Learning for Intelligent Systems CS4780 (Cornell University)</a></li>
<li>see lectures 20 and 21</li>
</ul></li>
</ul>
</div>
<!-- ########################################### -->
</section></section>
<section>
<section id="cnn" class="title-slide slide level1 center">
<h1>Convolutional neural networks</h1>

</section>
<section id="convolutional-neural-networks" class="slide level2">
<h2>Convolutional neural networks</h2>
<p><br></p>
<ul>
<li class="fragment">Regular NN don’t scale well to images</li>
<li class="fragment">CNNs take advantage of the fact that their inputs are images</li>
</ul>
<div class="r-stack">
<div class="fragment fade-in-then-out">
<div style="text-align: right; margin: 0 auto;">
<img data-src="img/cnn/cnn-transforms.png">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: -17px;">
<p>Figure from <a href="https://www.cs.cornell.edu/courses/cs4780/2018fa/lectures/lecturenote20.pdf" target="_blank"> CS4780 lecture notes</a></p>
</div>
</div>
</div>
<div class="fragment fade-in">
<div style="text-align: right; width: 80%; margin: 0 auto;">
<img data-src="img/overview/cnn-diagram-1.png">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: -17px;">
<p>Figure from <a href="https://cs231n.github.io/convolutional-networks" target="_blank"> cs231n.github.io/convolutional-networks</a></p>
</div>
</div>
</div>
</div>
<aside class="notes">
<ul>
<li><p>Regular NNs don’t scale well to images</p>
<ul>
<li>An image of size 200x200x3 would mean a first hidden layer with 120,000 weights per neuron!</li>
<li>The full connectivity is overkill</li>
</ul></li>
<li><p>CNNs take advantage of the fact that their inputs are images</p>
<ul>
<li>this means they can make sensible modifications to the architecture.</li>
</ul>
<p>The modifications to the architecture encode the assumptions of the functions that we want to fit.</p>
<p>For example, if we want to train a network to fit the function that detects if an image contains a cat, when we use a CNN we constrain that space of possible functions to only those that are translation invariant, just by using this architecture.</p></li>
</ul>
<p>We can see them as subsequent transformations of the input image.</p>
<p>We can also see their neurons as being 3-dimensional, with width, height and depth (if like before, we consider the neurons to hold the outputs of the computations)</p>
<blockquote>
<p>A simple ConvNet is a sequence of layers, and every layer of a ConvNet transforms one volume of activations [neuron outputs] to another</p>
</blockquote>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- -------------------------------- -->
</section>
<section id="layers-used-in-cnns" class="slide level2">
<h2>Layers used in CNNs</h2>
<p>Three common types:</p>
<ul>
<li>Convolutional layer</li>
<li>Pooling layer</li>
<li>Batch normalisation layer</li>
<li>Fully connected layer</li>
</ul>
<aside class="notes">
<p>Fully connected layers are the same as in regular NNs.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- -------------------------------- -->
</section>
<section id="layers-used-in-cnns-1" class="slide level2">
<h2>Layers used in CNNs</h2>
<p>Three common types:</p>
<ul>
<li><strong>Convolutional layer</strong></li>
<li>Pooling layer</li>
<li>Batch normalisation layer</li>
<li>Fully connected layer</li>
</ul>
<aside class="notes">
<p>We will focus on the convolutional layer and the pooling layer.</p>
<p>For the batch normalisation layer it is enought to know that it is a scaling and translation operation that is applied to the output of the convolutional layer, based on the statistics of the batch.</p>
<p>The fully connected layer is the same as in regular NNs.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- -------------------------------- -->
</section>
<section id="convolutional-layer" class="slide level2">
<h2>Convolutional layer</h2>
<div class="columns">
<div class="column" style="width: 50%;">
<div class="fragment fade-in" data-fragment-index="1">
<ul>
<li>A set of <em>n</em> learnable <strong>filters</strong></li>
</ul>
</div>
<div class="fragment fade-in" data-fragment-index="2">
<ul>
<li>Each filter is a small matrix of weights + 1 bias</li>
</ul>
</div>
<div class="fragment fade-in" data-fragment-index="3">
<ul>
<li>We slide (convolve) each filter across the width and height <strong>and the full depth</strong> of the input volume</li>
</ul>
</div>
<!-- :::{.fragment .fade-in data-fragment-index="4"}
- Parameters are shared
::: -->
</div></div>
<div class="column" style="width: 40%; margin-left: 5%;">
<div class="r-stack">
<div class="fragment fade-in" data-fragment-index="0">
<div class="fragment fade-out" data-fragment-index="1">
<div style="text-align: right; width: 100%; margin: 0 auto;">
<img data-src="img/overview/cnn-diagram-2.png" class="quarto-figure quarto-figure-center">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: -17px;">
<p>Figure modified from <a href="https://cs231n.github.io/convolutional-networks/" target="_blank"> CS231n</a></p>
</div>
</div>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="1">
<div class="fragment fade-out" data-fragment-index="3">
<div style="text-align: right; width: 100%; margin: 0 auto;">
<img data-src="img/cnn/convolution-n-channels.png" class="quarto-figure quarto-figure-center">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: -17px;">
<p>Figure modified from <a href="https://cs231n.github.io/convolutional-networks/" target="_blank"> CS231n</a></p>
</div>
</div>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="3">
<div class="fragment fade-out" data-fragment-index="4">
<div style="text-align: right; width: 80%; margin: 0 auto;">
<img data-src="img/cnn/padding_strides.gif" class="quarto-figure quarto-figure-center" style="transform: rotate(40deg)">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: 50px;">
<p>Figure from <a href="https://github.com/vdumoulin/conv_arithmetic" target="_blank">Convolution arithmetic</a></p>
</div>
</div>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="4">
<div style="text-align: right; width: 100%; margin: 0 auto;">
<img data-src="img/cnn/convolution-sharing.png" class="quarto-figure quarto-figure-center">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: -17px;">
<p>Figure modified from <a href="https://cs231n.github.io/convolutional-networks/" target="_blank"> CS231n</a></p>
</div>
</div>
</div>
</div>
</div><aside class="notes">
<ul>
<li>We have seen that it is useful to see a convolutional layer as a transform between an input volume and an output volume</li>
<li>It is defined by a set of <em>n</em> learnable <strong>filters</strong>, also sometimes called <strong>kernels</strong>. The depth of the output volume is equal to the number of filters.</li>
<li>Each filter is a small matrix of weights and one bias parameter
<ul>
<li>so each slice in the output volume corresponds to a small matrix of weights and a bias parameter</li>
<li>small along width and height but always extends to the full depth of the input</li>
<li>e.g.&nbsp;a filter on the first layer of a CNN may have size 5x5x3 (+ 1 bias parameter)</li>
</ul></li>
<li>How do we compute the values in each slice of the output volume?
<ul>
<li>In the forward pass:
<ul>
<li>we slide (convolve) each filter across the width and height of the input volume and compute dot products (multiply and sum)</li>
<li>we then would apply a non-linear activation function such as ReLU</li>
<li>the output is a <strong>2D “activation map</strong>” that gives the responses of that filter at every position</li>
</ul></li>
<li>for a layer with 12 filters, we will stack the 12 activation maps along depth to produce the output volume</li>
</ul></li>
</ul>
<p>We can interpret the filter as a <strong>pattern detector</strong> &gt; Intuitively, the network will learn filters that activate when they see some type of visual feature such as an edge of some orientation or a blotch of some color on the first layer, or eventually entire honeycomb or wheel-like patterns on higher layers of the network.</p>
<p>We can formulate the forward pass as a <strong>matrix multiplication</strong></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- -------------------------------- -->
</section>
<section id="convolutional-layer-1" class="slide level2">
<h2>Convolutional layer</h2>
<div class="columns">
<div class="column" style="width: 50%;">
<p>A few hyperparameters:</p>
<div class="fragment fade-in" data-fragment-index="0">
<ul>
<li>number of filters</li>
<li>filter size</li>
<li>stride</li>
<li>padding</li>
</ul>
</div>
</div><div class="column" style="width: 50%;">
<div class="r-stack">
<div class="fragment fade-in-then-out">
<div style="text-align: right; width: 80%; margin: 0 auto;">
<img data-src="img/cnn/same_padding_no_strides.gif" class="quarto-figure quarto-figure-center" style="transform: rotate(40deg)">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: 50px;">
<p>Stride = 1. Figure from <a href="https://github.com/vdumoulin/conv_arithmetic" target="_blank">Convolution arithmetic</a></p>
</div>
</div>
</div>
<div class="fragment fade-in">
<div style="text-align: right; width: 80%; margin: 0 auto;">
<img data-src="img/cnn/padding_strides.gif" class="quarto-figure quarto-figure-center" style="transform: rotate(40deg)">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: 50px;">
<p>Stride = 2. Figure from <a href="https://github.com/vdumoulin/conv_arithmetic" target="_blank">Convolution arithmetic</a></p>
</div>
</div>
</div>
</div>
</div></div>
<aside class="notes">
<p>There are a few hyperparameters involved in the convolutional layer: - number of filters: the depth of the output volume - filter size: the size of the filter (width and height) - stride: the number of pixels that the filter moves by at each step - A stride larger than one will reduce the size of the output volume - padding: the number of 0 pixels that are added to the input volume at each side - Padding is used to control the size of the output volume</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- -------------------------------- -->
</section>
<section id="layers-used-in-cnns-2" class="slide level2">
<h2>Layers used in CNNs</h2>
<p>Three common types:</p>
<ul>
<li>Convolutional layer</li>
<li><strong>Pooling layer</strong></li>
<li>Batch normalisation layer</li>
<li>Fully connected layer</li>
</ul>
<aside class="notes">
<p>Briefly explain pooling layer, batch norm. Fully connected layer is the same as in regular NNs.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="pooling-layer" class="slide level2">
<h2>Pooling layer</h2>

<img data-src="img/cnn/maxpooling2.png" class="quarto-figure quarto-figure-center r-stretch"><aside class="notes">
<ul>
<li><p>A convolutional max filter is applied to each depth slice independently</p></li>
<li><p>2 hyperparameters:</p>
<ul>
<li>filter size</li>
<li>stride</li>
</ul></li>
<li><p>It resized the input in width and height — Pooling layer is a downsampling operation</p></li>
<li><p>No parameters to learn!</p></li>
<li><p>Common to periodically insert a Pooling layer in-between successive Conv layers</p></li>
<li><p>Its function is to progressively reduce the spatial size of the representation</p></li>
<li><p>this reduces the amount of parameters and computation in the network, and hence also controls overfitting.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- -------------------------------- -->
</section>
<section id="an-example-cnn-architecture-vgg-16" class="slide level2">
<h2>An example CNN architecture: VGG-16</h2>
<p>ImageNet 2014 challenge (1000 categories)</p>
<div style="text-align: left; width: 100%; margin: 0 auto;">
<img data-src="img/cnn/vgg16.png" class="quarto-figure quarto-figure-center">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: -17px;">
<p>Figure from <a href="https://www.neuralception.com/objectdetection-convnetbasics" target="_blank"> Neuralception</a></p>
</div>
</div>
<aside class="notes">
<p>In the example above, Conv and FC layers include a ReLU activation function.</p>
<blockquote>
<p>A simple ConvNet for CIFAR-10 classification could have the architecture [INPUT - CONV - RELU - POOL - FC]. - INPUT [32x32x3] will hold the raw pixel values of the image, in this case an image of width 32, height 32, and with three color channels R,G,B. - CONV layer will compute the output of neurons that are connected to local regions in the input, each computing a dot product between their weights and a small region they are connected to in the input volume. This may result in volume such as [32x32x12] if we decided to use 12 filters. - RELU layer will apply an elementwise activation function, such as the max(0,x) thresholding at zero. This leaves the size of the volume unchanged ([32x32x12]). POOL layer will perform a downsampling operation along the spatial dimensions (width, height), resulting in volume such as [16x16x12]. - FC (i.e.&nbsp;fully-connected) layer will compute the class scores, resulting in volume of size [1x1x10], where each of the 10 numbers correspond to a class score, such as among the 10 categories of CIFAR-10. As with ordinary Neural Networks and as the name implies, each neuron in this layer will be connected to all the numbers in the previous volume.</p>
</blockquote>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="an-example-cnn-architecture-resnet-18" class="slide level2">
<h2>An example CNN architecture: ResNet-18</h2>
<div style="text-align: right; font-size: 0.3em; color: var(--link-color); margin-top: 0px;">
<p>Figure from <a href="https://learnopencv.com/fully-convolutional-image-classification-on-arbitrary-sized-image/" target="_blank"> LearnOpenCV</a></p>
</div>
<div style="text-align: center; width: 100%; margin-top: -35%;">
<p><img data-src="img/cnn/resnet-18.png" style="transform: rotate(-90deg);"></p>
</div>
</section>
<section id="transfer-learning" class="slide level2">
<h2>Transfer learning</h2>
<ul>
<li class="fragment"><p>Few people train a CNN from scratch</p></li>
<li class="fragment"><p>More common scenarios:</p>
<ul>
<li class="fragment"><p>Fine-tune a pretrained model <span style="font-size: 0.8em; color: var(--link-color);">(e.g.&nbsp;backbones for SLEAP, DLC, etc.)</span></p></li>
<li class="fragment"><p>Use as a feature extractor <span style="font-size: 0.8em; color: var(--link-color);">(e.g.&nbsp;<a href="https://dinov2.metademolab.com/">DINOv2</a>)</span></p></li>
<li class="fragment"><p>Directly use the model for inference <span style="font-size: 0.8em; color: var(--link-color);">(e.g.&nbsp;<a href="https://github.com/CMU-Perceptual-Computing-Lab/openpose">OpenPose</a>)</span></p></li>
</ul></li>
</ul>
<aside class="notes">
<blockquote>
<p>In practice, very few people train an entire Convolutional Network from scratch (with random initialization), because it is relatively rare to have a dataset of sufficient size.</p>
</blockquote>
<blockquote>
<p>Instead, it is common to pretrain a CNN on a very large dataset (e.g.&nbsp;ImageNet, which contains 1.2 million images with 1000 categories), and then use the CNN either as an initialization or a fixed feature extractor for the task of interest.</p>
</blockquote>
<p>Fine-tuning may refer to continue training the model on a new dataset, including all or only the last few layers (the rest are considered “frozen”). &gt; It is possible to fine-tune all the layers of the CNN, or it’s possible to keep some of the earlier layers fixed (due to overfitting concerns) and only fine-tune some higher-level portion of the network. - Backbone or feature extractor vs head</p>
<p>As a feature extractor: This may refer to the backbone purpose, or more explicitly to using a pretrained network to compute embeddings for your images &gt; Take a CNN pretrained on ImageNet, remove the last fully-connected layer, then treat the rest of the ConvNet as a fixed feature extractor for the new dataset.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- 
## Transfer learning{data-visibility="hidden"}
Common architectures:

- ResNet
- VGG
- Inception
- MobileNet
- EfficientNet
- UNet
- ...

::: {.notes}
In animal pose estimation, these architectures are often mentioned as possible "backbones"
Head vs backbone
::: -->
</section>
<section id="data-augmentation" class="slide level2">
<h2>Data augmentation</h2>
<div class="columns">
<div class="column" style="width: 60%;">
<div class="fragment fade-in" data-fragment-index="0">
<ul>
<li>To improve performance, train on more and diverse data.</li>
</ul>
</div>
<div class="fragment fade-in" data-fragment-index="1">
<ul>
<li>One easy way: transform the images we already have, <strong>while preserving the label</strong></li>
</ul>
</div>
<div class="fragment fade-in" data-fragment-index="4">
<ul>
<li>The choice depends on the task and the dataset.</li>
</ul>
</div>
<div class="fragment fade-in" data-fragment-index="6">
<ul>
<li>Reduces overfitting and improves robustness.</li>
</ul>
</div>
</div><div class="column" style="width: 35%;">
<div class="r-stack">
<div class="fragment fade-in" data-fragment-index="2">
<div class="fragment fade-out" data-fragment-index="3">
<div style="text-align: right; width: 100%; margin-top: 10%;">
<img data-src="img/cnn/mnist-RandomShifts.jpeg" style="width:100.0%">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: 0px;">
<p>Random shifts. Figure from <a href="https://github.com/Prachi-Gopalani13/Image-Augmentation-Using-Keras" target="_blank"> https://github.com/Prachi-Gopalani13/Image-Augmentation-Using-Keras</a></p>
</div>
</div>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="3">
<div class="fragment fade-out" data-fragment-index="5">
<div style="text-align: right; width: 100%; margin-top: 10%;">
<img data-src="img/cnn/mnist-RandomRotations.jpeg" style="width:100.0%">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: 0px;">
<p>Random rotations. Figure from <a href="https://github.com/Prachi-Gopalani13/Image-Augmentation-Using-Keras" target="_blank"> https://github.com/Prachi-Gopalani13/Image-Augmentation-Using-Keras</a></p>
</div>
</div>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="5">
<div style="text-align: right; width: 100%; margin-top: 10%;">
<img data-src="img/cnn/mnist-RandomFlips.jpeg" style="width:100.0%">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: 0px;">
<p>Random flips. Figure from <a href="https://github.com/Prachi-Gopalani13/Image-Augmentation-Using-Keras" target="_blank"> https://github.com/Prachi-Gopalani13/Image-Augmentation-Using-Keras</a></p>
</div>
</div>
</div>
</div>
</div></div>
<aside class="notes">
<p>Notes from https://www.kaggle.com/code/ryanholbrook/data-augmentation and https://www.ibm.com/think/topics/data-augmentation</p>
<p>The best way to improve the performance of a model is to train it on more and diverse data. The more examples that are provided during training, the better it will be able to recognise which differences between images matter and which don’t.</p>
<p>One easy way to increase the size of the dataset is to transform the images we already have. Specifically, we apply transformations to the images that preserve the label (or modify it in a way that is consistent with the label). For example in our MNIST case, we would apply transformations such that the image would still be classified as the digit it contains. Common examples: rotation, scaling, shearing, flipping, cropping, color jittering, etc.</p>
<p>That way we teach the model to recognise the digit even if it is rotated, scaled, sheared, flipped, cropped, or otherwise transformed.</p>
<p>But the choice of what data augmentation to apply depends on the task and the dataset. For example, a rotation of 180 degrees is not a good idea for a digit classification task, as it may confuse the model between 6s and 9s</p>
<p>Data augmentation can reduce overfitting and improve model robustness, esp in cases with small or unbalanced datasets.</p>
<p>A note on horizontal flip data augmentation in pose estimation: - usually data augmentation transforms will apply the same transformation to the image and the labels (e.g.&nbsp;horizontal flip) - so if you have a skeleton with left and right keypoints, and we apply an horizontal flip, the left and right keypoints will be swapped - this will render wrong keypoints tho! So often pose estimation frameworks allow you to define symmetric keypoints, to swap them again after mirroring - However if the left and right keypoints are not symmetric (e.g.&nbsp;fiddler crabs with dominant and non-dominant claws), you will want to flip the image and the keypoints without the additional swap - Basically if the keypoints are not different physically, you need to set them as “symmetric”.</p>
<p>See <a href="https://deeplabcut.github.io/DeepLabCut/docs/recipes/flip_and_rotate.html#augment-to-reduce-left-right-bias">here</a></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="additional-references-4" class="slide level2">
<h2>Additional references</h2>
<div style="font-size: 0.6em;">
<ul>
<li>CS231n: Convolutional Neural Networks
<ul>
<li><a href="https://cs231n.github.io/convolutional-networks/">https://cs231n.github.io/convolutional-networks/</a></li>
<li><a href="https://cs231n.github.io/transfer-learning/">https://cs231n.github.io/transfer-learning/</a></li>
</ul></li>
<li>CS4780: Machine Learning for Intelligent Systems
<ul>
<li><a href="https://www.cs.cornell.edu/courses/cs4780/2018fa/lectures/lecturenote20.pdf">lecture 20 notes</a></li>
</ul></li>
<li>On data augmentation:
<ul>
<li><a href="https://deeplabcut.github.io/DeepLabCut/docs/recipes/flip_and_rotate.html">DeepLabCut case study: Improving network performance on unbalanced data via augmentation</a>, specifically the section on “Augment to reduce left-right bias” and “Edit pose_cfg.yaml for fliplr augmentation”. A blogpost version is available <a href="https://deeplabcut.medium.com/balancing-bats-d3c5bcfb71e1">here</a></li>
<li><a href="https://www.kaggle.com/code/ryanholbrook/data-augmentation">https://www.kaggle.com/code/ryanholbrook/data-augmentation</a></li>
<li><a href="https://www.ibm.com/think/topics/data-augmentation">https://www.ibm.com/think/topics/data-augmentation</a></li>
</ul></li>
</ul>
</div>
</section>
<section class="slide level2">


<!-- ########################################### -->
<aside><div>
<p>This section is based on the lecture notes from cs231n available at <a href="https://cs231n.github.io/">cs231n.github.io</a></p>
</div></aside></section></section>
<section>
<section id="cv-applications-in-animal-behaviour" class="title-slide slide level1 center">
<h1>CV applications in animal behaviour</h1>
<!-- A note about old-school DL-based CV vs transformer CV models  -->
</section>
<section id="cv-tasks-in-animal-behaviour" class="slide level2">
<h2>CV tasks in animal behaviour</h2>
<div class="fragment">
<p><br></p>
<p>What are <em>tasks</em>?</p>
<ul>
<li class="fragment">A task is a problem that we want to solve</li>
<li class="fragment">There may be multiple ways to solve a task</li>
<li class="fragment">DL has proven to be very powerful to solve many vision tasks</li>
</ul>
<aside class="notes">
<ul>
<li>Tasks are goals or problems that we want (algorithms or models) to solve</li>
<li>There may be multiple ways to solve a task</li>
<li>Deep learning is a powerful tool to solve many vision tasks</li>
<li>The boundaries between tasks are not always clear cut</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="cv-tasks-in-animal-behaviour-1" class="slide level2">
<h2>CV tasks in animal behaviour</h2>
<div class="columns">
<div class="column" style="width: 45%;line-height: 0.8;">
<div class="fragment fade-in" data-fragment-index="1">
<ul>
<li>Image classification</li>
</ul>
</div>
<div class="fragment fade-in" data-fragment-index="2">
<ul>
<li>Detection</li>
</ul>
</div>
<div class="fragment fade-in" data-fragment-index="3">
<ul>
<li>Segmentation</li>
</ul>
</div>
<div class="fragment fade-in" data-fragment-index="5">
<ul>
<li>Pose estimation</li>
</ul>
</div>
<div class="fragment fade-in" data-fragment-index="6">
<ul>
<li>Tracking</li>
</ul>
</div>
<div class="fragment fade-in" data-fragment-index="7">
<ul>
<li>Behaviour classification</li>
</ul>
</div>
<div class="fragment fade-in" data-fragment-index="8">
<ul>
<li>Re-identification</li>
</ul>
</div>
<div class="fragment fade-in" data-fragment-index="9">
<ul>
<li>…</li>
</ul>
</div>
</div><div class="column" style="width: 15%;">

</div><div class="column" style="width: 40%;">
<div class="r-stack">
<!-- -- Classification example -->
<div class="fragment fade-in" data-fragment-index="1">
<div class="fragment fade-out" data-fragment-index="2">
<div style="text-align: right; width: 100%;">
<em>Which species are present in this image?</em> <img data-src="img/behaviour/ss_sample.jpg">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: -17px; text-align: right;">
<p>Figure from <a href="https://lila.science/datasets/snapshot-serengeti" target="_blank"> Snapshot Serengeti dataset</a></p>
</div>
</div>
</div>
</div>
<!-- -- Detection example -->
<div class="fragment fade-in" data-fragment-index="2">
<div class="fragment fade-out" data-fragment-index="3">
<div style="text-align: right; width: 100%;">
<em>Where is the animal in this image?</em> <img data-src="img/behaviour/sample_image_armadillo.jpg">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: -17px;">
<p>Figure from <a href="https://github.com/google/cameratrapai" target="_blank"> and there from the Orinoquía Camera Traps dataset (University of Minnesota).</a></p>
</div>
</div>
</div>
</div>
<div class="fragment fade-in" data-fragment-index="3">
<div class="fragment fade-out" data-fragment-index="4">
<div style="text-align: right; width: 100%;">
<em>Where is the animal in this image?</em> <img data-src="img/behaviour/crab-detections.png">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: -17px;">
<p>Figure from <a href="https://github.com/SainsburyWellcomeCentre/crabs-exploration" target="_blank"> Crabs exploration project</a></p>
</div>
</div>
</div>
</div>
<!-- -- Instance segmentation example -->
<div class="fragment fade-in" data-fragment-index="4">
<div class="fragment fade-out" data-fragment-index="5">
<div style="text-align: right; width: 100%;">
<em>Which pixels are <span style="color: magenta;">“mouse”</span>?</em> <img data-src="img/behaviour/semantic-segmentation.png">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: -17px;">
<p>Sample image from <a href="https://sainsburywellcomecentre.github.io/aeon_docs/index.html" target="_blank"> Aeon project</a></p>
</div>
</div>
</div>
</div>
<!-- -- Semantic segmentation example -->
<div class="fragment fade-in" data-fragment-index="5">
<div class="fragment fade-out" data-fragment-index="6">
<div style="text-align: right; width: 100%;">
<em>Which pixels are <span style="color: blue;">“mouse 1”</span>?</em> <img data-src="img/behaviour/instance-segmentation.png">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: -17px;">
<p>Sample image from <a href="https://sainsburywellcomecentre.github.io/aeon_docs/index.html" target="_blank"> Aeon project</a></p>
</div>
</div>
</div>
</div>
<!-- -- Pose estimation example -->
<div class="fragment fade-in" data-fragment-index="6">
<div class="fragment fade-out" data-fragment-index="7">
<div style="text-align: right; width: 100%;">
<em>Where are the keypoints?</em> <img data-src="img/behaviour/superanimal-fox.png">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: -17px;">
<p>Figure from <a href="https://www.nature.com/articles/s41467-024-48792-2" target="_blank"> Ye et al.&nbsp;(2024) <em>SuperAnimal pretrained pose estimation models for behavioral analysis</em></a></p>
</div>
</div>
</div>
</div>
<!-- -- Tracking example -->
<div class="fragment fade-in" data-fragment-index="7">
<div class="fragment fade-out" data-fragment-index="8">
<div style="text-align: right; width: 100%;">
<em>How do detections in frame f map to frame f+1?</em> <img data-src="img/behaviour/tracking-bees-sleap.png">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: -17px;">
<p>Figure from <a href="https://www.nature.com/articles/s41592-022-01426-1" target="_blank"> Pereira et al.&nbsp;(2022) <em>SLEAP: A deep learning system for multi-animal pose tracking</em></a></p>
</div>
</div>
</div>
</div>
<!-- -- Behaviour classification example -->
<div class="fragment fade-in" data-fragment-index="8">
<div class="fragment fade-out" data-fragment-index="9">
<div style="text-align: right; width: 100%;">
<em>What is the behaviour of the animal in this frame/clip?</em> <img data-src="img/behaviour/syllables_small.png">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: -17px;">
<p>Figure from <a href="https://dattalab.github.io/moseq2-website" target="_blank"> https://dattalab.github.io/moseq2-website/</a></p>
</div>
</div>
</div>
</div>
<!-- -- Re-identification example -->
<div class="fragment fade-in" data-fragment-index="9">
<div class="fragment fade-out" data-fragment-index="10">
<div style="text-align: right; width: 100%;">
<em>Which individual is the animal in this frame?</em> <img data-src="img/behaviour/happy-whale.jpg">
<div style="font-size: 0.3em; color: var(--link-color); margin-top: -17px;">
<p>Figure from <a href="https://happywhale.com/home" target="_blank"> Happy Whale dataset</a></p>
</div>
</div>
</div>
</div>
</div>
</div></div>
<aside class="notes">
<ul>
<li>Image classification, can be multiclass</li>
<li>Detection, localise an object in the image. Can be linked with classification too. Usually bbox or centroid.</li>
<li>Pose estimation, where are the user-defined keypoints of the animal in this image?</li>
<li>Behaviour classification, or action segmentation or action recognition</li>
<li>Re-identification, identify the same animal across frames/clips</li>
</ul>
<p>Many more tasks! But these are the most commonly used in animal behaviour.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- ## A quick note on transformers -->
<!-- ## Additional resources

- [A primer on motion capture with deep learning: principles, pitfalls, and perspectives](https://www.cell.com/neuron/pdf/S0896-6273(20)30717-0.pdf) -->
</section>
<section class="slide level2">

<!-- ::: aside
This section is based on the lecture notes from cs231n available at [cs231n.github.io](https://cs231n.github.io/)
:::

 -->



</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="img/logo_niu_light.png" class="slide-logo"></p>
<div class="footer footer-default">
<p>animals-in-motion.neuroinformatics.dev | 2025</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true,"numbers":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: true,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 10,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 10,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>